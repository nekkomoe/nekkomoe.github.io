<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-lmmr/lmmr" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/lmmr/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T14:34:12.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/lmmr/">线性变换与矩阵递推</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><ul>
<li>矩阵乘法</li>
<li>(常系数)(齐次)(线性)递推</li>
<li>快速幂</li>
<li>一点点动态规划知识</li>
</ul>
<h2 id="简要形式"><a href="#简要形式" class="headerlink" title="简要形式"></a>简要形式</h2><p>$$<br>f_i=C+\sum_{j=1}^{k}a_{j}f_{i-j}<br>$$</p>
<p>写成矩阵的话是这样的</p>
<p>$$<br>\begin{pmatrix}<br>f_{i}  &amp; f_{i+1}  &amp; \cdots  &amp; f_{i+k-1} &amp; C<br>\end{pmatrix}<br>\begin{pmatrix}<br>0 &amp; 0 &amp; \cdots &amp; 0 &amp; a_1 &amp; 0 \\<br>1 &amp; 0 &amp; \cdots &amp; 0 &amp; a_2 &amp; 0\\<br>0 &amp; 1 &amp; \cdots &amp; 0 &amp; a_3 &amp; 0\\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\<br>0 &amp; 0 &amp; \cdots &amp; 1 &amp; a_{k} &amp; 0\\<br>0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f_{i+1} \\<br>f_{i+2} \\<br>\vdots \\<br>f_{i+k} \\<br>C<br>\end{pmatrix}<br>$$</p>
<p>如果$C$是多项式的话，可能还要维护一堆$C$，比如说$j^3,j^2,j$</p>
<p>当然，有时候会遇到一些有若干个变量的线性变换，处理的方式相同</p>
<h2 id="常见套路"><a href="#常见套路" class="headerlink" title="常见套路"></a>常见套路</h2><ol>
<li>dp模型，但$n$很大，写成矩阵转移后可以进行矩阵快速幂，如求斐波那契数列第$n$项</li>
<li>带修改dp模型，在无修改的时候可以写成矩阵转移形式，带修改则只需用线段树维护一下即可，如hdu5068</li>
<li>若干个互相独立的点，每个点有变量，每次将连续的一些点的变量进行独立的线性变换，可用某种嵌套数据结构维护，如<a target="_blank" rel="noopener" href="https://loj.ac/problem/6208">loj6208</a></li>
</ol>
<h2 id="部分应用"><a href="#部分应用" class="headerlink" title="部分应用"></a>部分应用</h2><h3 id="斐波那契第-n-项"><a href="#斐波那契第-n-项" class="headerlink" title="斐波那契第$n$项"></a>斐波那契第$n$项</h3><p>设$f(0)=0,f(1)=1$，且$\forall i \ge 2, f(i)=f(i-1)+f(i-2)$</p>
<p>即</p>
<p>$$<br>\begin{pmatrix}<br>f(i) &amp; f(i+1)<br>\end{pmatrix}<br>\begin{pmatrix}<br>0 &amp; 1 \\<br>1 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f(i+1) &amp; f(i+2)<br>\end{pmatrix}<br>$$</p>
<p>所以</p>
<p>$$<br>\begin{pmatrix}<br>f(0)) &amp; f(1)<br>\end{pmatrix}<br>\begin{pmatrix}<br>0 &amp; 1 \\<br>1 &amp; 1<br>\end{pmatrix}^n<br>=<br>\begin{pmatrix}<br>f(n) &amp; f(n+1)<br>\end{pmatrix}<br>$$</p>
<p><del>算了就这样了……剩下的从习题中看吧……</del></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/lmmr/" data-id="ckqmfus9400328ufy5x5a86q8" data-title="线性变换与矩阵递推" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-du-sieves/problems/bzoj-3944" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/19/du-sieves/problems/bzoj-3944/" class="article-date">
  <time class="dt-published" datetime="2018-06-19T08:11:23.000Z" itemprop="datePublished">2018-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/19/du-sieves/problems/bzoj-3944/">杜教筛习题：bzoj 3944 sum</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定正整数$n$，求<br>$$<br>\begin{cases}<br>\Phi(n)=\sum\limits_{i=1}^{n} \phi(i) \\<br>M(n)=\sum\limits_{i=1}^{n} \mu(i)<br>\end{cases}<br>$$<br>其中$n \le 2^{32}-1$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>当然分别计算$\Phi(n)$和$M(n)$了</p>
<h3 id="Phi-n"><a href="#Phi-n" class="headerlink" title="$\Phi(n)$"></a>$\Phi(n)$</h3><p>首先有$\phi \times 1=id$</p>
<p>其次还有$f \times g = h \Rightarrow g(1)F(n)=H(n)-\sum\limits_{d=2}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor)$</p>
<p>也就是说$\Phi(n)=ID(n)-\sum\limits_{d=2}^{n}1(d)\Phi(\lfloor \frac{n}{d} \rfloor)$</p>
<p>即$\Phi(n)=\frac{(1+n)n}{2}-\sum\limits_{d=2}^{n}\Phi(\lfloor \frac{n}{d} \rfloor)$</p>
<h4 id="线性筛-phi-n"><a href="#线性筛-phi-n" class="headerlink" title="线性筛$\phi(n)$"></a>线性筛$\phi(n)$</h4><p>线性筛处理前$n^{\frac{2}{3}}$后，单次可以做到$O(n^{\frac{2}{3}})$</p>
<p>假设当前枚举到了$i$和素数$p_j$</p>
<p>若$i$是素数，则$\phi(i)=i-1$</p>
<p>若$p_j \mid i$，设$i \times p_j=i’ \times p_j^k$，且$(i’,p_j^k)=1$，则$\phi(i \times p_j)=\phi(i’) \times \phi(p_j^k)$</p>
<p>同时，有$\phi(n)=n\Pi (\frac{p_i-1}{p_i})$成立</p>
<p>即$\phi(i \times p_j)=\phi(i’) \times p_j^k\frac{p_j-1}{p_j}=i’\Pi p_t^{k_t} \times p_j^{k-1}\frac{p_j-1}{p_j} \times p_j=\phi(i)p_j$</p>
<p>若$p_j \not  \mid  i \Rightarrow(i,p_j)=1$，则$\phi(i \times p_j)=\phi(i) \times \phi(p_j)=\phi(i) \times (p_j-1)$</p>
<h3 id="M-n"><a href="#M-n" class="headerlink" title="$M(n)$"></a>$M(n)$</h3><p>首先有$\mu \times 1 = \epsilon$</p>
<p>其次还有$f \times g = h \Rightarrow g(1)F(n)=H(n)-\sum\limits_{d=2}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor)$</p>
<p>也就是说$M(n)=E(n)-\sum\limits_{d=2}^{n}1(d)M(\lfloor \frac{n}{d} \rfloor)$</p>
<p>即$M(n)=[n \ge 1]-\sum\limits_{d=2}^{n}M(\lfloor \frac{n}{d} \rfloor)$</p>
<h4 id="线性筛-mu-n"><a href="#线性筛-mu-n" class="headerlink" title="线性筛$\mu(n)$"></a>线性筛$\mu(n)$</h4><p>线性筛处理前$n^{\frac{2}{3}}$后，单次可以做到$O(n^{\frac{2}{3}})$</p>
<p>假设当前枚举到了$i$和素数$p_j$</p>
<p>若$i$是素数，则$\mu(i)=-1$</p>
<p>若$p_j \mid i$，设$i \times p_j=i’ \times p_j^k$，且$(i’,p_j^k)=1$，此时$k \ge 2$，则$\mu(i \times p_j)=\mu(i’) \times \mu(p_j^k)=0$</p>
<p>若$p_j \not  \mid  i \Rightarrow(i,p_j)=1$，则$\mu(i \times p_j)=\mu(i) \times \mu(p_j)=-\mu(i)$</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span>;</span><br><span class="line">ll n, phi[N + <span class="number">10</span>], mu[N + <span class="number">10</span>], pri[N + <span class="number">10</span>], tot, p[N + <span class="number">10</span>], q[N + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[(<span class="keyword">int</span>) <span class="number">1e5</span> + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getp</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> x &lt;= N ? phi[x] : p[n / x]; &#125;</span><br><span class="line"><span class="function">ll <span class="title">getq</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> x &lt;= N ? mu[x] : q[n / x]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= N || vis[n / x]) <span class="keyword">return</span> ;</span><br><span class="line">    vis[n / x] = <span class="number">1</span>;</span><br><span class="line">    p[n / x] = (<span class="number">1</span> + x) * x / <span class="number">2</span>;</span><br><span class="line">    q[n / x] = x &gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">2</span>, j ; i &lt;= x ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = x / (x / i);</span><br><span class="line">        <span class="built_in">sol</span>(x / i);</span><br><span class="line">        p[n / x] -= <span class="built_in">getp</span>(x / i) * (j - i + <span class="number">1</span>);</span><br><span class="line">        q[n / x] -= <span class="built_in">getq</span>(x / i) * (j - i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= N ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!phi[i]) phi[i] = i - <span class="number">1</span>, mu[i] = <span class="number">-1</span>, pri[++ tot] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; i * pri[j] &lt;= N ; ++ j) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * pri[j]] = phi[i] * pri[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                phi[i * pri[j]] = phi[i] * (pri[j] - <span class="number">1</span>);</span><br><span class="line">                mu[i * pri[j]] = -mu[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mu[i] += mu[i - <span class="number">1</span>];</span><br><span class="line">        phi[i] += phi[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T --) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span> vis);</span><br><span class="line">        <span class="keyword">if</span>(n &lt;= N) <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, phi[n], mu[n]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">sol</span>(n), <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, p[<span class="number">1</span>], q[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/19/du-sieves/problems/bzoj-3944/" data-id="ckqmfusae006n8ufyglhi923o" data-title="杜教筛习题：bzoj 3944 sum" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-du-sieves/problems/hdu-5608" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/19/du-sieves/problems/hdu-5608/" class="article-date">
  <time class="dt-published" datetime="2018-06-19T07:45:36.000Z" itemprop="datePublished">2018-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/19/du-sieves/problems/hdu-5608/">杜教筛习题：hdu 5608 function</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>设数论函数$f$满足$n^2−3n+2=\sum_{d \mid n}f(d) $</p>
<p>求$\sum_{i=1}^{n}f(i)$</p>
<p>答案对$10^9+7$取模</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>回忆杜教筛的一个表达形式</p>
<p>$$<br>f \times g=h \Rightarrow g(1)F(n)=H(n)-\sum_{d=2}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor)<br>$$</p>
<p>设$g(n)=1,h(n)=n^2-3n+2$，则有$f \times g = h$，即$f \times 1 = h$</p>
<p>所以</p>
<p>$$<br>\begin{align}<br>F(n)<br>&amp;=(\sum_{i=1}^{n}i^2-3i+2)-\sum_{d=2}^{n}F(\lfloor \frac{n}{d} \rfloor)\\<br>&amp;=\frac{n(n+1)(2n+1)}{6} - \frac{3n(1+n)}{2} + 2n - \sum_{d=2}^{n}F(\lfloor \frac{n}{d} \rfloor)<br>\end{align}<br>$$</p>
<p>因为$f \times 1 = h$，所以$f$是积性函数，且$f=h \times \mu$，即$f(n)=\sum_{d \mid n}h(d)\mu(\frac{n}{d})$</p>
<p>不妨对于每一个$\mu(i)$，枚举$j$，将$f(i \times j)$加上$\mu(i)h(j)$</p>
<p>之后就是递归计算了</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEBUG printf(<span class="meta-string">&quot;Passing [%s] in LINE %d\n&quot;</span>,__FUNCTION__,__LINE__)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">ll ans, inv6, inv2, n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mu[N + <span class="number">10</span>], pri[N + <span class="number">10</span>], tot, S[N + <span class="number">10</span>], dn[N + <span class="number">10</span>], vis[N + <span class="number">10</span>], f[N + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">pw</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll r = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; b ; b &gt;&gt;= <span class="number">1</span>, a = a * a % mod) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) r = r * a % mod;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n * n % mod - <span class="number">3</span> * n % mod + <span class="number">2</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">H</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (((</span><br><span class="line">        n * (n + <span class="number">1</span>) % mod * (<span class="number">2</span> * n + <span class="number">1</span>) % mod * inv6 % mod</span><br><span class="line">    ) - (</span><br><span class="line">        <span class="number">3</span> * n % mod * (<span class="number">1</span> + n) % mod * inv2 % mod</span><br><span class="line">    )) % mod + (</span><br><span class="line">        <span class="number">2</span> * n % mod</span><br><span class="line">    )) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">map&lt;ll, ll&gt; val;</span><br><span class="line"><span class="function">ll <span class="title">F</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= N) <span class="keyword">return</span> f[n];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(val.<span class="built_in">find</span>(n) != val.<span class="built_in">end</span>()) <span class="keyword">return</span> val[n];</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        ll res = <span class="built_in">H</span>(n);</span><br><span class="line">        <span class="keyword">for</span>(ll i = <span class="number">2</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">            j = n / (n / i);</span><br><span class="line">            res = (res - <span class="built_in">F</span>(n / i) * (j - i + <span class="number">1</span>) % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> val[n] = res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="built_in">F</span>(n) % mod + mod) % mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    inv6 = <span class="built_in">pw</span>(<span class="number">6</span>, mod - <span class="number">2</span>), inv2 = <span class="built_in">pw</span>(<span class="number">2</span>, mod - <span class="number">2</span>);</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= N ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) pri[++ tot] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; i * pri[j] &lt;= N ; ++ j) &#123;</span><br><span class="line">            vis[i * pri[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % pri[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            mu[i * pri[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= N ; ++ j) &#123;</span><br><span class="line">            f[i * j] = ((ll) f[i * j] + mu[j] * <span class="built_in">h</span>(i) % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        f[i] = ((ll) f[i - <span class="number">1</span>] + f[i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); <span class="keyword">while</span>(T --) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/19/du-sieves/problems/hdu-5608/" data-id="ckqmfusaf006s8ufy4kag09ls" data-title="杜教筛习题：hdu 5608 function" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-du-sieves/problems/51nod-1220" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/19/du-sieves/problems/51nod-1220/" class="article-date">
  <time class="dt-published" datetime="2018-06-19T07:13:29.000Z" itemprop="datePublished">2018-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/19/du-sieves/problems/51nod-1220/">杜教筛习题：51nod 1220 约数之和</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定$n$，求$\sum_{i=1}^{n}\sum_{j=1}^{n}\sigma_1(ij)$</p>
<p>其中$2 \le n \le 10^{9}$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>首先有</p>
<p>$$<br>\sigma_1(ij)=\sum_{x \mid i}\sum_{y \mid j}[(x,y)=1]\frac{xj}{y}<br>$$</p>
<p>那么可以得到</p>
<p>$$<br>\begin{align}<br>\sum_{i=1}^{n}\sum_{j=1}^{n}\sigma_1(ij)<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{n}\sum_{x \mid i}\sum_{y \mid j}[(x,y)=1]\frac{xj}{y} \\<br>&amp;=\sum_{d=1}^{n}\mu(d)\sum_{i=1}^{n}\sum_{j=1}^{n}\sum_{x \mid i}\sum_{y \mid j}[d \mid (x,y)]\frac{xj}{y} \\<br>&amp;=\sum_{d=1}^{n}\mu(d)\sum_{d \mid x}\sum_{d \mid y}\frac{x}{y}\sum_{i=1 \wedge x \mid i}^{n} \sum_{j=1 \wedge y \mid j}^{n}j \\<br>&amp;=\sum_{d=1}^{n}\mu(d)\sum_{d \mid x}\sum_{d \mid y}\frac{x}{y}\lfloor \frac{n}{x} \rfloor y \frac{(1 + \lfloor \frac{n}{y} \rfloor)\lfloor \frac{n}{y} \rfloor}{2} \\<br>&amp;=\sum_{d=1}^{n}\mu(d) (\sum_{d \mid x}x\lfloor \frac{n}{x} \rfloor) (\sum_{d \mid y}\frac{(1 + \lfloor \frac{n}{y} \rfloor)\lfloor \frac{n}{y} \rfloor}{2}) \\<br>&amp;=\sum_{d=1}^{n}\mu(d) (\sum_{x=1}^{\lfloor \frac{n}{d} \rfloor}xd \lfloor \frac{n}{dx} \rfloor) (\sum_{y=1}^{\lfloor \frac{n}{d} \rfloor}\frac{(1+\lfloor \frac{n}{dy} \rfloor)\lfloor \frac{n}{dy} \rfloor}{2}) \\<br>&amp;=\sum_{d=1}^{n}\mu(d)d (\sum_{x=1}^{\lfloor \frac{n}{d} \rfloor}x \lfloor \frac{n}{dx} \rfloor) (\sum_{y=1}^{\lfloor \frac{n}{d} \rfloor}\frac{(1+\lfloor \frac{n}{dy} \rfloor)\lfloor \frac{n}{dy} \rfloor}{2}) \\<br>\end{align}<br>$$</p>
<p>设$p(n)=\sum_{x=1}^{n} x\lfloor \frac{n}{x} \rfloor$，相当于每个$x$被其所有$[1,n]$之间的倍数各做了一次贡献，即$p(n)=\sum_{x=1}^{n}\sigma_1(x)$</p>
<p>设$q(n)=\sum_{x=1}^{n}\frac{(1+\lfloor \frac{n}{x} \rfloor)\lfloor \frac{n}{x} \rfloor}{2}$</p>
<p>本质上是</p>
<p>$$<br>\begin{align}<br>q(n)&amp;=\sum_{x=1}^{n}\frac{(1+\lfloor \frac{n}{x} \rfloor)\lfloor \frac{n}{x} \rfloor}{2} \\<br>&amp;=\sum_{x=1}^{n}\sum_{j=1}^{\lfloor \frac{n}{x} \rfloor}j \\<br>&amp;=\sum_{j=1}^{n}j\sum_{x=1}^{\lfloor \frac{n}{j} \rfloor} 1 \\<br>&amp;=\sum_{x=1}^{n}x\lfloor \frac{n}{x} \rfloor \\<br>&amp;=\sum_{x=1}^{n}\sigma_1(x)<br>\end{align}<br>$$</p>
<p>所以</p>
<p>$$<br>\begin{align}<br>\sum_{i=1}^{n}\sum_{j=1}^{n} \sigma_1(ij)<br>&amp;= \sum_{d=1}^{n}\mu(d)d (\sum_{x=1}^{\lfloor \frac{n}{d} \rfloor}\sigma_1(x))^2 \\<br>&amp;= \sum_{d=1}^{n}\mu(d)d \times h(\lfloor \frac{n}{d} \rfloor)^2 \\<br>\end{align}<br>$$</p>
<p>不妨设$f(d)=\mu(d)d$，则有$(f \times id)(n) = \sum_{d \mid n} \mu(d)d \frac{n}{d}=n \epsilon(n)=\epsilon(n)$</p>
<p>即$F(n)=1-\sum_{d=2}^{n}dF(\lfloor \frac{n}{d} \rfloor)$</p>
<p>对于$f(d)$还需要求出前$n^{\frac{2}{3}}$项</p>
<blockquote>
<p>首先有$f(1)=\mu(1)1=1$</p>
<p>设当前枚举到了$i$和素数$p_j$</p>
<p>如果$i$是素数，则$f(i)=\mu(i)i=-i$</p>
<p>如果$p_j \not  \mid  i$，则$f(i)=\mu(i \times p_j)i \times p_j=-\mu(i)i \times p_j=-f(i) \times p_j$</p>
<p>如果$p_j  \mid  i$，则$f(i)=\mu(i \times p_j)i \times p_j=\mu(i’ \times p_j^2)i \times p_j=0$</p>
</blockquote>
<p>对于$h(\lfloor \frac{n}{d} \rfloor)$，可以线性筛预处理前$n^{\frac{2}{3}}$项</p>
<p>设$e(n)$表示$n$的最小素因子的幂次和，$d(n)$表示$n$的约数和（即$\sigma_1(n)$）</p>
<blockquote>
<p>设$n=\Pi p_i^{k_i}$，则有$d(n)=\Pi_{i} \sum_{j=0}^{k_i}p_i^{j}$ ，$e(n)=\sum_{j=0}^{k_{min}}p_{min}^{j}$</p>
<p>设当前枚举到了$i$和素数$p_j$</p>
<p>若$i$是素数，则有$d(i)=1+i$，$e(i)=1+i$</p>
<p>若$p_j \not  \mid  i$，此时$i \times p_j$的最小素因子是$p_j$，即$d(i \times p_j)=d(i) \times (1+p_j)$，$e(i \times p_j)=1+p_j$</p>
<p>若$p_j  \mid  i$，此时$i \times p_j$和$i$的最小素因子都是$p_j$，则有$d(i \times p_j)=\frac{d(i)}{e(i)}(p_j \times e(i)+1)$，$e(i \times p_j)=p_j \times e(i)+1$</p>
</blockquote>
<p>对于后$n^{\frac{1}{3}}$项，可以根据$h(n)=\sum_{x=1}^{n}x \lfloor \frac{n}{x} \rfloor$进行数论分块，$O(\sqrt n)$计算</p>
<p>最终计算$h(n)$的时间复杂度为$O(n^{\frac{2}{3}})$</p>
<p>由于$\lfloor \frac{n}{d} \rfloor$的取值只有$\sqrt n$种，因此对其进行数论分块即可计算</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">ll e[N + <span class="number">10</span>], d[N + <span class="number">10</span>], muid[N + <span class="number">10</span>], mu[N + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pri[N + <span class="number">10</span>], tot, vis[N + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">ll n, ans;</span><br><span class="line"></span><br><span class="line">map&lt;ll, ll&gt; val_sig;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sum_sig1</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= N) &#123;</span><br><span class="line">        <span class="keyword">return</span> d[n];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(val_sig.<span class="built_in">find</span>(n) != val_sig.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> val_sig[n];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ll res = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(ll i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">                j = n / (n / i);</span><br><span class="line">                res = (res + (i + j) * (j - i + <span class="number">1</span>) / <span class="number">2</span> * (n / i) % mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> val_sig[n] = res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">map&lt;ll, ll&gt; val_muid;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sum_muid</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= N) &#123;</span><br><span class="line">        <span class="keyword">return</span> muid[n];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(val_muid.<span class="built_in">find</span>(n) != val_muid.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> val_muid[n];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ll res = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(ll i = <span class="number">2</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">                j = n / (n / i);</span><br><span class="line">                res = (res - (i + j) * (j - i + <span class="number">1</span>) / <span class="number">2</span> % mod * <span class="built_in">sum_muid</span>(n / i)) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> val_muid[n] = res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    d[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    muid[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= N ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">            d[i] = <span class="number">1</span> + i;</span><br><span class="line">            e[i] = <span class="number">1</span> + i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            pri[++ tot] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * pri[j] &lt;= N ; ++ j) &#123;</span><br><span class="line">            vis[i * pri[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                d[i * pri[j]] = d[i] / e[i] * (pri[j] * e[i] + <span class="number">1</span>);</span><br><span class="line">                e[i * pri[j]] = pri[j] * e[i] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                d[i * pri[j]] = d[i] * (<span class="number">1</span> + pri[j]);</span><br><span class="line">                e[i * pri[j]] = <span class="number">1</span> + pri[j];</span><br><span class="line">                mu[i * pri[j]] = -mu[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        d[i] = (d[i] + d[i - <span class="number">1</span>]) % mod;</span><br><span class="line">        muid[i] = (muid[i - <span class="number">1</span>] + mu[i] * i) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = n / (n / i);</span><br><span class="line">        ll sig = <span class="built_in">sum_sig1</span>(n / i) % mod;</span><br><span class="line">        sig = sig * sig % mod;</span><br><span class="line">        ll mui = (<span class="built_in">sum_muid</span>(j) - <span class="built_in">sum_muid</span>(i - <span class="number">1</span>)) % mod;</span><br><span class="line">        ans = (ans + mui % mod * sig % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, (ans % mod + mod) % mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/19/du-sieves/problems/51nod-1220/" data-id="ckqmfusad006k8ufyfitof8dg" data-title="杜教筛习题：51nod 1220 约数之和" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/51nod/" rel="tag">51nod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-du-sieves/du-sieves" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/19/du-sieves/du-sieves/" class="article-date">
  <time class="dt-published" datetime="2018-06-19T06:18:29.000Z" itemprop="datePublished">2018-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/19/du-sieves/du-sieves/">杜教筛</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=26103103&height=66"></iframe>

<p>对于一类函数求和，诸如</p>
<p>$$<br>F(n)=\sum_{i=1}^{n}f(i)<br>$$</p>
<p>不妨分别从以下两种角度考虑</p>
<h2 id="f-g-times-h"><a href="#f-g-times-h" class="headerlink" title="$f=g \times h$"></a>$f=g \times h$</h2><p>$$<br>\begin{align}<br>F(n)<br>&amp;=\sum_{i=1}^{n} f(i) \\<br>&amp;=\sum_{i=1}^{n}\sum_{d \mid i}g(d)h(\frac{i}{d}) \\<br>&amp;=\sum_{d=1}^{n}g(d)\sum_{i=1 \wedge d \mid i}^{n} h(\frac{i}{d}) \\<br>&amp;=\sum_{d=1}^{n}g(d)\sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} h(i) \\<br>&amp;=\sum_{d=1}^{n}g(d)H(\lfloor \frac{n}{d} \rfloor) \\<br>\end{align}<br>$$</p>
<p>这不就是数论分块的基本形式嘛</p>
<p>只要$G,H$能快速计算，就可以在$O((T(G)+T(H))\sqrt n)$的时间内计算出答案</p>
<h2 id="h-f-times-g"><a href="#h-f-times-g" class="headerlink" title="$h = f \times g$"></a>$h = f \times g$</h2><p>$$<br>\begin{align}<br>H(n)<br>&amp;=\sum_{i=1}^{n}h(i) \\<br>&amp;=\sum_{i=1}^{n}\sum_{d \mid i}f(d)g(\frac{i}{d}) \\<br>&amp;=\sum_{d=1}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor) \\<br>&amp;=g(1)F(n)+\sum_{d=2}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor) \\<br>\Rightarrow<br>&amp;g(1)F(n)=H(n)-\sum_{d=2}^{n}g(d)F(\lfloor \frac{n}{d} \rfloor)<br>\end{align}<br>$$</p>
<p>一般而言预处理$F$的前$n^{\frac{2}{3}}$项的值，对于后$n^{\frac{1}{3}}$项递归计算，时间复杂度为$O(n^{\frac{2}{3}})$</p>
<hr>
<p>大体来说求$f$的前缀和，就是找两个可以快速计算前缀和的函数$g,h$，使得$f,g,h$满足狄利克雷卷积关系</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/19/du-sieves/du-sieves/" data-id="ckqmfus8h001m8ufy8fdg43bx" data-title="杜教筛" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mob-inv/problems/bzoj-1101" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/11/mob-inv/problems/bzoj-1101/" class="article-date">
  <time class="dt-published" datetime="2018-06-11T06:07:05.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/11/mob-inv/problems/bzoj-1101/">莫比乌斯反演习题：bzoj 1101 [POI2007]Zap</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有$T$组询问，每次给定整数$a,b,d$，求有多少对正整数$x,y$，满足$x \le a \wedge y \le b \wedge (x,y)=d$</p>
<p>$1 \le a,b,d,T \le 50000$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>$$<br>\begin{aligned}<br>a \le b \\<br>\sum_{i=1}^{a}\sum_{j=1}^{b}[(i,j)=d]<br>&amp;=\sum_{i=1}^{\lfloor \frac{a}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{b}{d} \rfloor}[(i,j)=1] \\<br>&amp;=\sum_{i=1}^{\lfloor \frac{a}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{b}{d} \rfloor}\sum_{d’ \mid (i,j)}\mu(d’) \\<br>&amp;=\sum_{i=1}^{\lfloor \frac{a}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{b}{d} \rfloor}\sum_{d’ \mid i \wedge d’ \mid j}\mu(d’) \\<br>&amp;=\sum_{d’=1}^{\lfloor \frac{a}{d} \rfloor}\mu(d’)\sum_{d’ \mid i}^{\lfloor \frac{a}{d} \rfloor}\sum_{d’ \mid j}^{\lfloor \frac{b}{d} \rfloor}1 \\<br>&amp;=\sum_{d’=1}^{\lfloor \frac{a}{d} \rfloor}\mu(d’) \lfloor \frac{a}{dd’} \rfloor \lfloor \frac{b}{dd’} \rfloor<br>\end{aligned}<br>$$</p>
<p>$\lfloor \frac{a}{dd’} \rfloor \lfloor \frac{b}{dd’} \rfloor$的取值只有$O(\sqrt a + \sqrt b)$种，预处理$\mu$的前缀和，单次询问可以$O(\sqrt n)$计算</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, d, mu[N], vis[N], p[N], tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;d); <span class="keyword">if</span>(n &gt; m) <span class="built_in">swap</span>(n, m);</span><br><span class="line">    n /= d, m /= d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = <span class="built_in">min</span>(n / (n / i), m / (m / i));</span><br><span class="line">        ans += (ll) (mu[j] - mu[i - <span class="number">1</span>]) * (n / i) * (m / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= <span class="number">50000</span> ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) mu[i] = <span class="number">-1</span>, p[++ tot] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * p[j] &lt;= <span class="number">50000</span> ; ++ j) &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">        mu[i] += mu[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/11/mob-inv/problems/bzoj-1101/" data-id="ckqmfusao007f8ufy25d2bdl4" data-title="莫比乌斯反演习题：bzoj 1101 [POI2007]Zap" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mob-inv/problems/bzoj-3529" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/11/mob-inv/problems/bzoj-3529/" class="article-date">
  <time class="dt-published" datetime="2018-06-11T06:06:05.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/11/mob-inv/problems/bzoj-3529/">莫比乌斯反演习题：bzoj 3529 [Sdoi2014]数表</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有一张$n \times m$的数表，其第$i$行第$j$列$(1 \le i \le n, 1 \le j \le m)$的数值为能同时整除$i$和$j$的所有自然数之和</p>
<p>给定$a$, 计算数表中不大于$a$的数之和。</p>
<p>一共有$Q$组数据</p>
<p>$1 \le n, m \le 10^5  , 1 \le Q \le 2 \times 10^4$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>按照惯例还是先推式子，先假设没有$a$的限制，设$\sigma_k(n)=\sum_{d \mid n}d^k$</p>
<p>$$<br>\begin{aligned}<br>n \le m \\<br>\sum_{i=1}^{n}\sum_{j=1}^{m} \sum_{k \mid i \wedge k \mid j}k<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m} \sum_{k \mid (i,j)}k \\<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m} \sigma_1((i,j)) \\<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m} \sum_{d=1}^{n} \sigma_1(d) [(i,j)=d] \\<br>&amp;=\sum_{d=1}^{n} \sigma_1(d) \sum_{i=1}^{n}\sum_{j=1}^{m}[(i,j)=d] \\<br>&amp;=\sum_{d=1}^{n} \sigma_1(d) \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \mu(i) \lfloor \frac{n}{id} \rfloor \lfloor \frac{m}{id} \rfloor \\<br>&amp;=\sum_{T=1}^{n} \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \sum_{d \mid T}\sigma_1(d)\mu(\frac{T}{d}) \\<br>&amp;=\sum_{T=1}^{n} \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor f(T) \\<br>f(T)=\sum_{d \mid T}\sigma_1(d)\mu(\frac{T}{d})<br>\end{aligned}<br>$$</p>
<p>$f(T)$可以线性筛预处理</p>
<p>将询问按照$a$排序，$f$按照$\sigma_1$排序，离线后树状数组维护</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, P = <span class="number">1e5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a, T, p[N], tot, vis[N], g[N], mu[N], sum[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Q</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> n, m, id, a, ans;</span><br><span class="line">&#125; q[N]; <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Q a, Q b) &#123; <span class="keyword">return</span> a.a &lt; b.a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp_q_id</span><span class="params">(Q a, Q b)</span> </span>&#123; <span class="keyword">return</span> a.id &lt; b.id; &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">F</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> d, id;</span><br><span class="line">&#125; f[N]; <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (F a, F b) &#123; <span class="keyword">return</span> a.d &lt; b.d; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pw</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; b ; b &gt;&gt;= <span class="number">1</span>, a *= a) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) r *= a;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BT</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> a[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">for</span>( ; i &lt;= P ; i += i &amp; -i) a[i] += x; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="keyword">int</span> res = <span class="number">0</span>; <span class="keyword">for</span>( ; i ; i -= i &amp; -i) res += a[i]; <span class="keyword">return</span> res; &#125;</span><br><span class="line">&#125; bt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    f[<span class="number">1</span>].d = f[<span class="number">1</span>].id = mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= P ; ++ i) &#123;</span><br><span class="line">        f[i].id = i;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">            p[++ tot] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            f[i].d = i + <span class="number">1</span>;</span><br><span class="line">            g[i] = <span class="number">1</span>;</span><br><span class="line">            sum[i] = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; i * p[j] &lt;= P ; ++ j) &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                g[i * p[j]] = g[i] + <span class="number">1</span>;</span><br><span class="line">                sum[i * p[j]] = sum[i] + <span class="built_in">pw</span>(p[j], g[i] + <span class="number">1</span>);</span><br><span class="line">                f[i * p[j]].d = f[i].d / sum[i] * sum[i * p[j]];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mu[i * p[j]] = -mu[i];</span><br><span class="line">                f[i * p[j]].d = f[i].d * f[p[j]].d;</span><br><span class="line">                g[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">                sum[i * p[j]] = p[j] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= T ; ++ i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;q[i].n, &amp;q[i].m, &amp;q[i].a), q[i].id = i;</span><br><span class="line">    <span class="built_in">sort</span>(q + <span class="number">1</span>, q + <span class="number">1</span> + T), <span class="built_in">sort</span>(f + <span class="number">1</span>, f + <span class="number">1</span> + P);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, p = <span class="number">1</span> ; i &lt;= T ; ++ i) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>( ; f[p].d &lt;= q[i].a &amp;&amp; p &lt;= P ; ++ p)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j * f[p].id &lt;= P ; ++ j)</span><br><span class="line">                bt.<span class="built_in">add</span>(j * f[p].id, f[p].d * mu[j]);</span><br><span class="line">        <span class="keyword">if</span>(q[i].n &gt; q[i].m) <span class="built_in">swap</span>(q[i].n, q[i].m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>, k ; j &lt;= q[i].n ; j = k + <span class="number">1</span>)</span><br><span class="line">            k = <span class="built_in">min</span>(q[i].n / (q[i].n / j), q[i].m / (q[i].m / j)),</span><br><span class="line">            q[i].ans += (q[i].n / j) * (q[i].m / j) * (bt.<span class="built_in">sum</span>(k) - bt.<span class="built_in">sum</span>(j - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(q + <span class="number">1</span>, q + <span class="number">1</span> + T, cmp_q_id);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= T ; ++ i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, q[i].ans &amp; <span class="number">2147483647</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/11/mob-inv/problems/bzoj-3529/" data-id="ckqmfusdp00jl8ufyd59v2ucm" data-title="莫比乌斯反演习题：bzoj 3529 [Sdoi2014]数表" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mob-inv/problems/bzoj-2956" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/11/mob-inv/problems/bzoj-2956/" class="article-date">
  <time class="dt-published" datetime="2018-06-11T06:05:05.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/11/mob-inv/problems/bzoj-2956/">莫比乌斯反演习题：bzoj 2956 模积和</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>求$\sum_{i=1}^{n}\sum_{j=1}^{m}(n \text{ mod } i) \times (m \text{ mod } j)$</p>
<p>其中$1 \le i \le n,1 \le j \le m,i \not = j$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>$$<br>\begin{aligned}<br>A<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m}(n \text{ mod } i) \times (m \text{ mod } j) \\<br>&amp;=(\sum_{i=1}^{n}n \text{ mod } i)(\sum_{j=1}^{m}m \text{ mod } j) \\<br>&amp;=f(n)f(m)<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>f(n)<br>&amp;=\sum_{i=1}^{n}n \text{ mod } i \\<br>&amp;=\sum_{i=1}^{n}n - i \lfloor \frac{n}{i} \rfloor \\<br>&amp;=n^2-\sum_{i=1}^{n}i \lfloor \frac{n}{i} \rfloor<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>g(k)<br>&amp;=\sum_{i=1}^{n}i \lfloor \frac{k}{i} \rfloor<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>B<br>&amp;=\sum_{i=1}^{n}(n \text{ mod } i)(m \text{ mod } i) \\<br>&amp;=\sum_{i=1}^{n}(n - i \lfloor \frac{n}{i} \rfloor)(m - i \lfloor \frac{m}{i} \rfloor) \\<br>&amp;=\sum_{i=1}^{n}nm+i^2\lfloor \frac{n}{i} \rfloor \lfloor \frac{m}{i} \rfloor-im\lfloor \frac{n}{i} \rfloor-in\lfloor \frac{m}{i} \rfloor \\<br>&amp;=n^2m+(\sum_{i=1}^{n}i^2\lfloor \frac{n}{i} \rfloor\lfloor \frac{m}{i} \rfloor)-(m\sum_{i=1}^{n}i\lfloor \frac{n}{i} \rfloor)-(n\sum_{i=1}^{n}i\lfloor \frac{m}{i} \rfloor) \\<br>&amp;=n^2m+(\sum_{i=1}^{n}i^2\lfloor \frac{n}{i} \rfloor\lfloor \frac{m}{i} \rfloor)-mg(n)-ng(m)<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>ans<br>&amp;=A-B \\<br>&amp;=f(n)f(m)+mg(n)+ng(m)-n^2m-(\sum_{i=1}^{n}i^2\lfloor \frac{n}{i} \rfloor\lfloor \frac{m}{i} \rfloor)<br>\end{aligned}<br>$$</p>
<p>注意$19940417=2848631 \times 7$，而且计算平方和的时候会爆long long，所以需要手动算逆元</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">19940417</span>;</span><br><span class="line"></span><br><span class="line">ll n, m;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll k)</span> </span>&#123;</span><br><span class="line">    ll r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(k / i == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        j = <span class="built_in">min</span>(n, k / (k / i));</span><br><span class="line">        r = (r + (i + j) * (j - i + <span class="number">1</span>) / <span class="number">2</span> % p * (k / i) % p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    ll r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = n / (n / i);</span><br><span class="line">        r = (r + (i + j) * (j - i + <span class="number">1</span>) / <span class="number">2</span> % p * (n / i)) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (n * n % p - r % p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sum</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n * (n + <span class="number">1</span>) % p * (<span class="number">2</span> * n + <span class="number">1</span>) % p * <span class="number">3323403</span> % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">w</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n / i == <span class="number">0</span> || m / i == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        j = <span class="built_in">min</span>(n / (n / i), m / (m / i));</span><br><span class="line">        r = (r + (<span class="built_in">sum</span>(j) - <span class="built_in">sum</span>(i - <span class="number">1</span>)) % p * (n / i) % p * (m / i) % p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;m); <span class="keyword">if</span>(n &gt; m) <span class="built_in">swap</span>(n, m);</span><br><span class="line">    ll ans = <span class="built_in">f</span>(n) * <span class="built_in">f</span>(m) % p + m * <span class="built_in">g</span>(n) % p + n * <span class="built_in">g</span>(m) % p - n * n % p * m % p - <span class="built_in">w</span>() % p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, (ans % p + p) % p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/11/mob-inv/problems/bzoj-2956/" data-id="ckqmfusdo00jk8ufyccayelms" data-title="莫比乌斯反演习题：bzoj 2956 模积和" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mob-inv/problems/bzoj-2820" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/11/mob-inv/problems/bzoj-2820/" class="article-date">
  <time class="dt-published" datetime="2018-06-11T06:04:05.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/11/mob-inv/problems/bzoj-2820/">莫比乌斯反演习题：bzoj 2820 YY的GCD</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有$T$组询问，每次给定$n,m$求$1 \le x \le n \wedge 1 \le y \le m \wedge (x,y) \in P$的$(x,y)$的个数，其中$P$是素数集合</p>
<p>$T = 10000 \wedge n,m \le 10000000$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>大力推一波式子吧</p>
<p>$$<br>\begin{aligned}<br>n \le m \\<br>\sum_{p \in P}\sum_{i=1}^{n}\sum_{j=1}^{m}[(i,j)=p]<br>&amp;=\sum_{p \in P}\sum_{d=1}^{\lfloor \frac{n}{p} \rfloor}\mu(d)\lfloor \frac{n}{pd} \rfloor \lfloor \frac{m}{pd} \rfloor \\<br>&amp;=\sum_{p \in P}\sum_{T=1 \wedge p \mid T}^{n} \mu(\frac{T}{p}) \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \\<br>&amp;=\sum_{T=1}^{n} \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \sum_{p \in P \wedge p \mid T} \mu(\frac{T}{p}) \\<br>&amp;=\sum_{T=1}^{n} \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor f(T) \\<br>f(T)=\sum_{p \in P \wedge p  \mid  T}\mu(\frac{T}{p})<br>\end{aligned}<br>$$</p>
<p>对于每一个$p$，$p \mid T \wedge T \le n$的$T$的取值有$\lfloor \frac{n}{p} \rfloor$种，用每个素数来更新它的倍数的$f$值即可</p>
<p>由于素数定理及调和级数可得知预处理是$O(n+\frac{n}{\log n} \log \frac{n}{\log n})=O(n)$的 <del>实际上是$O(n \log \log n)$的</del></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10000000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N], tot, vis[N], mu[N], n, m;</span><br><span class="line"></span><br><span class="line">ll f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m); <span class="keyword">if</span>(n &gt; m) <span class="built_in">swap</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = <span class="built_in">min</span>(n / (n / i), m / (m / i));</span><br><span class="line">        ans += (f[j] - f[i - <span class="number">1</span>]) * (n / i) * (m / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= <span class="number">10000000</span> ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) vis[i] = <span class="number">1</span>, p[++ tot] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * p[j] &lt;= <span class="number">10000000</span> ; ++ j) &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; (ll) p[i] * j &lt;= <span class="number">10000000</span> ; ++ j)</span><br><span class="line">            f[p[i] * j] += mu[j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">10000000</span> ; ++ i) f[i] += f[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/11/mob-inv/problems/bzoj-2820/" data-id="ckqmfusas007q8ufy7y49gisz" data-title="莫比乌斯反演习题：bzoj 2820 YY的GCD" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mob-inv/problems/bzoj-2301" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/11/mob-inv/problems/bzoj-2301/" class="article-date">
  <time class="dt-published" datetime="2018-06-11T06:03:05.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/11/mob-inv/problems/bzoj-2301/">莫比乌斯反演习题：bzoj 2301 [HAOI2011]Problem b</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有$T$组询问，每次给定整数$a,b,c,d,k$，求有多少对正整数$x,y$，满足$a \le x \le b \wedge c \le y \le d \wedge (x,y)=k$</p>
<p>$1 \le a,b,c,d,k,T \le 50000 \wedge a \le b \wedge c \le d$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>与bzoj1101类似，在二维前缀和上大力容斥</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mu[N], vis[N], p[N], tot;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sol</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; m) <span class="built_in">swap</span>(n, m);</span><br><span class="line">    n /= d, m /= d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= n ; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">        j = <span class="built_in">min</span>(n / (n / i), m / (m / i));</span><br><span class="line">        ans += (ll) (mu[j] - mu[i - <span class="number">1</span>]) * (n / i) * (m / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d, &amp;k);</span><br><span class="line">    ll ans = <span class="built_in">sol</span>(b, d, k) + <span class="built_in">sol</span>(a - <span class="number">1</span>, c - <span class="number">1</span>, k) - <span class="built_in">sol</span>(a - <span class="number">1</span>, d, k) - <span class="built_in">sol</span>(b, c - <span class="number">1</span>, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= <span class="number">50000</span> ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) mu[i] = <span class="number">-1</span>, p[++ tot] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * p[j] &lt;= <span class="number">50000</span> ; ++ j) &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">        mu[i] += mu[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/11/mob-inv/problems/bzoj-2301/" data-id="ckqmfusar007n8ufyg0nm1eip" data-title="莫比乌斯反演习题：bzoj 2301 [HAOI2011]Problem b" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/7/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/9/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/2021/">2021</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/demo/">demo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/develop/">develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mess/">mess</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/solution/">solution</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/travel/">travel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/">文化课</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2021/" rel="tag">2021</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/51nod/" rel="tag">51nod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HEOI2019/" rel="tag">HEOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NOI2019/" rel="tag">NOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ODT/" rel="tag">ODT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ST%E8%A1%A8/" rel="tag">ST表</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atcoder/" rel="tag">atcoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeforces/" rel="tag">codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dinic/" rel="tag">dinic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/excrt/" rel="tag">excrt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exgcd/" rel="tag">exgcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ezoj/" rel="tag">ezoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fwt/" rel="tag">fwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gcd/" rel="tag">gcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kdtree/" rel="tag">kdtree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" rel="tag">kruskal重构树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loj/" rel="tag">loj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/" rel="tag">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/noip/" rel="tag">noip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powerful-number/" rel="tag">powerful number</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prufer%E5%BA%8F%E5%88%97/" rel="tag">prufer序列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spoj/" rel="tag">spoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie/" rel="tag">trie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" rel="tag">三元环</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" rel="tag">三角换元</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" rel="tag">二进制分组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" rel="tag">信息学竞赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%B8%E5%8C%85/" rel="tag">凸包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BD%E6%95%B0/" rel="tag">函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%9D%97/" rel="tag">分块</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" rel="tag">前缀和</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" rel="tag">前缀和与差分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" rel="tag">单位根</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" rel="tag">单位根反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E6%BC%94/" rel="tag">反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E6%95%B0/" rel="tag">复数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" rel="tag">多边形</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" rel="tag">多项式乘法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%97%E8%B7%AF/" rel="tag">套路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" rel="tag">定期重构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" rel="tag">定积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%B9%E6%8B%8D/" rel="tag">对拍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">广义后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" rel="tag">循环矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" rel="tag">微分方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" rel="tag">微机学考</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" rel="tag">微积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" rel="tag">快速幂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%9F%E9%98%B5/" rel="tag">拟阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%88%97/" rel="tag">排列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" rel="tag">整体二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" rel="tag">文化课</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" rel="tag">斜率优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" rel="tag">斯特林数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" rel="tag">最小乘积问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%9F%E6%9C%9B/" rel="tag">期望</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%81%E9%99%90/" rel="tag">极限</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E7%8E%87/" rel="tag">概率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1/" rel="tag">模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" rel="tag">模拟赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" rel="tag">模拟退火</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E8%AE%B0/" rel="tag">游记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" rel="tag">特征方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag">生成函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" rel="tag">矩阵树定理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E5%88%86/" rel="tag">积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" rel="tag">积性函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" rel="tag">笛卡尔树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" rel="tag">类欧几里得</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" rel="tag">线性筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%A9%E6%94%BE/" rel="tag">缩放</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">网络流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%A4%E8%AE%BA/" rel="tag">群论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85/" rel="tag">背包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" rel="tag">计算几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E6%8E%A5/" rel="tag">链接</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" rel="tag">随机化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">非旋转平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/2021/" style="font-size: 10px;">2021</a> <a href="/tags/51nod/" style="font-size: 10px;">51nod</a> <a href="/tags/HEOI2019/" style="font-size: 10px;">HEOI2019</a> <a href="/tags/NOI2019/" style="font-size: 10px;">NOI2019</a> <a href="/tags/ODT/" style="font-size: 10px;">ODT</a> <a href="/tags/ST%E8%A1%A8/" style="font-size: 10px;">ST表</a> <a href="/tags/atcoder/" style="font-size: 10px;">atcoder</a> <a href="/tags/bzoj/" style="font-size: 15.83px;">bzoj</a> <a href="/tags/codeforces/" style="font-size: 10px;">codeforces</a> <a href="/tags/demo/" style="font-size: 11.67px;">demo</a> <a href="/tags/dinic/" style="font-size: 10px;">dinic</a> <a href="/tags/excrt/" style="font-size: 10px;">excrt</a> <a href="/tags/exgcd/" style="font-size: 10px;">exgcd</a> <a href="/tags/ezoj/" style="font-size: 10.83px;">ezoj</a> <a href="/tags/fwt/" style="font-size: 11.67px;">fwt</a> <a href="/tags/gcd/" style="font-size: 10px;">gcd</a> <a href="/tags/hdu/" style="font-size: 11.67px;">hdu</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/kdtree/" style="font-size: 10px;">kdtree</a> <a href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" style="font-size: 10px;">kruskal重构树</a> <a href="/tags/loj/" style="font-size: 10.83px;">loj</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/noip/" style="font-size: 11.67px;">noip</a> <a href="/tags/powerful-number/" style="font-size: 10px;">powerful number</a> <a href="/tags/prufer%E5%BA%8F%E5%88%97/" style="font-size: 10px;">prufer序列</a> <a href="/tags/spoj/" style="font-size: 10px;">spoj</a> <a href="/tags/trie/" style="font-size: 10px;">trie</a> <a href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" style="font-size: 10px;">三元环</a> <a href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" style="font-size: 10px;">三角换元</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" style="font-size: 10px;">二进制分组</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" style="font-size: 10px;">信息学竞赛</a> <a href="/tags/%E5%87%B8%E5%8C%85/" style="font-size: 10px;">凸包</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 10px;">函数</a> <a href="/tags/%E5%88%86%E5%9D%97/" style="font-size: 10px;">分块</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" style="font-size: 10px;">前缀和</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" style="font-size: 10px;">前缀和与差分</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" style="font-size: 11.67px;">单位根</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" style="font-size: 10.83px;">单位根反演</a> <a href="/tags/%E5%8F%8D%E6%BC%94/" style="font-size: 10px;">反演</a> <a href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">后缀自动机</a> <a href="/tags/%E5%A4%8D%E6%95%B0/" style="font-size: 10.83px;">复数</a> <a href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" style="font-size: 10px;">多边形</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size: 12.5px;">多项式</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" style="font-size: 10px;">多项式乘法</a> <a href="/tags/%E5%A5%97%E8%B7%AF/" style="font-size: 10px;">套路</a> <a href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" style="font-size: 10px;">定期重构</a> <a href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" style="font-size: 10px;">定积分</a> <a href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" style="font-size: 10.83px;">容斥原理</a> <a href="/tags/%E5%AF%B9%E6%8B%8D/" style="font-size: 10px;">对拍</a> <a href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 12.5px;">平衡树</a> <a href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">广义后缀自动机</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 10px;">开发</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">循环矩阵</a> <a href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">微分方程</a> <a href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" style="font-size: 10px;">微机学考</a> <a href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" style="font-size: 11.67px;">微积分</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" style="font-size: 10px;">快速幂</a> <a href="/tags/%E6%8B%9F%E9%98%B5/" style="font-size: 10px;">拟阵</a> <a href="/tags/%E6%8E%92%E5%88%97/" style="font-size: 10px;">排列</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 20px;">数学</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 17.5px;">数论</a> <a href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" style="font-size: 10px;">整体二分</a> <a href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" style="font-size: 10px;">文化课</a> <a href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" style="font-size: 10px;">斜率优化</a> <a href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" style="font-size: 10.83px;">斯特林数</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" style="font-size: 10px;">最小乘积问题</a> <a href="/tags/%E6%9C%9F%E6%9C%9B/" style="font-size: 10px;">期望</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" style="font-size: 13.33px;">杜教筛</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" style="font-size: 12.5px;">杜教筛习题</a> <a href="/tags/%E6%9E%81%E9%99%90/" style="font-size: 10px;">极限</a> <a href="/tags/%E6%A6%82%E7%8E%87/" style="font-size: 11.67px;">概率</a> <a href="/tags/%E6%A8%A1/" style="font-size: 10px;">模</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" style="font-size: 10px;">模拟赛</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" style="font-size: 10px;">模拟退火</a> <a href="/tags/%E6%B8%B8%E8%AE%B0/" style="font-size: 10.83px;">游记</a> <a href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">特征方程</a> <a href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" style="font-size: 10.83px;">生成函数</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 14.17px;">矩阵</a> <a href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" style="font-size: 10px;">矩阵树定理</a> <a href="/tags/%E7%A7%AF%E5%88%86/" style="font-size: 10px;">积分</a> <a href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" style="font-size: 10px;">积性函数</a> <a href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" style="font-size: 10px;">笛卡尔树</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 19.17px;">算法</a> <a href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" style="font-size: 10.83px;">类欧几里得</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" style="font-size: 14.17px;">线性变换</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" style="font-size: 13.33px;">线性变换与矩阵递推习题</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" style="font-size: 10px;">线性筛</a> <a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size: 10.83px;">组合数学</a> <a href="/tags/%E7%BC%A9%E6%94%BE/" style="font-size: 10px;">缩放</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size: 10px;">网络流</a> <a href="/tags/%E7%BE%A4%E8%AE%BA/" style="font-size: 10px;">群论</a> <a href="/tags/%E8%83%8C%E5%8C%85/" style="font-size: 10px;">背包</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" style="font-size: 16.67px;">莫比乌斯反演</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" style="font-size: 15px;">莫比乌斯反演习题</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size: 10px;">计算几何</a> <a href="/tags/%E9%80%92%E6%8E%A8/" style="font-size: 14.17px;">递推</a> <a href="/tags/%E9%93%BE%E6%8E%A5/" style="font-size: 10px;">链接</a> <a href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" style="font-size: 10px;">随机化</a> <a href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 10px;">非旋转平衡树</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 18.33px;">题解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/09/">September 2000</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/06/15/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/02/24/hexo-fea-bg/">hexo:不是bug是feature</a>
          </li>
        
          <li>
            <a href="/2021/01/01/hello-2021/">2021</a>
          </li>
        
          <li>
            <a href="/2020/08/06/net-flow/net-flow/">网络流</a>
          </li>
        
          <li>
            <a href="/2020/08/06/zheng-ti-er-fen/zheng-ti-er-fen/">整体二分</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>