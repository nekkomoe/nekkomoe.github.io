<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-excrt/excrt" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/08/excrt/excrt/" class="article-date">
  <time class="dt-published" datetime="2018-10-08T09:26:26.000Z" itemprop="datePublished">2018-10-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/08/excrt/excrt/">扩展中国剩余定理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><del>实际上是同余方程组的合并</del></p>
<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>如果给定$n$个同余方程组<br>$$<br>\begin{cases}<br>x &amp;\equiv b_1 \pmod {a_1} \\<br>x &amp;\equiv b_2 \pmod {a_2} \\<br>x &amp;\equiv b_3 \pmod {a_3} \\<br>&amp;\cdots \\<br>x &amp;\equiv b_n \pmod {a_n} \\<br>\end{cases}<br>$$<br>保证$a$是正整数，$b$是非负整数</p>
<p>现在要求找一个非负整数$x$，使得$x$最小且满足这$n$同余方程</p>
<p><strong>数据保证$x$不超过$10^{18}$</strong></p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>现在考虑合并两个同余方程的时候该怎么做<br>$$<br>\begin{cases}<br>x \equiv b \pmod {a} \\<br>x \equiv B \pmod {A}<br>\end{cases}<br>$$<br>这个可以写作<br>$$<br>\begin{cases}<br>x = ay + b \\<br>x = AY + B<br>\end{cases}<br>$$<br>由于$x$是一个常量，因此$ay+b=AY+B$，其中$a,b,A,B$都是常数</p>
<p>整理一下后就是$ay+A(-Y)=B-b$</p>
<p>通过$exgcd$，可以获得一组关于$ay+A(-Y)=\gcd(a,A)$的解$(y_0,-Y_0)$</p>
<p>即$a(y_0 \times \frac{B-b}{\gcd(a,A)})+A(-Y_0 \times \frac{B-b}{\gcd(a,A)})=\gcd(a,A) \times \frac{B-b}{\gcd(a,A)}=B-b$</p>
<p>由于$x=ay+b$，现在要最小化$x$，也就是最小化$y$，即最小化$t=y_0 \times \frac{B-b}{\gcd(a,A)}$</p>
<p>由于$t$的通解为$t+\frac{A}{\gcd(a,A)}k$，因此$t$的最小值为$t_0=t \bmod \frac{A}{\gcd(a,A)}$</p>
<p>于是就可以将这两个同余方程合并为<br>$$<br>x \equiv a \times t_0+b \pmod {\mathbb{lcm}(a,A)}<br>$$</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> __int128 ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll x, y, d; <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">exgcd</span>(y, x, b, a % b), y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">lcm</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a / <span class="built_in">gcd</span>(a, b) * b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll a, b, A, B;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">exgcd</span>(x, y, a, A);</span><br><span class="line">    ll c = B - b;</span><br><span class="line">    <span class="keyword">if</span>(c % d) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    x = x * c / d % (A / d);</span><br><span class="line">    <span class="keyword">if</span>(x &lt; <span class="number">0</span>) x += A / d;</span><br><span class="line">    ll mod = <span class="built_in">lcm</span>(a, A);</span><br><span class="line">    b = (a * x + b) % mod; <span class="keyword">if</span>(b &lt; <span class="number">0</span>) b += mod;</span><br><span class="line">    a = mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> _A, _B;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;_A, &amp;_B), A = _A, B = _B;</span><br><span class="line">        <span class="keyword">if</span>(i &gt; <span class="number">1</span>) <span class="built_in">merge</span>();</span><br><span class="line">        <span class="keyword">else</span> a = A, b = B;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, (<span class="keyword">long</span> <span class="keyword">long</span>)(b % a));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/10/08/excrt/excrt/" data-id="ckqmfus8r00238ufy4sxbbkfz" data-title="扩展中国剩余定理" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/excrt/" rel="tag">excrt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exgcd/" rel="tag">exgcd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gcd/" rel="tag">gcd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-unit-root-inv/unit-root-inv" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/13/unit-root-inv/unit-root-inv/" class="article-date">
  <time class="dt-published" datetime="2018-09-13T11:08:38.000Z" itemprop="datePublished">2018-09-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/13/unit-root-inv/unit-root-inv/">单位根反演</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前置技能"><a href="#前置技能" class="headerlink" title="前置技能"></a>前置技能</h1><ul>
<li><a target="_blank" rel="noopener" href="https://zhang-rq.github.io/2018/08/13/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/#%E5%8D%95%E4%BD%8D%E6%A0%B9">单位根</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86">二项式定理</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BB%84%E5%90%88%E6%95%B0">组合数</a></li>
</ul>
<h1 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h1><p>从<a target="_blank" rel="noopener" href="https://loj.ac/problem/6485">一道题</a>说起……</p>
<blockquote>
<p>给定$n,s,a_0,a_1,a_2,a_3$，求</p>
<p>$$\sum_{i=0}^{n} {n \choose i} s^i a_{i \bmod 4}$$</p>
<p>答案对$998244353$取模</p>
<p>$1 \le n \le 10^{18}, 1 \le s,a_0,a_1,a_2,a_3 \le 10^8$</p>
</blockquote>
<p><del>一脸绝望</del></p>
<p>在高中的时候，数学老师教会了我们$(a+b)^{n}=\sum_{i=0}^{n}{n \choose i}a^{i}b^{n-i}$，然后惊喜的发现这道题不能这么做！</p>
<p>在$OI$中，我们学习了单位根的基本性质（如果还未学，可从<strong>前置技能</strong>部分的<strong>单位根</strong>处点击链接学习），关于单位根还有一个迷之用法——单位根反演</p>
<h1 id="构造生成函数"><a href="#构造生成函数" class="headerlink" title="构造生成函数"></a>构造生成函数</h1><p>对于数列$a_i$，构造其生成函数$f(x)=\sum_{i=0}^{n}a_ix^i$</p>
<p>现在我们想知道所有下标是$k$的倍数的$a_i$的和，既$\sum_{i=0}^{n}a_i[k|i]$</p>
<h1 id="一个关于-n-k-的等式"><a href="#一个关于-n-k-的等式" class="headerlink" title="一个关于$[n|k]$的等式"></a>一个关于$[n|k]$的等式</h1><p>有一个关于$n$次单位根$w_n$的等式，看起来十分有趣 <del>毒瘤</del></p>
<p>$$[n|k]=\frac{1}{n}\sum_{i=0}^{n-1}\omega_n^{ki}$$</p>
<h2 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h2><p>如果$n \mid k$，设$k=np$，则</p>
<p>$$\frac{1}{n}\sum_{i=0}^{n-1}w_n^{npi \bmod n}=\frac{1}{n}\sum_{i=0}^{n-1}w_n^{0}=1$$</p>
<p>注：$npi \bmod n=(n \bmod n) \times (pi \bmod n)=0 \times (pi \bmod n)=0$</p>
<p>如果$n \nmid k$，根据等比数列求和公式，则</p>
<p>$$\frac{1}{n}\sum_{i=0}^{n-1}\omega_{n}^{ki}=\frac{1}{n}(w_n^{0}\frac{1-\omega_n^{k(n-1)}}{1-w_n^{k}})=\frac{w_n^0-w_n^{kn}}{n(1-\omega_n^{k})}=0$$</p>
<p>于是对于$N$次单位根$w_N$可以这么搞：</p>
<p>$$\frac{\sum_{i=0}^{N-1}f(w_N^i)}{N}=\frac{\sum_{i=0}^{n}a_i\sum_{j=0}^{N-1}w_N^{ij}}{N}=\sum_{i=0}^{n}a_i[N \mid i]$$</p>
<p>于是就可以得到所有下标是$N$的倍数的$a_i$的和了</p>
<h1 id="有一个问题"><a href="#有一个问题" class="headerlink" title="有一个问题"></a>有一个问题</h1><p>但是发现，只知道所有$N \mid i$的$a_i$的和还不够有用，如果分别知道$i \bmod N \in [0,N-1]$的$a_i$的和的话就十分有用了</p>
<p>数学老师告诉我们，$f(x)$通过乘以$x$的若干次幂可以实现函数的平移（虽然说这句话不太严谨……但还是可以凑合着看看……）</p>
<p>比如说现在有$f(x)=a_0x^{0}+a_1x^{1}+a_2x^{2} + \dots$</p>
<p>对其乘上$x^{-1}$后会得到$f(x)x^{-1}=a_0x^{-1}+a_1x^{0}+a_2x^{1} + \dots$</p>
<p>再用上面的方法求后就得到了$N \bmod i = 1$的所有$a_i$和</p>
<h1 id="回到例题"><a href="#回到例题" class="headerlink" title="回到例题"></a>回到例题</h1><p>在这道题中，构造$f(x)=\sum_{i=0}^{n} {n \choose i} s^i x^i 1^{n-i}=(sx+1)^n$</p>
<p>则答案为$\sum_{i=0}^{3}a_ic_i$，其中$c_i=\sum\limits_{j=0}^{n}{n \choose j}s^j[j \bmod 4 = i]$</p>
<p>对于$c_i$的$f(\omega_N^j)$，因为需要将$\omega_N^{j}$向右平移$i$次，只需要将其变为$\huge \frac{f(\omega_N^j)}{\omega_N^{ij \bmod 4}}$即可</p>
<h1 id="扩展到矩阵上"><a href="#扩展到矩阵上" class="headerlink" title="扩展到矩阵上"></a>扩展到矩阵上</h1><p><a target="_blank" rel="noopener" href="https://www.lydsy.com/JudgeOnline/problem.php?id=3328">bzoj 3328</a></p>
<h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定$n,k,p$，求</p>
<p>$$\sum_{i=0}^{\lfloor \frac{n}{k} \rfloor} {n \choose ik}F_{ik}$$</p>
<p>其中$F_0=F_1=1$，且$\forall n \ge 2,F_i=F_{i-1}+F_{i-2}$</p>
<p>答案对$p$取模</p>
<p>$1 \le n \le 10^{18}$</p>
<p>$1 \le k \le 20000$</p>
<p>$1 \le p \le 10^9$</p>
<p>$p$是素数</p>
<p>$p \bmod k = 1$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>单位根反演的结论在矩阵意义上也是成立的</p>
<p>也就是说求</p>
<p>$$\sum_{i=0}^{n} {n \choose i} F_i [k \mid i]$$</p>
<p>设$A$是斐波那契数列的转移矩阵，$I$为单位矩阵</p>
<p>通过套用二项式定理，有</p>
<p>$$f(x)=(Ax+I)^n=\sum_{i=0}^{n} {n \choose i}A^ix^iI^{n-i}$$</p>
<p>再套用单位根反演，有</p>
<p>$$T=\frac{\sum_{i=0}^{k-1}f(\omega_k^i)}{k}$$</p>
<p>然后就做完了，答案就是矩阵$T$的左上角</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>如果想计算序列$a_0, a_1,a_2, \dots , a_n$的所有满足$k|i$的$a_i$的和的话</p>
<p>首先构造$f(x)=\sum_{i=0}^{n}a_ix^i$</p>
<p>然后将$\omega_k^i(i \in [0,k-1])$依次代入到$f(x)$中，并求和</p>
<p>最后除以$k$即可</p>
<p>也就是说</p>
<p>$$\sum_{i=0}^{n}a_i[k|i]=\frac{1}{k}\sum_{i=0}^{k-1}f(\omega_k^i)$$</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a target="_blank" rel="noopener" href="https://zhang-rq.github.io/2018/08/13/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Zhang-RQ 单位根反演学习笔记</a></p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.org/blog/ShadowassIIXVIIIIV/loj6485-ljj-xue-er-xiang-shi-ding-li">shadowice1984 loj6485 LJJ学二项式定理</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/DT_Kang/article/details/79944113">DT_Kang 【4.13 提高班小记】单位根&amp;&amp;杂题</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Mys_C_K/article/details/81388266">Mys_C_K [真学习笔记] 前夕 - 单位根反演 - 广义容斥</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/regina8023/article/details/45007551">Regina8023 【BZOJ 3328】PYXFIB</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/13/unit-root-inv/unit-root-inv/" data-id="ckqmfusa2005k8ufy5e6v04tj" data-title="单位根反演" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" rel="tag">单位根</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" rel="tag">单位根反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%8D%E6%95%B0/" rel="tag">复数</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-in-ex/in-ex" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/13/in-ex/in-ex/" class="article-date">
  <time class="dt-published" datetime="2018-09-13T09:53:07.000Z" itemprop="datePublished">2018-09-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/13/in-ex/in-ex/">初探容斥原理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=450222764&height=66"></iframe>

<h1 id="一些前置技能"><a href="#一些前置技能" class="headerlink" title="一些前置技能"></a>一些前置技能</h1><h2 id="二项式定理"><a href="#二项式定理" class="headerlink" title="二项式定理"></a>二项式定理</h2><p>$$\sum_{i=0}^{n}{n \choose i}a^ib^{n-i}=(a+b)^n$$</p>
<h2 id="交换求和号"><a href="#交换求和号" class="headerlink" title="交换求和号"></a>交换求和号</h2><p>这个不太好描述……具体问题具体分析……就举个例子……</p>
<p>$$\sum_{i=0}^{n} f(i) \sum_{j=0}^{i} g(j)h(i,j)=\sum_{j=0}^{n} g(j) \sum_{i=j}^{n} f(i)h(i,j)$$</p>
<p>交换后只要保证每一组乘积与之前一一对应即可</p>
<h2 id="组合数经典公式"><a href="#组合数经典公式" class="headerlink" title="组合数经典公式"></a>组合数经典公式</h2><p>$${n \choose i}={n-1 \choose i}+{n-1 \choose i-1}$$</p>
<p>公式化的理解：手动拆开式子然后约分</p>
<p>从组和数上的意义理解：从$n$个物品中挑选出$i$个物品，相当于考虑是否最终挑选出第$i$个物品，如果不挑选出，那么方案数为${n-1 \choose i}$，如果挑选出，那么方案为${n-1 \choose i-1}$</p>
<p>这个公式十分有用……如果是一个组合数乘上一个$-1$的若干次幂后求和的形式，可以直接大力拆式子，然后一正一负就消掉了……</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/werkeytom_ftd/article/details/74701513">WerKeyTom_FTD 《容斥的原理及广义应用》</a></p>
<h1 id="什么是容斥"><a href="#什么是容斥" class="headerlink" title="什么是容斥"></a>什么是容斥</h1><p>从一个简单的例题说起</p>
<p>有$k$种属性，你有一个函数$f(S)$，可以快速得知至少满足$S$属性的集合的物品个数，同时定义$f(\emptyset)=0$</p>
<p>现在你想知道至少有一种属性的物品的个数，$k \le 20$</p>
<p>可能小学老师们告诉过你，答案就是</p>
<p>$$\sum_{S \subseteq U}f(S)(-1)^{|S|+1}$$</p>
<p>通过文氏图，可以轻而易举的得知在$k \le 3$的时候是十分清晰易懂的，那么在$k$更高维的情况下，不妨证明一下为什么这个式子是对的</p>
<p>考虑每一个物品，假设它有$n$个属性，当然在$n=0$的时候只会被$f(\emptyset)$枚举到，而且对答案的贡献为$0$</p>
<p>如果$n \ge 1$，那么可以枚举一下它的属性会被哪些组合枚举到，既</p>
<p>$$\begin{aligned}\sum_{i=1}^{n} {n \choose i} (-1)^{i+1}&amp;=-(\sum_{i=1}^{n} {n \choose i} (-1)^{i})\\&amp;=-((1-1)^n-1)\\&amp;=1\end{aligned}$$</p>
<p>因此这个物品如果至少有一个属性的话那么一定会被只对答案产生$1$的贡献</p>
<p><del>也许对容斥有了一些感性的理解了吧</del></p>
<h1 id="一般化的经典容斥"><a href="#一般化的经典容斥" class="headerlink" title="一般化的经典容斥"></a>一般化的经典容斥</h1><p>首先需要有一个属性集合$k$，然后假设有一个可以查询至少满足属性集合$S$的物品个数的函数$q(S)$</p>
<p>同时还有一个函数$g(k)$，对于一个有$k$个属性的物品，它会对答案产生$g(k)$的贡献</p>
<p>同时确定一个容斥系数$f(x)$，使得答案为$\sum_{S \subseteq U}q(S)f(|S|)$</p>
<p>此时看一下每一个物品会怎么对答案产生贡献的（假设这个物品有$n$个属性）：</p>
<p>$$\sum_{i=1}^{n} {n \choose i} f(i)=g(n)$$</p>
<p>如果允许$O(n^2)$的时间复杂度的话，可以直接通过递推来计算出$f(x)$</p>
<p>既假设知道了$f(1) \sim f(n)$，现在要计算$f(n+1)$，根据定义有</p>
<p>$$\sum_{i=1}^{n+1} {n + 1 \choose i} f(i)=g(n+1) \Rightarrow f(n+1)=g(n+1)-\sum_{i=1}^{n} {n+ 1\choose i} f(i)$$</p>
<p><del>于是就可以打表找规律了！</del></p>
<h1 id="计算容斥系数"><a href="#计算容斥系数" class="headerlink" title="计算容斥系数"></a>计算容斥系数</h1><p>然而如果需要快速计算$f(x)$呢？</p>
<p>发现上面那个式子比较像卷积的形式，定义$f(0)=0$</p>
<p>也就是说</p>
<p>$$\begin{aligned}g(n)&amp;=\sum_{i=1}^{n} {n \choose i} f(i) \\&amp;=\sum_{i=0}^{n}\frac{n!}{i!(n-i)!}f(i) \\&amp;=n!\sum_{i=0}^{n}\frac{1}{(n-i)!}\frac{f(i)}{i!} \\\end{aligned}$$</p>
<p>整理一下就是</p>
<p>$$\frac{g(n)}{n!}=\sum_{i=0}^{n}\frac{1}{(n-i)!}\frac{f(i)}{i!}$$</p>
<p>设$G(x)=\sum\limits_{i=0}^{\infty}x^i\frac{g(i)}{i!},H(x)=\sum\limits_{i=0}^{\infty}x^i\frac{1}{i!},F(x)=\sum\limits_{i=0}^{\infty}x^i\frac{f(i)}{i!}$</p>
<p>则$G(x)=H(x)F(x)$，也就是$F(x)=\frac{H(x)}{G(x)}$</p>
<p>于是可以用优秀的多项式求逆算法在$O(n \log n)$的时间复杂度内解决了！</p>
<blockquote>
<p>当然还有一种优秀的反演方法……并没有学会……</p>
<p>可以在<a target="_blank" rel="noopener" href="https://blog.csdn.net/werkeytom_ftd/article/details/74701513">WerKeyTom_FTD 《容斥的原理及广义应用》</a>中看到</p>
</blockquote>
<h1 id="一些简单的应用"><a href="#一些简单的应用" class="headerlink" title="一些简单的应用"></a>一些简单的应用</h1><h2 id="统计人数问题"><a href="#统计人数问题" class="headerlink" title="统计人数问题"></a>统计人数问题</h2><p>已知在某场比赛中，一共有${1,2,3}$这三道题，同时你可以查询$f(S)$，会返回至少切了集合$S$的题的人的个数，问有多少人至少切了一道题？</p>
<p>根据上面的推导，可以知道答案就是</p>
<p>$$f({1})+f({2})+f({3})-f({1,2})-f({1,3})-f({2,3})+f({1,2,3})$$</p>
<h2 id="错排问题"><a href="#错排问题" class="headerlink" title="错排问题"></a>错排问题</h2><p>问$1 \sim n$的所有排列$a$中，满足$a_i \not= i$的排列数</p>
<p>对于不等于的限制似乎不太好做，但对于等于的限制是十分好做的：如果有$x$个位置满足$a_i=i$，那么其余位置的方案数为$(n-x)!$</p>
<p>所以可以枚举至少哪些位置是不合法的，然后容斥一下</p>
<p>设$f(n)$表示$n$个数的错排个数，则</p>
<p>$$ \begin{aligned} f(n) &amp;=\sum_{i=0}^{n}(-1)^{i} {n \choose i} (n-i)! \\ &amp;=\sum_{i=0}^{n}(-1)^i \frac{n!}{i!(n-i)!}(n-i)! \\ &amp;=\sum_{i=0}^{n}(-1)^i \frac{n!}{i!} \\ &amp;=n\sum_{i=0}^{n}(-1)^i \frac{(n-1)!}{i!} \\ &amp;=(-1)^{n} \frac{n!}{n!} + n\sum_{i=0}^{n-1}(-1)^i \frac{(n-1)!}{i!} \\ &amp;=(-1)^{n} + nf(n-1) \\ \end{aligned} $$</p>
<p>关于第一行的说明：</p>
<blockquote>
<p>首先需要枚举一下有多少个位置是不满足错排的，这个是$\sum_{i=0}^{n}$</p>
<p>其次需要一个容斥系数，为$(-1)^i$</p>
<p>之后枚举那些位置不满足错排，这是${n \choose i}$</p>
<p>对于剩下的位置可以随意放，也就是$(n-i)!$</p>
</blockquote>
<p>证明一下正确性：</p>
<blockquote>
<p>假设一个排列有$k$的地方满足$a_i = i$，既要求对答案的贡献为$[k=0]$</p>
<p>那么实际对答案的贡献为：<br>$$ \begin{aligned} \sum_{i=0}^{k}{k \choose i}(-1)^i \end{aligned} $$<br>上面那个式子在$k=0$的时候对答案的贡献为$1$，满足题意，以下考虑在$k \ge 1$的情况下对答案的贡献<br>$$ \begin{aligned} \sum_{i=0}^{k}{k \choose i}(-1)^i &amp;=(1-1)^k\\&amp;=0\end{aligned} $$</p>
</blockquote>
<p>那如果要求恰好$k$个位置满足错排呢？</p>
<p>枚举一下哪些位置不满足错排，显然剩下的位置只能唯一确定，既${n \choose k}f(k)$</p>
<p>那如果要求至少$k$个位置满足错排呢（$k \ge 1$）？</p>
<p>同理，答案就是$\sum_{i=1}^{k} {n \choose i}f(i)$</p>
<h2 id="方程的解问题"><a href="#方程的解问题" class="headerlink" title="方程的解问题"></a>方程的解问题</h2><p>给定一个方程$\sum_{i=1}^{n}x_i=b$，问非负整数的个数</p>
<p>通过组合数学，可以得知解的个数为${n+b-1 \choose n-1}$</p>
<p>一个简单粗暴的证明：</p>
<blockquote>
<p>相当于将$b$个$1$分割成$n$份，允许某份是空的，问方案数</p>
<p>考虑设置$n$个特殊点，如果第$i$个特殊点被选中了，则第$i$堆为空</p>
<p>然后将$b$个$1$分成若干份，依次对应非空的$x_i$</p>
<p>于是解的个数就是${n+b-1 \choose n-1}$</p>
</blockquote>
<p>然而如果对于每一个$x_i$都有限制呢？诸如$l_i \le x_i \le r_i$</p>
<p>设$y_i=x_i-l_i$，也就是$0 \le y_i \le r_i-l_i$，这样对于每一个非负整数解$y_i$，都有一个非负整数$x_i$与之对应</p>
<p>换句话说问题转化为了限制诸如$0 \le x_i \le k_i$的形式</p>
<p>考虑容斥，每次枚举哪些$x_i$不满足限制，既$x_i \ge k_i+1$，然后配上正确的容斥系数</p>
<p>如何让$x_i$不满足限制？设$x_i’=x_i+k_i+1$，然后把$x_i’$替换$x_i$就行了</p>
<p>设$f(S)$表示集合$S$的变量不满足限制的方案数，显然有</p>
<p>$$ f(S)={n+b-1-\sum_{i \in S}(k_i+1)\choose n-1} $$</p>
<p>同时对于答案$T$，有</p>
<p>$$ T=\sum_{S \subseteq U}(-1)^{|S|}f(S)=\sum_{S \subseteq U}(-1)^{|S|}{n+b-1-\sum_{i \in S}(k_i+1)\choose n-1} $$</p>
<h2 id="字符串匹配问题"><a href="#字符串匹配问题" class="headerlink" title="字符串匹配问题"></a>字符串匹配问题</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.org/problemnew/show/P2167">SDOI2009 Bill的挑战</a></p>
<p>有$n$个长度相同的模板串，用<code>?</code>表示通配符（可以匹配任何字符），给出一个整数$k$，求恰好匹配$k$个模板串的字符串的个数</p>
<p>一般化的题目描述：</p>
<blockquote>
<p>有$n$个属性，求恰好满足$k$个属性的物品个数</p>
<p>你有一个函数$q(S)$，可以快速算出至少满足属性集合$S$的物品个数（保证每个物品最多只会被统计一次）</p>
</blockquote>
<p>设$f(S)$表示只满足属性集合$S$的物品的个数，那么答案就是$\sum_{S \subseteq U \wedge |S| = k}f(S)$</p>
<p>设$f(S)=\sum\limits_{S \subseteq P \subseteq U}q(P)g(|P|)$，其中$|S|=k$，显然有$g(x)=(-1)^{x-k}$</p>
<p>证明：</p>
<blockquote>
<p>对于一个物品$t$，假设它的属性集合为$Q$，且$S \subseteq Q$，且$|Q|=k+u$</p>
<p>那么它对$f(S)$的贡献是<br>$$\sum_{i=0}^{u}{u \choose i}(-1)^{i}=(-1+1)^{u}=[u=0]$$</p>
</blockquote>
<p>也就是说$f(S)=\sum\limits_{S \subseteq P \subseteq U}q(P)(-1)^{|P|-k}$</p>
<p>也就是说</p>
<p>$$\begin{aligned}T&amp;=\sum\limits_{S \subseteq U \wedge |S| = k}f(S) \\&amp;=\sum\limits_{S \subseteq U \wedge |S| = k} \sum_{S \subseteq P \subseteq U}q(P)(-1)^{|P|-k} \\&amp;=\sum\limits_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{|P|-k}{|P| \choose k}\end{aligned}$$</p>
<p>于是就做完了……</p>
<p>$q(S)$的话可以直接判断一下是否有冲突，如果没有冲突的话求一下有多少个位置是用<code>?</code>填充的，假设有$x$个位置用<code>?</code>填充，那么$q(S)=2^x$</p>
<p>如果扩展一下这道题，将“恰好”改成“至少”呢？</p>
<p>设$T(k)$表示恰好匹配$k$个字符串的方案数，$Q(k)$表示至少匹配$k$个字符串的方案数，则</p>
<p>$$ \begin{aligned} Q(k) &amp;=\sum_{i=k}^{n}T(i) \\ &amp;=\sum_{i=k}^{n}\sum\limits_{P \subseteq U \wedge |P| \ge i} q(P)(-1)^{|P|-i}{|P| \choose i} \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)\sum_{i=k}^{|P|}(-1)^{|P|-i} {|P| \choose i} \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{1-|P|}\sum_{i=k}^{|P|}(-1)^{i} {|P| \choose i} \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{1-|P|}\sum_{i=k}^{|P|}(-1)^{i} ({|P| - 1 \choose i}+{|P| -1 \choose i-1}) \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{1-|P|}((\sum_{i=k+1}^{|P|+1}(-1)^{i-1} {|P| - 1 \choose i-1})+(\sum_{i=k}^{|P|}(-1)^{i}{|P|-1 \choose i-1})) \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{1-|P|}((-1^{|P|}){|P|-1 \choose |P| }+(-1)^{k}{|P|-1 \choose k-1}) \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{|P|-k}{|P|-1 \choose k-1} \\ &amp;=\sum_{P \subseteq U \wedge |P| \ge k} q(P)(-1)^{|P|-k}{|P|-1 \choose |P|-k} \\ \end{aligned} $$</p>
<p>这个似乎没什么解释的……将一个式子套到另一个式子后，直接化简……</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/13/in-ex/in-ex/" data-id="ckqmfus93002z8ufyhusgesye" data-title="初探容斥原理" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-3-mem-ring/3-mem-ring" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/09/3-mem-ring/3-mem-ring/" class="article-date">
  <time class="dt-published" datetime="2018-09-09T05:53:58.000Z" itemprop="datePublished">2018-09-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/09/3-mem-ring/3-mem-ring/">三元环计数</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=33051078&height=66"></iframe>

<p><del>万恶之源：</del></p>
<blockquote>
<p>给定一张无重边、无自环的无向图</p>
<p>点数为$n$，边数为$m$，且$n,m$同阶</p>
<p>问有多少个无序三元组$(i,j,k)$，使得存在：</p>
<ol>
<li>有一条连接$i,j$的边</li>
<li>有一条连接$j,k$的边</li>
<li>有一条连接$k,i$的边</li>
</ol>
</blockquote>
<p>举个例子：</p>
<p><img src="https://s1.ax1x.com/2018/09/06/i9XVS0.png" alt="数一数有几个三元环？"></p>
<p>这张图中有三个三元环：$(1,2,3),(1,3,4),(3,4,5)$</p>
<hr>
<p>有一个显然的基于度数的乱搞的做法（本人并没有写过……），可以在这里阅读到：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/jiachinzhao/p/7474761.html">jiachin_zhao 三元环计数</a></p>
<p>这里介绍一种十分优秀的三元环计数方法：</p>
<blockquote>
<p>首先要对所有的无向边进行定向，对于任何一条边，从度数大的点连向度数小的点，如果度数相同，从编号小的点连向编号大的点</p>
<p>此时这张图是一个有向无环图</p>
<p>之后枚举每一个点$u$，然后将$u$的所有相邻的点都标记上“被$u$访问了”，然后再枚举$u$的相邻的点$v$，然后再枚举$v$的相邻的点$w$，如果$w$存在“被$u$访问了”的标记，那么$(u,v,w)$就是一个三元环了</p>
<p>而且每个三元环只会被计算一次</p>
</blockquote>
<hr>
<p>那么现在就只需要证明三件事：</p>
<ol>
<li>定向后的图是一个有向无环图</li>
</ol>
<blockquote>
<p><img src="https://s1.ax1x.com/2018/09/06/i9Ohz6.png" alt="这是一个环"></p>
<p>以上图为例，用$deg_u$表示$u$在原图中的度数，则$deg_a \ge deg_b \ge deg_c \ge deg_d \ge deg_e \ge deg_a$</p>
<p>既$deg_a=deg_b=deg_c=deg_d=deg_e=deg_a$</p>
<p>对于度数相同的点，是按照编号从小到大连边的，则$a \le b \le c \le d \le e \le a$</p>
<p>既$a=b=c=d=e$</p>
<p>然而点的编号是$1 \sim n$的全排列，因此不会产生如上的事情，既不存在环</p>
<p>由于这张图有向，而且没有环，因此这张图就是有向无环图</p>
</blockquote>
<ol start="2">
<li>时间复杂度是$O(m \sqrt m)$（在此认为$n,m$同阶）</li>
</ol>
<blockquote>
<p><img src="https://s1.ax1x.com/2018/09/06/i9Obod.png" alt="枚举顺序：$u \rightarrow v \rightarrow w$"></p>
<p>对于“打标记”这个操作，每个点都会将所有的出边遍历一遍，那么这里的时间复杂度为$O(n+m)$</p>
<p>对于访问$u$，然后访问$v$，然后访问$w$，可以这么考虑：对于每条边（$u \rightarrow v$），对时间复杂度的贡献为$out_v$，其中$out_v$表示$v$的出边个数</p>
<p>这样就转化为了求$\sum_{i=1}^{n}out_i$</p>
<p>不妨将$out_v$分类讨论</p>
<ol>
<li>$out_v \le \sqrt m$，那么由于$u$连接$v$，因此$deg_u \ge deg_v$，这样的$u$的个数是$O(n)$的，因此这里的时间复杂度为$O(n \sqrt m)$</li>
<li>$out_v \gt \sqrt m$，那么由于$u$连接$v$，因此$deg_u \ge deg_v$，既$deg_u \gt \sqrt m$，这样的$u$的个数是$O(\sqrt m)$的，因此这里的时间复杂度为$O(\sqrt m m)=O(m \sqrt m)$</li>
</ol>
<p>因此时间复杂度为$O(n+m+n\sqrt m+m\sqrt m)=O(m \sqrt m)$</p>
</blockquote>
<ol start="3">
<li>每个三元环只会被统计一次</li>
</ol>
<blockquote>
<p>三元环在有向无环图上无非就长这样：</p>
<p><img src="https://s1.ax1x.com/2018/09/06/i9OXWt.png" alt="有向图上的“三元环”"></p>
<p>也只能且只会在$u$处被计算一次</p>
</blockquote>
<hr>
<p><del>事实上连边的时候从度数小的连向度数大的也可以证明时间复杂度是$O(m \sqrt m)$……</del></p>
<hr>
<p>下面是一个样例程序</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"><span class="keyword">int</span> deg[N], vis[N], n, m, ans;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">E</span> &#123;</span> <span class="keyword">int</span> u, v; &#125; e[N * <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;e[i].u, &amp;e[i].v);</span><br><span class="line">        ++ deg[e[i].u], ++ deg[e[i].v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = e[i].u, v = e[i].v;</span><br><span class="line">        <span class="keyword">if</span>(deg[u] &lt; deg[v] || (deg[u] == deg[v] &amp;&amp; u &gt; v)) <span class="built_in">swap</span>(u, v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x = <span class="number">1</span> ; x &lt;= n ; ++ x) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> y: g[x]) vis[y] = x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> y: g[x])</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> z: g[y])</span><br><span class="line">                <span class="keyword">if</span>(vis[z] == x)</span><br><span class="line">                    ++ ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/KingSann/tag/%E4%B8%89%E5%85%83%E7%8E%AF/">一些习题</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/09/3-mem-ring/3-mem-ring/" data-id="ckqmfus7u00068ufyc9dm3em7" data-title="三元环计数" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" rel="tag">三元环</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-linear-sieves/linear-sieves" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/26/linear-sieves/linear-sieves/" class="article-date">
  <time class="dt-published" datetime="2018-06-26T08:14:50.000Z" itemprop="datePublished">2018-06-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/26/linear-sieves/linear-sieves/">线性筛与积性函数</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前置技能"><a href="#前置技能" class="headerlink" title="前置技能"></a>前置技能</h1><ul>
<li>数论函数</li>
<li>积性函数</li>
<li>完全积性函数</li>
<li>整除</li>
<li>素数</li>
</ul>
<h1 id="数论函数"><a href="#数论函数" class="headerlink" title="数论函数"></a>数论函数</h1><p>定义在正整数集上的实值或复值函数</p>
<p>一般可视作定义域为正整数，值域为整数的函数</p>
<h1 id="积性函数"><a href="#积性函数" class="headerlink" title="积性函数"></a>积性函数</h1><p>对于一个数论函数$f$，若当$(a,b)=1$时，$f(ab)=f(a)f(b)$，则称其为<strong>积性函数</strong></p>
<h1 id="完全积性函数"><a href="#完全积性函数" class="headerlink" title="完全积性函数"></a>完全积性函数</h1><p>对于一个数论函数$f$，若$f(ab)=f(a)f(b)$，则称其为<strong>完全积性函数</strong></p>
<h1 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h1><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><ul>
<li>积性函数$f$</li>
<li>对于素数$p$，可以快速求出$f(p^k)$的值</li>
</ul>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>线性筛一共会处理如下的数</p>
<ul>
<li>素数$p$</li>
<li>$i \times p$，其中$i$是任意正整数，且$p \nmid i$，且$p$是素数，且$p$是$i \times p$的最小素因子</li>
<li>$i \times p$，其中$i$是任意正整数， 且$p \mid i$，且$p$是素数，且$p$是$i$的最小素因子，且$p$是$i \times p$的最小素因子</li>
</ul>
<h3 id="处理"><a href="#处理" class="headerlink" title="处理"></a>处理</h3><h4 id="素数-p"><a href="#素数-p" class="headerlink" title="素数$p$"></a>素数$p$</h4><p>由于已经可以快速求出$f(p^k)$了，所以可以快速求出$f(p)$</p>
<h4 id="p-nmid-i"><a href="#p-nmid-i" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>由于是积性函数，且$(p,i)=1$，因此$f(i \times p)=f(i) \times f(p)$</p>
<p>由于$i \le i \times p \wedge p \le i \times p$，所以可以计算出$f(i \times p)$</p>
<h4 id="p-mid-i"><a href="#p-mid-i" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h4><p>同时需要计算出来$g(n)$，表示$n$的最小素因数的乘积，即将$n$分解为$p_{min}^{k_{min}} \times t$的形式，其中$(p_{min}^{k_{min}},t)=1$</p>
<p>先假设会计算$g$了</p>
<p>那么$i \times p=\frac{i}{g(i)} \times g(i) \times p$，其中$(\frac{i}{g(i)} , g(i) \times p)=1$</p>
<p>因此$f(i \times p)=f(\frac{i}{g(i)}) \times f(g(i) \times p)$</p>
<p>$g(i) \times p$可以分解为$p^k$的形式，如果需要用到$k$的话，可以在求$g$的时候顺便求一下$k$</p>
<p>由于$f(p^k)$可以快速求，所以就可以计算出$f(i \times p)$</p>
<h5 id="计算-g-k"><a href="#计算-g-k" class="headerlink" title="计算$g,k$"></a>计算$g,k$</h5><p>依然是分成三类</p>
<h6 id="素数-p-1"><a href="#素数-p-1" class="headerlink" title="素数$p$"></a>素数$p$</h6><p>$g(p)=p$</p>
<p>$k(p)=1$</p>
<h6 id="p-nmid-i-1"><a href="#p-nmid-i-1" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h6><p>$g(i \times p)=p$</p>
<p>$k(i \times p)=1$</p>
<h6 id="p-mid-i-1"><a href="#p-mid-i-1" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h6><p>$g(i \times p)=g(i) \times p$</p>
<p>$k(i \times p)=k(i)+1$</p>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><h3 id="计算-phi"><a href="#计算-phi" class="headerlink" title="计算$\phi$"></a>计算$\phi$</h3><p>定义$\phi(n)=\sum_{i=1}^{n}\epsilon((i,n))$</p>
<p>同时有计算公式$\phi(n)=n\Pi \frac{p_i-1}{p_i}$</p>
<p>依旧是分类讨论</p>
<h4 id="素数-p-2"><a href="#素数-p-2" class="headerlink" title="素数$p$"></a>素数$p$</h4><p>$\phi(p)=p-1$</p>
<p>因为$[1,p-1]$中所有的整数都和$p$互素</p>
<h4 id="p-nmid-i-2"><a href="#p-nmid-i-2" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\phi(i \times p)=\phi(i) \times \phi(p)=\phi(i) \times (p-1)$</p>
<p>$\phi$是积性函数</p>
<h4 id="p-mid-i-2"><a href="#p-mid-i-2" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h4><p>设$\phi(i)=n \Pi \frac{p_i-1}{p_i}$</p>
<p>因为$i$中已经有素因子$p$</p>
<p>则$\phi(i \times p)=np \Pi  \frac{p_i-1}{p_i}=p \times (n\Pi \frac{p_i-1}{p_i})$</p>
<p>也就是说$\phi(i \times p)=p \times \phi(i)$</p>
<h3 id="计算-mu"><a href="#计算-mu" class="headerlink" title="计算$\mu$"></a>计算$\mu$</h3><p>定义</p>
<p>$$<br>\mu(n)=<br>\begin{cases}<br>1 \qquad &amp; n=1 \\<br>(-1)^k \qquad &amp; n=\Pi_{i=1}^{k} p_i \\<br>0 \qquad &amp; \text{otherwise}<br>\end{cases}<br>$$</p>
<p>依旧是分类讨论</p>
<h4 id="素数-p-3"><a href="#素数-p-3" class="headerlink" title="素数$p$"></a>素数$p$</h4><p>$\mu(p)=-1$</p>
<p>根据$\mu$的定义</p>
<h4 id="p-nmid-i-3"><a href="#p-nmid-i-3" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\mu(i \times p)=\mu(i) \times \mu(p)=-\mu(i)$</p>
<p>$\mu$是积性函数</p>
<h4 id="p-mid-i-3"><a href="#p-mid-i-3" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h4><p>$\mu(i \times p)=\mu(\frac{i}{p^t} \times p^t)=\mu(\frac{i}{p^t}) \times \mu(p^t)=0 \wedge (\frac{i}{p^t},p^t)=1 \wedge t \ge 2$</p>
<p>根据$\mu$的定义，如果$n$包含非$1$的完全平方因子，那么$\mu(n)=0$</p>
<h3 id="计算-tau"><a href="#计算-tau" class="headerlink" title="计算$\tau$"></a>计算$\tau$</h3><p>定义$\sigma_k(n)=\sum_{d \mid n}d^k$</p>
<p>定义$\tau(n)=\sigma_0(n)$，叫做<strong>约数个数</strong>函数</p>
<p>则$\tau(n)=\Pi (a_i+1)$，其中$n=\Pi p_i^{a_i}$</p>
<h4 id="素数-p-4"><a href="#素数-p-4" class="headerlink" title="素数$p$"></a>素数$p$</h4><p>$\tau(p)=2$</p>
<p>即$1$和$p$</p>
<h4 id="p-nmid-i-4"><a href="#p-nmid-i-4" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\tau(i \times p)=\tau(i) \times \tau(p)$</p>
<p>$\sigma_k$是积性函数</p>
<h4 id="p-nmid-i-5"><a href="#p-nmid-i-5" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\tau(i \times p)=\tau(\frac{i}{p^t}) \times \tau(p^t)=\tau(\frac{i}{p^t}) \times (t+1)$</p>
<h3 id="计算-sigma"><a href="#计算-sigma" class="headerlink" title="计算$\sigma$"></a>计算$\sigma$</h3><p>定义$\sigma(n)=\sigma_1(n)​$，叫做<strong>约数和</strong>函数</p>
<p>则$\sigma(n)=\Pi_i \sum_{j=0}^{a_i} p_i^j$</p>
<h4 id="素数-p-5"><a href="#素数-p-5" class="headerlink" title="素数$p$"></a>素数$p$</h4><p>$\sigma(p)=1+p$</p>
<p>即$1$和$p$</p>
<h4 id="p-nmid-i-6"><a href="#p-nmid-i-6" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\sigma(i \times p)=\sigma(i) \times \sigma(p)$</p>
<p>$\sigma_k$是积性函数</p>
<h4 id="p-mid-i-4"><a href="#p-mid-i-4" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h4><p>$\sigma(i \times p)=\sigma(\frac{i}{p^t}) \times \sigma(p^t)=\sigma(\frac{i}{p^t}) \times \sum_{j=0}^{t}p^j=\sigma(\frac{i}{p^t}) \times h(i)$</p>
<p>其中$h(i)$表示$i$的最小素因数的幂次和，这个可以在线性筛的同时处理</p>
<h3 id="计算-sigma-k"><a href="#计算-sigma-k" class="headerlink" title="计算$\sigma_k$"></a>计算$\sigma_k$</h3><h4 id="base"><a href="#base" class="headerlink" title="base"></a>base</h4><p>$\sigma_k(1)=\sum_{d \mid 1}d^k=1$</p>
<h4 id="p-in-P"><a href="#p-in-P" class="headerlink" title="$p \in P$"></a>$p \in P$</h4><p>$\sigma_k(p)=\sum_{d \mid p}d^k=1+p^k$</p>
<h4 id="p-nmid-i-7"><a href="#p-nmid-i-7" class="headerlink" title="$p \nmid i$"></a>$p \nmid i$</h4><p>$\sigma_k(i \times p)=\sigma_k(i) \times \sigma_k(p)$</p>
<h4 id="p-mid-i-5"><a href="#p-mid-i-5" class="headerlink" title="$p \mid i$"></a>$p \mid i$</h4><p>$i \times p=t \times p^r \wedge (t,p^r)=1$</p>
<p>$\sigma_k(i \times p)=\sigma_k(t) \times \sigma_k(p^r)$</p>
<p>$\sigma_k(p^r)=\sum_{j=0}^{r}(p^j)^k=\sum_{j=0}^{r}p^{jk}$</p>
<h4 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h4><p>当然这还是不够的，每次大力计算$\sigma_k(p^r)$是会超时的</p>
<p>不妨测一下$n=k=10^7$的时候，$p,r$的最大值吧</p>
<p>可以得到$p \le 4000, r \le 25$，不妨开个数组直接记忆化保存即可</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span> + <span class="number">10</span>, p = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k, pri[N], tot, c[N], mn[N], g[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line">ll f[N], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pw</span><span class="params">(<span class="keyword">int</span> a, ll b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>( ; b ; b &gt;&gt;= <span class="number">1</span>, a = (ll) a * a % p) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) r = (ll) r * a % p;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> val[<span class="number">4000</span>][<span class="number">25</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> mn, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(val[mn][c] != <span class="number">-1</span>) <span class="keyword">return</span> val[mn][c];</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= c ; ++ j) r = ((ll) r + <span class="built_in">pw</span>(mn, (ll) j * k)) % p;</span><br><span class="line">	<span class="keyword">return</span> val[mn][c] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(val, <span class="number">-1</span>, <span class="keyword">sizeof</span> val);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">	ans = f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!vis[i]) pri[++ tot] = i, f[i] = <span class="number">1</span> + <span class="built_in">pw</span>(i, k), g[i] = i, c[i] = <span class="number">1</span>, mn[i] = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * pri[j] &lt;= n ; ++ j) &#123;</span><br><span class="line">			<span class="keyword">int</span> x = i * pri[j];</span><br><span class="line">			vis[x] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">				f[x] = f[i / g[i]] * <span class="built_in">F</span>(mn[i], c[i] + <span class="number">1</span>) % p;</span><br><span class="line">				g[x] = g[i] * pri[j];</span><br><span class="line">				c[x] = c[i] + <span class="number">1</span>;</span><br><span class="line">				mn[x] = pri[j];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> f[x] = f[i] * f[pri[j]] % p, g[x] = pri[j], c[x] = <span class="number">1</span>, mn[x] = pri[j];</span><br><span class="line">		&#125;</span><br><span class="line">		ans = (ans + f[i]) % p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/26/linear-sieves/linear-sieves/" data-id="ckqmfus9400348ufy9r3zclmd" data-title="线性筛与积性函数" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" rel="tag">积性函数</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" rel="tag">线性筛</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-lmmr/problems/spoj-GSS3" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/problems/spoj-GSS3/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T15:20:32.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/problems/spoj-GSS3/">线性变换与矩阵递推习题：spoj GSS3</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定长度为$n$的整数序列，你需要在数列上进行两类操作：</p>
<ol>
<li>把$a_x$变$a_x+c$为</li>
<li>求$l \le i \le j \le r$中$\sum_{k=i}^{j}a_k$的最大值</li>
</ol>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>考虑没有修改的时候，且查询$l=1,r=n$时怎么做</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, ans = -inf, cur = <span class="number">0</span> ; i &lt;= n ; ++ i) &#123;</span><br><span class="line">    cur = <span class="built_in">max</span>(cur + a[i], a[i]);</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, cur);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>贪心的维护最大且连续的值，然后更新答案对吧？</p>
<p>递推关系式就是</p>
<p>$$<br>\begin{cases}<br>cur_i=\max(cur_{i-1} + a_i,a_i) \\<br>ans_i=\max(ans_{i-1},cur_{i-1}+a_i,a_i)<br>\end{cases}<br>$$</p>
<p>也就是说</p>
<p>$$<br>\begin{pmatrix}<br>cur_{i-1} &amp; ans_{i-1} &amp; 0<br>\end{pmatrix}<br>\begin{pmatrix}<br>a_i &amp; a_i &amp; -\infty \\<br>-\infty &amp; 0 &amp; -\infty \\<br>a_i &amp; a_i &amp; 0<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>cur_{i+1} &amp; ans_{i+1} &amp; 0<br>\end{pmatrix}<br>$$</p>
<p>其中</p>
<p>$$<br>(AB)<em>{ij}=\max_k A</em>{i,k} + B_{k,j}<br>$$</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">Mat</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">0xcf</span>, <span class="keyword">sizeof</span> a); &#125;</span><br><span class="line">    <span class="keyword">int</span>* <span class="keyword">operator</span> [] (<span class="keyword">int</span> x) &#123; <span class="keyword">return</span> a[x]; &#125;</span><br><span class="line">    Mat <span class="keyword">operator</span> * (Mat t) &#123;</span><br><span class="line">        Mat ret;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">3</span> ; ++ k) &#123;</span><br><span class="line">                    ret[i][j] = <span class="built_in">max</span>(ret[i][j], a[i][k] + t[k][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        a[<span class="number">0</span>][<span class="number">0</span>] = x, a[<span class="number">0</span>][<span class="number">1</span>] = x, a[<span class="number">0</span>][<span class="number">2</span>] = -inf;</span><br><span class="line">        a[<span class="number">1</span>][<span class="number">0</span>] = -inf, a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>, a[<span class="number">1</span>][<span class="number">2</span>] = -inf;</span><br><span class="line">        a[<span class="number">2</span>][<span class="number">0</span>] = x, a[<span class="number">2</span>][<span class="number">1</span>] = x, a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Mat mat[N * <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (id &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (id &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; mat[id] = mat[lc] * mat[rc]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, x;</span><br><span class="line">    <span class="keyword">if</span>(l == r) mat[id].<span class="built_in">set</span>((<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), x));</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r), <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> mat[id].<span class="built_in">set</span>(x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pos &lt;= mid) <span class="built_in">modify</span>(lc, l, mid, pos, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, pos, x); <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> mat[id];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(qr &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &gt;= mid + <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, mid) * <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, l, r, p, x ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;p, &amp;x);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, n, p, x);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            Mat t = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">max</span>(t[<span class="number">0</span>][<span class="number">1</span>], t[<span class="number">2</span>][<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/problems/spoj-GSS3/" data-id="ckqmfusan007c8ufyc68mbw80" data-title="线性变换与矩阵递推习题：spoj GSS3" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spoj/" rel="tag">spoj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-lmmr/problems/cf-718-C" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/problems/cf-718-C/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T15:10:52.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/problems/cf-718-C/">线性变换与矩阵递推习题：cf 718 C Sasha and Array</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给你$n$个数，支持两个操作 </p>
<ol>
<li>$\forall i \in [l,r] \cap Z,a_i \leftarrow a_i + x$</li>
<li>查询$\sum_{i=l}^{r}f(a_i)$</li>
</ol>
<p>其中$f(0)=0,f(1)=1$，且$\forall i \ge 2 \wedge i \in Z,f(i)=f(i-1)+f(i-2)$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>先列出转移矩阵</p>
<p>$$<br>\begin{pmatrix}<br>f(i+1) &amp; f(i)<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f(i+2) &amp; f(i+1)<br>\end{pmatrix}<br>$$</p>
<p>所以</p>
<p>$$<br>\begin{pmatrix}<br>f(1) &amp; f(0)<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{pmatrix}^{n-1}<br>=<br>\begin{pmatrix}<br>f(n) &amp; f(n-1)<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>1 &amp; 0<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{pmatrix}^{n-1}<br>$$</p>
<p>设</p>
<p>$$<br>\begin{cases}<br>B = \begin{pmatrix} 1 &amp; 0 \end{pmatrix} \\<br>M = \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}<br>\end{cases}<br>$$</p>
<p>则</p>
<p>$$<br>\begin{align}<br>&amp;\sum_{i=l}^{r}f(a_i+x) \\<br>=&amp;\sum_{i=l}^{r}B \times M^{a_i-1+x} \\<br>=&amp;B(M^x\sum_{i=l}^{r}M^{a_i-1})<br>\end{align}<br>$$</p>
<p>用线段树实现区间乘一个矩阵、维护区间矩阵和</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>, p = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">    ll a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">Mat</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span> a); &#125;</span><br><span class="line">    ll* <span class="keyword">operator</span> [] (<span class="keyword">int</span> i) &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">notI</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !(a[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">1</span> &amp;&amp; a[<span class="number">0</span>][<span class="number">1</span>] == <span class="number">0</span></span><br><span class="line">              &amp;&amp; a[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; a[<span class="number">1</span>][<span class="number">1</span>] == <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Mat <span class="keyword">operator</span> * (Mat b) &#123;</span><br><span class="line">        Mat c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; ++ j)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">2</span> ; ++ k)</span><br><span class="line">                    c[i][j] = (c[i][j] + a[i][k] * b[k][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat <span class="keyword">operator</span> + (Mat b) &#123;</span><br><span class="line">        Mat c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; ++ j)</span><br><span class="line">                c[i][j] = (a[i][j] + b[i][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n---&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i, <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; ++ j)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i][j]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;---\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; mat[N * <span class="number">4</span>], M, B, tag[N * <span class="number">4</span>], I;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (id &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (id &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">pw</span><span class="params">(Mat a, ll b)</span> </span>&#123;</span><br><span class="line">    Mat c = I;</span><br><span class="line">    <span class="keyword">for</span>( ; b ; b &gt;&gt;= <span class="number">1</span>, a = a * a) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) c = c * a;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    mat[id] = mat[lc] + mat[rc];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(id &amp;&amp; tag[id].<span class="built_in">notI</span>()) &#123;</span><br><span class="line">        tag[lc] = tag[lc] * tag[id], tag[rc] = tag[rc] * tag[id];</span><br><span class="line">        mat[lc] = mat[lc] * tag[id], mat[rc] = mat[rc] * tag[id];</span><br><span class="line">        tag[id] = I;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    tag[id] = I;</span><br><span class="line">    <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        mat[id] = B * <span class="built_in">pw</span>(M, x - <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">        <span class="built_in">update</span>(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, Mat x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">push</span>(id);</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> tag[id] = tag[id] * x, mat[id] = mat[id] * x, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(qr &lt;= mid) <span class="built_in">modify</span>(lc, l, mid, ql, qr, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &gt;= mid + <span class="number">1</span>) <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, ql, qr, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(lc, l, mid, ql, mid, x), <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr, x); <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">push</span>(id);</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> mat[id][<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(qr &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &gt;= mid + <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> (<span class="built_in">query</span>(lc, l, mid, ql, mid) + <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr)) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, B[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    B[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>, B[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    I[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, I[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    I[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>, I[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    M[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, M[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    M[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>, M[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, l, r, x ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r, <span class="built_in">pw</span>(M, x));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%I64d\n&quot;</span>, <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/problems/cf-718-C/" data-id="ckqmfusai006x8ufyfxfl5jri" data-title="线性变换与矩阵递推习题：cf 718 C Sasha and Array" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/" rel="tag">codeforces</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-lmmr/problems/loj-6208" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/problems/loj-6208/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T14:57:35.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/problems/loj-6208/">线性变换与矩阵递推习题：loj 6208 树上询问</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有一棵$n$节点的树，根为$1$号节点。每个节点有两个权值$k_i, t_i$，初始值均为$0$</p>
<p>给出三种操作：</p>
<ol>
<li>$\mathrm{Add}( x , d )$操作：将$x$到根的路径上所有点的$k_i\leftarrow k_i + d$</li>
<li>$\mathrm{Mul}( x , d )$操作：将$x$到根的路径上所有点的$t_i\leftarrow t_i + d \times k_i$</li>
<li>$\mathrm{Query}( x )$操作：询问点$x$的权值$t_x$</li>
</ol>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>发现前两个操作实际上是一个多变量的线性变换，不妨用矩阵维护</p>
<p>先树链剖分，将树上问题转化为序列上的问题</p>
<p>对于每个位置，相当于一个三元组：$\begin{pmatrix}k &amp; t &amp; 1 \end{pmatrix}$</p>
<p>对于操作一，转移为</p>
<p>$$<br>\begin{pmatrix}k &amp; t &amp; 1 \end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 0 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>d &amp; 0 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}k+d &amp; t &amp; 1 \end{pmatrix}<br>$$</p>
<p>对于操作二，转移为</p>
<p>$$<br>\begin{pmatrix}k &amp; t &amp; 1 \end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; d &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>0 &amp; 0 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}k &amp; t+d \times k &amp; 1 \end{pmatrix}<br>$$</p>
<p>之后就是区间乘矩阵、查询单点矩阵值的线段树板子题了</p>
<p>但要直接这么做时间复杂度为$O(27n \log^2 n)$，跑得十分慢</p>
<p>不如分析一下矩阵的构造，找一下哪些点是会改变</p>
<p>首先第三列的值是不会变的，因为这是给最后的$1$提供贡献</p>
<p>其次主对角线的$1$是不会变的，因为线性转移后各自位都有本身的单位贡献</p>
<p>同时第二行第一列的$0$也不会变，因为$t$不会对$k$产生贡献</p>
<p>那么也就是说矩阵转移实际上是这个</p>
<p>$$<br>\begin{pmatrix}<br>1 &amp; x_2 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>x_1 &amp; x_3 &amp; 1<br>\end{pmatrix}<br>$$</p>
<p>也就是说只需要维护三个值即可，那么转移呢？</p>
<p>$$<br>\begin{pmatrix}<br>1 &amp; x_2 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>x_1 &amp; x_3 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; y_2 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>y_1 &amp; y_3 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>1 &amp; x_2+y_2 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>x_1+y_1 &amp; x_1y_2+x_3+y_3 &amp; 1<br>\end{pmatrix}<br>$$</p>
<p>于是时间复杂度降到了$O(3n \log^2 n)$</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> head[N], rest[<span class="number">2</span> * N], to[<span class="number">2</span> * N], tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123; to[++ tot] = v, rest[tot] = head[u], head[u] = tot; &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">    ll x[<span class="number">3</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">Mat</span><span class="params">()</span> </span>&#123; <span class="built_in">memset</span>(x, <span class="number">0</span>, <span class="keyword">sizeof</span> x); &#125;</span><br><span class="line">    <span class="keyword">inline</span> Mat <span class="keyword">operator</span> * (Mat b) &#123;</span><br><span class="line">        Mat c;</span><br><span class="line">        c.x[<span class="number">0</span>] = x[<span class="number">0</span>] + b.x[<span class="number">0</span>],</span><br><span class="line">        c.x[<span class="number">1</span>] = x[<span class="number">1</span>] + b.x[<span class="number">1</span>],</span><br><span class="line">        c.x[<span class="number">2</span>] = x[<span class="number">0</span>] * b.x[<span class="number">1</span>] + x[<span class="number">2</span>] + b.x[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; mat[N * <span class="number">10</span>], op1, op2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[N], top[N], pos[N], cnt, sz[N], son[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u] ; i ; i = rest[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = to[i];</span><br><span class="line">        <span class="keyword">if</span>(v == fa[u]) <span class="keyword">continue</span>;</span><br><span class="line">        fa[v] = u, <span class="built_in">dfs</span>(v), sz[u] += sz[v];</span><br><span class="line">        <span class="keyword">if</span>(sz[v] &gt; sz[son[u]]) son[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    top[u] = tp, pos[u] = ++ cnt;</span><br><span class="line">    <span class="keyword">if</span>(son[u]) <span class="built_in">dfs</span>(son[u], tp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u] ; i ; i = rest[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = to[i];</span><br><span class="line">        <span class="keyword">if</span>(v == fa[u] || v == son[u]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(v, v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (id &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (id &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mat[id].x[<span class="number">0</span>] || mat[id].x[<span class="number">1</span>] || mat[id].x[<span class="number">2</span>])</span><br><span class="line">        mat[lc] = mat[lc] * mat[id],</span><br><span class="line">        mat[rc] = mat[rc] * mat[id],</span><br><span class="line">        <span class="built_in">memset</span>(mat[id].x, <span class="number">0</span>, <span class="number">3</span> * <span class="built_in"><span class="keyword">sizeof</span></span>(ll));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, Mat &amp;mt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">        mat[id] = mat[id] * mt;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">push</span>(id);</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= mid) <span class="built_in">modify</span>(lc, l, mid, ql, qr, mt);</span><br><span class="line">    <span class="keyword">if</span>(qr &gt; mid) <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, ql, qr, mt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> &amp;pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> id = <span class="number">1</span>, l = <span class="number">1</span>, r = cnt, mid ; l &lt;= r ; (<span class="built_in">push</span>(id), pos &lt;= mid) ? (r = mid, id = lc) : (l = mid + <span class="number">1</span>, id = rc)) &#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r) &#123; <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, mat[id].x[<span class="number">2</span>]); <span class="keyword">return</span> ; &#125;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c = x = <span class="number">0</span>; <span class="keyword">bool</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))</span><br><span class="line">        f |= (c = <span class="built_in">getchar</span>()) == <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>, c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(f) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, u, v ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>), <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, x, y ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">read</span>(op1.x[<span class="number">0</span>]) ; x ; x = fa[top[x]])</span><br><span class="line">                <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, cnt, pos[top[x]], pos[x], op1);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">read</span>(op2.x[<span class="number">1</span>]) ; x ; x = fa[top[x]])</span><br><span class="line">                <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, cnt, pos[top[x]], pos[x], op2);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">query</span>(pos[x]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/problems/loj-6208/" data-id="ckqmfusak00758ufy0u9ohjrb" data-title="线性变换与矩阵递推习题：loj 6208 树上询问" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/loj/" rel="tag">loj</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-lmmr/problems/hdu-6155" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/problems/hdu-6155/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T14:56:46.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/problems/hdu-6155/">线性变换与矩阵递推习题：hdu 6155 Subsequence Count</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一个长度为$n$的$01$序列，支持两种操作</p>
<ol>
<li>$\forall i \in [l,r] \cap Z,s_i \leftarrow 1 - s_i$</li>
<li>查询$s[l \dots r]$中本质不同的子序列个数</li>
</ol>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>先想想如何求一个$01$序列中的本质不同的子序列的个数</p>
<p>设$f_{i,j}$表示$s[1 \dots i]$中，结尾为$j$的本质不同的子序列的个数，其中$i \in [l,r] \cap Z \wedge j \in \\{ 0,1 \\}$</p>
<p>那么有以下转移方程</p>
<p>$$<br>\begin{cases}<br>\begin{cases}<br>f_{i,0} = f_{i-1,0}+f_{i-1,1} + 1 \\<br>f_{i,1}=f_{i-1,1}<br>\end{cases}<br>&amp; \qquad s_i=0 \\<br>\begin{cases}<br>f_{i,0}=f_{i-1,0} \\<br>f_{i,1}=f_{i-1,0}+f_{i-1,1}+1<br>\end{cases}<br>&amp; \qquad s_i=1<br>\end{cases}<br>$$</p>
<p>转移的含义？</p>
<p>以$s_i=0$为例：新增加一个子序列，以及之前的所有不同的子序列的末尾都增加一个$0$</p>
<p>写成矩阵转移形式</p>
<p>$$<br>\begin{cases}<br>\begin{pmatrix}<br>f_{i,0} &amp; f_{i,1} &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 0 &amp; 0 \\<br>1 &amp; 1 &amp; 0 \\<br>1 &amp; 0 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f_{i+1,0} &amp; f_{i+1,1} &amp; 1<br>\end{pmatrix}<br>&amp; s_i=0 \\<br>\begin{pmatrix}<br>f_{i,0} &amp; f_{i,1} &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>0 &amp; 1 &amp; 1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f_{i+1,0} &amp; f_{i+1,1} &amp; 1<br>\end{pmatrix}<br>&amp; s_i=1<br>\end{cases}<br>$$</p>
<p>这两个转移矩阵可以相互转换的：第一行和第二行交换，然后第一列和第二列交换</p>
<p>之后可以通过线段树维护矩阵，并且打上反转标记实现区间反转的操作（证明略，可以大力展开矩阵乘法来证明）</p>
<p>区间查询的话就是维护矩阵的乘积</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, p = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">    ll a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">Mat</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span> a); &#125;</span><br><span class="line">    ll* <span class="keyword">operator</span> [] (<span class="keyword">int</span> i) &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    Mat <span class="keyword">operator</span> * (Mat b) &#123;</span><br><span class="line">        Mat c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">3</span> ; ++ k)</span><br><span class="line">                    c[i][j] = (c[i][j] + a[i][k] * b[k][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i, <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, a[i][j]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; mat[N * <span class="number">10</span>], I, M0, M1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> rev[N * <span class="number">10</span>], n, m;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (id &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (id &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rev[id]) &#123;</span><br><span class="line">        rev[lc] ^= <span class="number">1</span>, rev[rc] ^= <span class="number">1</span>, rev[id] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i) <span class="built_in">swap</span>(mat[id][i][<span class="number">0</span>], mat[id][i][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; ++ i) <span class="built_in">swap</span>(mat[id][<span class="number">0</span>][i], mat[id][<span class="number">1</span>][i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">push</span>(id), <span class="built_in">push</span>(lc), <span class="built_in">push</span>(rc);</span><br><span class="line">    mat[id] = mat[lc] * mat[rc];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) mat[id] = s[l] == <span class="string">&#x27;0&#x27;</span> ? M0 : M1;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r), <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">push</span>(id);</span><br><span class="line">    <span class="keyword">if</span>(ql &gt; r || qr &lt; l) <span class="keyword">return</span> I;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> mat[id];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, qr) * <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">push</span>(id);</span><br><span class="line">    <span class="keyword">if</span>(ql &gt; r || qr &lt; l) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) rev[id] ^= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(lc, l, mid, ql, qr), <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, ql, qr), <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="keyword">sizeof</span> mat), <span class="built_in">memset</span>(rev, <span class="number">0</span>, <span class="keyword">sizeof</span> rev);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%s&quot;</span>, &amp;n, &amp;m, s + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, l, r ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Mat t = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, (t[<span class="number">2</span>][<span class="number">0</span>] + t[<span class="number">2</span>][<span class="number">1</span>]) % p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    I[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, I[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>, I[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    I[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>, I[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>, I[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    I[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>, I[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>, I[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    M0[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, M0[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>, M0[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    M0[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>, M0[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>, M0[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    M0[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">1</span>, M0[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>, M0[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    M1[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, M1[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>, M1[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    M1[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>, M1[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>, M1[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    M1[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>, M1[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>, M1[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/problems/hdu-6155/" data-id="ckqmfusam00798ufygaimaby5" data-title="线性变换与矩阵递推习题：hdu 6155 Subsequence Count" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-lmmr/problems/hdu-5068" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/25/lmmr/problems/hdu-5068/" class="article-date">
  <time class="dt-published" datetime="2018-06-25T14:40:23.000Z" itemprop="datePublished">2018-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/solution/">solution</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/25/lmmr/problems/hdu-5068/">线性变换与矩阵递推习题：hdu 5068 Harry And Math Teacher</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有$n$层楼，每层楼有两个楼梯（编号为$0$和$1$），初始的时候第$i$层和第$i+1$层楼的楼梯两两可达</p>
<p>有若干次操作，诸如</p>
<ol>
<li>将第$i$层的第$x$号楼梯和第$i+1$层的第$y$号楼梯的连通性反转</li>
<li>查询从第$x$层到第$y$层的方案数（只能上楼，不能下楼）</li>
</ol>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>设$f_{i,j}$表示到达第$i$层第$j$个楼梯的方案数</p>
<p>则</p>
<p>$$<br>\begin{cases}<br>f_{i,0}=a_{0,0} \times f_{i-1,0}+a_{0,1} \times f_{i-1,1} \\<br>f_{i,1}=a_{1,0} \times f_{i-1,0}+a_{1,1} \times f_{i-1,1}<br>\end{cases}<br>$$</p>
<p>然后写成矩阵递推</p>
<p>$$<br>\begin{pmatrix}<br>f_{i-1,0} &amp; f_{i-1,1}<br>\end{pmatrix}<br>\begin{pmatrix}<br>a_{0,0} &amp; a_{1,0} \\<br>a_{0,1} &amp; a_{1,1}<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>f_{i,0} &amp; f_{i,1}<br>\end{pmatrix}<br>$$</p>
<p>那么只需要维护是否相邻的矩阵即可</p>
<p>初始矩阵全部联通都为$1$，不连通为$0$</p>
<p>一段区间内的方案数是区间内矩阵相乘后的矩阵行列值求和</p>
<p>线段树维护区间矩阵乘积</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">10</span>, p = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">    ll a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">Mat</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span> a); &#125;</span><br><span class="line">    ll* <span class="keyword">operator</span> [] (<span class="keyword">int</span> i) &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    Mat <span class="keyword">operator</span> * (Mat b) &#123;</span><br><span class="line">        Mat rs;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; ++ j)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">2</span> ; ++ k)</span><br><span class="line">                    rs[i][j] = (rs[i][j] + a[i][k] * b[k][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> rs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; mat[N * <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (id &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (id &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; mat[id] = mat[lc] * mat[rc]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) mat[id][<span class="number">0</span>][<span class="number">0</span>] = mat[id][<span class="number">0</span>][<span class="number">1</span>] = mat[id][<span class="number">1</span>][<span class="number">0</span>] = mat[id][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r), <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> mat[id][x][y] ^= <span class="number">1</span>, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid) <span class="built_in">modify</span>(lc, l, mid, pos, x, y);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(rc, mid + <span class="number">1</span>, r, pos, x, y); <span class="built_in">update</span>(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> mat[id];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(qr &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql &gt;= mid + <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(lc, l, mid, ql, mid) * <span class="built_in">query</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="keyword">sizeof</span> mat);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, l, r, pos, x, y ; i &lt;= m ; ++ i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            Mat t = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r - <span class="number">1</span>);</span><br><span class="line">            ll rs = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; ++ j) rs = (rs + t[i][j]) % p;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, rs);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;pos, &amp;x, &amp;y);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">1</span>, n, pos, x - <span class="number">1</span>, y - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) <span class="built_in">sol</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/25/lmmr/problems/hdu-5068/" data-id="ckqmfusaj00718ufy7wc2aw0f" data-title="线性变换与矩阵递推习题：hdu 5068 Harry And Math Teacher" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/6/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/8/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/2021/">2021</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/demo/">demo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/develop/">develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mess/">mess</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/solution/">solution</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/travel/">travel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/">文化课</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2021/" rel="tag">2021</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/51nod/" rel="tag">51nod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HEOI2019/" rel="tag">HEOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NOI2019/" rel="tag">NOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ODT/" rel="tag">ODT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ST%E8%A1%A8/" rel="tag">ST表</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atcoder/" rel="tag">atcoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeforces/" rel="tag">codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dinic/" rel="tag">dinic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/excrt/" rel="tag">excrt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exgcd/" rel="tag">exgcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ezoj/" rel="tag">ezoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fwt/" rel="tag">fwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gcd/" rel="tag">gcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kdtree/" rel="tag">kdtree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" rel="tag">kruskal重构树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loj/" rel="tag">loj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/" rel="tag">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/noip/" rel="tag">noip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powerful-number/" rel="tag">powerful number</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prufer%E5%BA%8F%E5%88%97/" rel="tag">prufer序列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spoj/" rel="tag">spoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie/" rel="tag">trie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" rel="tag">三元环</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" rel="tag">三角换元</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" rel="tag">二进制分组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" rel="tag">信息学竞赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%B8%E5%8C%85/" rel="tag">凸包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BD%E6%95%B0/" rel="tag">函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%9D%97/" rel="tag">分块</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" rel="tag">前缀和</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" rel="tag">前缀和与差分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" rel="tag">单位根</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" rel="tag">单位根反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E6%BC%94/" rel="tag">反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E6%95%B0/" rel="tag">复数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" rel="tag">多边形</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" rel="tag">多项式乘法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%97%E8%B7%AF/" rel="tag">套路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" rel="tag">定期重构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" rel="tag">定积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%B9%E6%8B%8D/" rel="tag">对拍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">广义后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" rel="tag">循环矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" rel="tag">微分方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" rel="tag">微机学考</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" rel="tag">微积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" rel="tag">快速幂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%9F%E9%98%B5/" rel="tag">拟阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%88%97/" rel="tag">排列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" rel="tag">整体二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" rel="tag">文化课</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" rel="tag">斜率优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" rel="tag">斯特林数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" rel="tag">最小乘积问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%9F%E6%9C%9B/" rel="tag">期望</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%81%E9%99%90/" rel="tag">极限</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E7%8E%87/" rel="tag">概率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1/" rel="tag">模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" rel="tag">模拟赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" rel="tag">模拟退火</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E8%AE%B0/" rel="tag">游记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" rel="tag">特征方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag">生成函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" rel="tag">矩阵树定理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E5%88%86/" rel="tag">积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" rel="tag">积性函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" rel="tag">笛卡尔树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" rel="tag">类欧几里得</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" rel="tag">线性筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%A9%E6%94%BE/" rel="tag">缩放</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">网络流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%A4%E8%AE%BA/" rel="tag">群论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85/" rel="tag">背包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" rel="tag">计算几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E6%8E%A5/" rel="tag">链接</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" rel="tag">随机化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">非旋转平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/2021/" style="font-size: 10px;">2021</a> <a href="/tags/51nod/" style="font-size: 10px;">51nod</a> <a href="/tags/HEOI2019/" style="font-size: 10px;">HEOI2019</a> <a href="/tags/NOI2019/" style="font-size: 10px;">NOI2019</a> <a href="/tags/ODT/" style="font-size: 10px;">ODT</a> <a href="/tags/ST%E8%A1%A8/" style="font-size: 10px;">ST表</a> <a href="/tags/atcoder/" style="font-size: 10px;">atcoder</a> <a href="/tags/bzoj/" style="font-size: 15.83px;">bzoj</a> <a href="/tags/codeforces/" style="font-size: 10px;">codeforces</a> <a href="/tags/demo/" style="font-size: 11.67px;">demo</a> <a href="/tags/dinic/" style="font-size: 10px;">dinic</a> <a href="/tags/excrt/" style="font-size: 10px;">excrt</a> <a href="/tags/exgcd/" style="font-size: 10px;">exgcd</a> <a href="/tags/ezoj/" style="font-size: 10.83px;">ezoj</a> <a href="/tags/fwt/" style="font-size: 11.67px;">fwt</a> <a href="/tags/gcd/" style="font-size: 10px;">gcd</a> <a href="/tags/hdu/" style="font-size: 11.67px;">hdu</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/kdtree/" style="font-size: 10px;">kdtree</a> <a href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" style="font-size: 10px;">kruskal重构树</a> <a href="/tags/loj/" style="font-size: 10.83px;">loj</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/noip/" style="font-size: 11.67px;">noip</a> <a href="/tags/powerful-number/" style="font-size: 10px;">powerful number</a> <a href="/tags/prufer%E5%BA%8F%E5%88%97/" style="font-size: 10px;">prufer序列</a> <a href="/tags/spoj/" style="font-size: 10px;">spoj</a> <a href="/tags/trie/" style="font-size: 10px;">trie</a> <a href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" style="font-size: 10px;">三元环</a> <a href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" style="font-size: 10px;">三角换元</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" style="font-size: 10px;">二进制分组</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" style="font-size: 10px;">信息学竞赛</a> <a href="/tags/%E5%87%B8%E5%8C%85/" style="font-size: 10px;">凸包</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 10px;">函数</a> <a href="/tags/%E5%88%86%E5%9D%97/" style="font-size: 10px;">分块</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" style="font-size: 10px;">前缀和</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" style="font-size: 10px;">前缀和与差分</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" style="font-size: 11.67px;">单位根</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" style="font-size: 10.83px;">单位根反演</a> <a href="/tags/%E5%8F%8D%E6%BC%94/" style="font-size: 10px;">反演</a> <a href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">后缀自动机</a> <a href="/tags/%E5%A4%8D%E6%95%B0/" style="font-size: 10.83px;">复数</a> <a href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" style="font-size: 10px;">多边形</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size: 12.5px;">多项式</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" style="font-size: 10px;">多项式乘法</a> <a href="/tags/%E5%A5%97%E8%B7%AF/" style="font-size: 10px;">套路</a> <a href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" style="font-size: 10px;">定期重构</a> <a href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" style="font-size: 10px;">定积分</a> <a href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" style="font-size: 10.83px;">容斥原理</a> <a href="/tags/%E5%AF%B9%E6%8B%8D/" style="font-size: 10px;">对拍</a> <a href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 12.5px;">平衡树</a> <a href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">广义后缀自动机</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 10px;">开发</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">循环矩阵</a> <a href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">微分方程</a> <a href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" style="font-size: 10px;">微机学考</a> <a href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" style="font-size: 11.67px;">微积分</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" style="font-size: 10px;">快速幂</a> <a href="/tags/%E6%8B%9F%E9%98%B5/" style="font-size: 10px;">拟阵</a> <a href="/tags/%E6%8E%92%E5%88%97/" style="font-size: 10px;">排列</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 20px;">数学</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 17.5px;">数论</a> <a href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" style="font-size: 10px;">整体二分</a> <a href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" style="font-size: 10px;">文化课</a> <a href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" style="font-size: 10px;">斜率优化</a> <a href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" style="font-size: 10.83px;">斯特林数</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" style="font-size: 10px;">最小乘积问题</a> <a href="/tags/%E6%9C%9F%E6%9C%9B/" style="font-size: 10px;">期望</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" style="font-size: 13.33px;">杜教筛</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" style="font-size: 12.5px;">杜教筛习题</a> <a href="/tags/%E6%9E%81%E9%99%90/" style="font-size: 10px;">极限</a> <a href="/tags/%E6%A6%82%E7%8E%87/" style="font-size: 11.67px;">概率</a> <a href="/tags/%E6%A8%A1/" style="font-size: 10px;">模</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" style="font-size: 10px;">模拟赛</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" style="font-size: 10px;">模拟退火</a> <a href="/tags/%E6%B8%B8%E8%AE%B0/" style="font-size: 10.83px;">游记</a> <a href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">特征方程</a> <a href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" style="font-size: 10.83px;">生成函数</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 14.17px;">矩阵</a> <a href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" style="font-size: 10px;">矩阵树定理</a> <a href="/tags/%E7%A7%AF%E5%88%86/" style="font-size: 10px;">积分</a> <a href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" style="font-size: 10px;">积性函数</a> <a href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" style="font-size: 10px;">笛卡尔树</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 19.17px;">算法</a> <a href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" style="font-size: 10.83px;">类欧几里得</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" style="font-size: 14.17px;">线性变换</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" style="font-size: 13.33px;">线性变换与矩阵递推习题</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" style="font-size: 10px;">线性筛</a> <a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size: 10.83px;">组合数学</a> <a href="/tags/%E7%BC%A9%E6%94%BE/" style="font-size: 10px;">缩放</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size: 10px;">网络流</a> <a href="/tags/%E7%BE%A4%E8%AE%BA/" style="font-size: 10px;">群论</a> <a href="/tags/%E8%83%8C%E5%8C%85/" style="font-size: 10px;">背包</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" style="font-size: 16.67px;">莫比乌斯反演</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" style="font-size: 15px;">莫比乌斯反演习题</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size: 10px;">计算几何</a> <a href="/tags/%E9%80%92%E6%8E%A8/" style="font-size: 14.17px;">递推</a> <a href="/tags/%E9%93%BE%E6%8E%A5/" style="font-size: 10px;">链接</a> <a href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" style="font-size: 10px;">随机化</a> <a href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 10px;">非旋转平衡树</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 18.33px;">题解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/09/">September 2000</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/06/15/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/02/24/hexo-fea-bg/">hexo:不是bug是feature</a>
          </li>
        
          <li>
            <a href="/2021/01/01/hello-2021/">2021</a>
          </li>
        
          <li>
            <a href="/2020/08/06/net-flow/net-flow/">网络流</a>
          </li>
        
          <li>
            <a href="/2020/08/06/zheng-ti-er-fen/zheng-ti-er-fen/">整体二分</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>