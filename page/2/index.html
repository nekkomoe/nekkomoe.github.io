<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-rand-R-per/rand-R-per" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/07/rand-R-per/rand-R-per/" class="article-date">
  <time class="dt-published" datetime="2019-07-07T07:02:58.000Z" itemprop="datePublished">2019-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/math/">math</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/07/rand-R-per/rand-R-per/">随机、实数、排列</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=29790624&height=66"></iframe>

<h1 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h1><p>排列：互不相同</p>
<p>区间的随机实数：互不相同</p>
<p>弄简单点，就在 $[0,1]$ 上随机 $n$ 个变量 $x_1 \sim x_n$ 吧</p>
<p>它们互不相同，按照大小关系来说，可以看成一个排列</p>
<h1 id="第-k-小的期望"><a href="#第-k-小的期望" class="headerlink" title="第 $k$ 小的期望"></a>第 $k$ 小的期望</h1><p>设第 $k$ 小的值为 $p$，则相当于又随机了一个 $[0,1]$ 的变量 $x_{n+1}$，求 $x_{n+1} \le p$ 的概率</p>
<p>由于这 $n+1$ 个数互不相同，相当于求 $x_{n+1}$ 是第 $k$ 小的概率</p>
<p>可行方案除以总方案即可，也就是：</p>
<p>$$<br>\frac{k \cdot n!}{(n+1)!}=\frac{k}{n+1}<br>$$</p>
<h1 id="星星题"><a href="#星星题" class="headerlink" title="星星题"></a>星星题</h1><ul>
<li><a target="_blank" rel="noopener" href="https://loj.ac/problem/2229">「BJOI2014」想法</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ywwyww/p/10197741.html">「集训队作业2018矩阵玩小凹」</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/07/07/rand-R-per/rand-R-per/" data-id="ckqmfus9y00578ufy7g86gbzi" data-title="随机、实数、排列" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8E%92%E5%88%97/" rel="tag">排列</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%9F%E6%9C%9B/" rel="tag">期望</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%A6%82%E7%8E%87/" rel="tag">概率</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-powerful-number/powerful-number" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/26/powerful-number/powerful-number/" class="article-date">
  <time class="dt-published" datetime="2019-06-26T09:04:39.000Z" itemprop="datePublished">2019-06-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/math/">math</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/26/powerful-number/powerful-number/">幂数（powerful number）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=35848639&height=66"></iframe>

<p>定义 <code>powerful number</code> 的为如下集合的中的元素：</p>
<p>$$<br>{a^2b^3|a,b \in \mathbb{N^+}}<br>$$</p>
<p>对于积性函数 $f(n)$，设其在 $p^e$ 时的函数为 $f_\tau$，在 $p$ 时的函数为 $g$，且 $g(1)=1$，则 $F(n)=\sum_{i=1}^{n}f(i)$ 可以用幂数求解</p>
<p><del>当然，在 $p^e$ 处的 $g$ 是需要自己搞的，一般而言直接和 $p$ 处一致即可</del></p>
<p>然后需要搞出一个函数 $h$，满足 $h=\frac{f}{g}$，即 $h \times g = f$</p>
<p>考虑在质数时的情况，有 $g(n)=f_\tau(n)=\sum_{i=0}^{1}g(n^i)h(n^{1-i})=g(1)h(n)+g(n)h(1)=h(n)+g(n)$，即 $h(n)=0$</p>
<p>考虑 $n$ 是质数且 $e \ge 2$ 时，$h(n^e)$ 时的值，由于 $f_\tau(n^e)=\sum_{i=0}^{e}g(n^i)h(n^{e-i})$，则有 $h(n^e)=f_\tau(n^e)-\sum_{i=1}^{e}g(n^i)h(n^{e-i})$</p>
<p>展开可得：</p>
<p>$$<br>\begin{aligned}<br>h(n^e)<br>=&amp;f_\tau(n^e)-\sum_{i=1}^{e}g(n^i)h(n^{e-i}) \\<br>=&amp;f_\tau(n^e)-\sum_{i=0}^{e-1}h(n^i)g(n^{e-i}) \\<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>&amp; h(n)=f_\tau(n)-h(1)g(n)=0 \\<br>&amp; h(n^2)=f_\tau(n^2)-h(1)g(n^2)-h(n)g(n)=f_\tau(n^2)-g(n^2) \\<br>&amp; h(n^3)=f_\tau(n^3)-h(1)g(n^3)-h(n)g(n^2)-h(n^2)g(n)=f_\tau(n^3)-g(n^3)-(f_\tau(n^2)-g(n^2))g(n) \\<br>\end{aligned}<br>$$</p>
<p><del>然而似乎没啥规律，具体问题具体分析吧</del></p>
<p>现在要计算 $f$ 的前缀和，有：</p>
<p>$$<br>\begin{aligned}<br>F(n)<br>=&amp;\sum_{i=1}^{n}f(i) \\<br>=&amp;\sum_{i=1}^{n}\sum_{j|i} g(j)h\left(\frac{i}{j} \right) \\<br>=&amp;\sum_{j=1}^{n} h(j) \sum_{i=1}^{\left\lfloor \frac{n}{j} \right\rfloor} g(i) \\<br>=&amp;\sum_{i=1}^{n}h(i)G\left( \left\lfloor \frac{n}{i} \right\rfloor \right)<br>\end{aligned}<br>$$</p>
<p>那么只需要枚举非 $0$ 的 $h$，然后计算 $G$ 即可，因此要求 $G$ 可以快速求和</p>
<p>考虑分析时间复杂度，首先计算的 <code>powerful number</code> 的个数（也就是 $h$ 非 $0$ 的个数）一共有 $\sqrt{n}$ 个，因此暴力枚举的复杂度是 $O(\sqrt{n} \cdot (\log n + T(f_\tau)))$</p>
<p>之后还要计算一共 $\sqrt{n}$ 个 $G$，这一部分的时间复杂度为 $O(\sqrt{n} \cdot T(G))$</p>
<p>实际上还可以更近一步，考虑枚举 <code>powerful number</code> 的时候计算 $h$，那么只需要枚举 $a,b$，即 $n=a^2b^3$</p>
<p>为了去重可以这么枚举：把质因子尽可能多的推到 $a^2$ 中去，也就是 $b$ 中无完全平方数，也就是 $|\mu(b)|=1$</p>
<p>也就是可以这么枚举：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(a = <span class="number">1</span> ; a * a &lt;= n ; ++ a) &#123;</span><br><span class="line">    <span class="keyword">for</span>(b = <span class="number">1</span> ; a * a * b * b * b &lt;= n ; ++ b) &#123;</span><br><span class="line">        <span class="keyword">if</span>(mu[b]) &#123;</span><br><span class="line">            powerful_number = a * a * b * b * b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于之后还要面对把某个幂数质因数分解，相当于对 $a,b$ 分别质因数分解，它们都是不超过 $\sqrt{n}$ 的，因此可以预处理每个不超过 $\sqrt{n}$ 的正整数的最小质因子是谁</p>
<p>对于计算 $h(n)$，只需要把 $n$ 质因数分解，设 $n=\prod p_i^{e_i}$，则 $h(n)=\prod h\left(p_i^{k_i}\right)$</p>
<p>于是总的时间复杂度为 $O(\sqrt{n} \cdot (\log n + T(f_\tau)+T(G)))$</p>
<p><del>那么对 $n$ 质因数分解，即对 $a,b$ 分别质因数分解，那么这一部分的总复杂度就化为了 $O(\log \log n)$</del></p>
<p><del>于是最终的总时间复杂度为 $O(\sqrt{n} \cdot (\log \log n + T(f_\tau)+T(G)))$</del></p>
<hr>
<p>第一个例题：</p>
<blockquote>
<p>对于积性函数 $f(n)$，有 $f_\tau(p^e)=p^k$，给定 $n,k$，求 $F(n)=\sum_{i=1}^{n}f(i)$</p>
<p>数据范围：$1 \le n \le 10^{14},1 \le k \le 5000$</p>
<p>时间限制：$2s$</p>
</blockquote>
<p>那么有 $g(n)=f_\tau(n)=n^k$，且：</p>
<p>$$<br>\begin{aligned}<br>h(n^e)<br>=&amp;f(n^e)-\sum_{i=0}^{e-1}h(n^i)g(n^{e-i}) \\<br>=&amp;n^k-\sum_{i=0}^{e-1}h(n^i)n^{(e-i)k}<br>\end{aligned}<br>$$</p>
<p>找找规律：</p>
<p>$$<br>\begin{aligned}<br>&amp; h(n)=f_\tau(n)-h(1)g(n)=0 \\<br>&amp; h(n^2)=f_\tau(n^2)-g(n^2)=n^k-n^{2k} \\<br>&amp; h(n^3)=f_\tau(n^3)-g(n^3)-(f_\tau(n^2)-g(n^2))g(n)=n^k-n^{3k}-(n^k-n^{2k})n^{k}=n^k-n^{2k} \\<br>\end{aligned}<br>$$</p>
<p>猜想 $h(n^e)=(n^k-n^{2k}) \cdot [e \ge 2]$</p>
<p>若 $h(n^{e-1})$ 成立，考虑 $h(n^{e})$，有：</p>
<p>$$<br>\begin{aligned}<br>h(n^e)<br>=&amp;n^k-h(1)n^{ek}-h(n)n^{(e-1)k}-\sum_{i=2}^{e-1}(n^k-n^{2k})n^{(e-i)k} \\<br>=&amp;n^k-n^{ek}-(n^k-n^{2k})\sum_{i=1}^{e-2}(n^k)^{i} \\<br>=&amp;n^k-n^{ek}-n^k(1-n^{k}) \frac{n^{k(e-1)}-n^k}{1-n^k} \\<br>=&amp;n^k-n^{ek}-n^{ek}+n^{2k} \\<br>=&amp;n^k-n^{2k}<br>\end{aligned}<br>$$</p>
<p>然而这个还是很难跑 $(10^{14},5000)$ 的数据</p>
<p>考虑到 $G$ 的计算，实际上是自然数幂和，在这里不考虑拉格朗日插值和贝尔数，考虑用第二类斯特林数来进行自然数幂和的计算</p>
<p><del>实际上斯特林数的第二维求和是贝尔数</del></p>
<p>考虑到 $n^m=\sum_{k=0}^{m}S_{m,k}{n \choose k}k!$，同时不难得到 $\sum_{i=1}^{n}{i \choose j}={n+1 \choose j+1}$，于是有：</p>
<p>$$<br>\begin{aligned}<br>\sum_{i=1}^{n}i^k<br>=&amp;\sum_{i=1}^{n} \sum_{j=0}^{k} S_{k,j} {i \choose j} j! \\<br>=&amp;\sum_{j=0}^{k}S_{k,j} j!\sum_{i=1}^{n}  {i \choose j} \\<br>=&amp;\sum_{j=0}^{k}S_{k,j}j! {n+1 \choose j+1} \\<br>=&amp;\sum_{j=0}^{k}S_{k,j}j! \frac{(n+1)^{\underline {j+1}}}{(j+1)!} \\<br>=&amp;\sum_{j=0}^{k}S_{k,j} \frac{(n+1)^{\underline {j+1}}}{j+1} \\<br>\end{aligned}<br>$$</p>
<blockquote>
<p>题外话：如何求模 $2^{32}$ 意义下的自然数幂和</p>
<p>由于没有逆元，但是 $(n+1)^{\underline {j+1}}$ 中一定存在一个 $j+1$ 的倍数（原因：一共有 $j+1$ 个数，模 $j+1$ 意义下一定存在一个余数为 $0$ 的</p>
<p>因此找出那个数即可（可能要暴力找？）</p>
</blockquote>
<p>然而这个常数还是挺大的，发现每次调用的自然数幂和太多了</p>
<p>从直觉上来看，幂数都是比较大的，也就是说 $G\left(\left\lfloor \frac{n}{i} \right\rfloor\right)$ 中的参数很小（实际上由于 $\left\lfloor \frac{n}{i} \right\rfloor$ 只有 $\sqrt {n}$ 个取值，可以根据是否大于 $\sqrt{n}$ 用两个数组进行记录）</p>
<p>实践中，$\left\lfloor \frac{n}{i} \right\rfloor \le \sqrt{n}$ 的远远大于剩下的一些，因此可以直接线性筛一下 $\sqrt{n}$ 的自然数幂和</p>
<hr>
<p>第二个例题：</p>
<blockquote>
<p>对于积性函数 $f(n)$，有 $f_\tau(p^e)=p \oplus e$，给定 $n$，求 $F(n)=\sum_{i=1}^{n}f(i)$</p>
<p>数据范围：$1 \le n \le 10^{10}$</p>
<p>时间限制：$2s$</p>
</blockquote>
<p>因为奇素数二进制末尾为 $1$，所以在 $p$ 处有 $f(p)=p \oplus 1=(p-1) \cdot [p \ne 2] + 3 \cdot [p=2]$</p>
<p>则质数处大约就是 $g(p)=\phi(p)$，特别的，$g(2)=3$</p>
<p><del>咕咕咕</del></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/26/powerful-number/powerful-number/" data-id="ckqmfus9m004i8ufy4cx6f6lt" data-title="幂数（powerful number）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powerful-number/" rel="tag">powerful number</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-cc-JUNE19/cc-JUNE19" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/11/cc-JUNE19/cc-JUNE19/" class="article-date">
  <time class="dt-published" datetime="2019-06-11T01:59:10.000Z" itemprop="datePublished">2019-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/11/cc-JUNE19/cc-JUNE19/">Codechef JUNE Challenge 2019</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=41632439&height=66"></iframe>

<p><a target="_blank" rel="noopener" href="https://www.codechef.com/JUNE19B">比赛链接</a></p>
<h1 id="Chef-and-Proxy-PROXYC"><a href="#Chef-and-Proxy-PROXYC" class="headerlink" title="Chef and Proxy - PROXYC"></a>Chef and Proxy - PROXYC</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一个由字符 $A,P$ 构成序列 $S$</p>
<p>你可以把一些位置上的值变成 $B$，如果 $S_i$ 能变成 $B$，当且仅当：</p>
<ul>
<li>$3 \le i \le n-2$</li>
<li>$S_i=A$</li>
<li>$([S_{i-1}=P] \lor [S_{i-2}=P]) \land ([S_{i+1}=P] \lor [S_{i+2}=P])$</li>
</ul>
<p>你的目标是把尽可能少的 $A$ 变成 $B$，之后需要满足 $ \frac{\sum_{x \in S}[x \ne A]}{|S|} \ge \frac{3}{4}$</p>
<p>数据范围：$1 \le |S| \le 1000$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>设有 $x$ 个位置可以变成 $B$，有 $y$ 个位置是 $P$，至少需要 $z$ 个非 $A$ 的位置</p>
<p>如果 $y \ge z$，那么就直接可行了，否则需要 $z-y$ 个位置放 $B$，判断一下即可</p>
<h1 id="Guddu-on-a-Date-KS2"><a href="#Guddu-on-a-Date-KS2" class="headerlink" title="Guddu on a Date - KS2"></a>Guddu on a Date - KS2</h1><h2 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h2><p>定义圆数为十进制下个位数字之和为 $10$ 的倍数的正整数，求第 $n$ 个圆数</p>
<p>数据范围：$1 \le n \le 10^{18}$</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>首先圆数的位数不会小于 $2$，而且个位是由个位前的数位之和唯一确定的</p>
<p>也就是所有圆数去掉个位后互不相同，且构成正整数集</p>
<p>也就是只需要输出 $n \cdot 10+((10-m \bmod 10) \bmod 10)$ 即可，其中 $m$ 为 $\left\lfloor \frac{n}{10} \right\rfloor$ 的各个数位之和</p>
<h1 id="Road-Signs-RSIGNS"><a href="#Road-Signs-RSIGNS" class="headerlink" title="Road Signs - RSIGNS"></a>Road Signs - RSIGNS</h1><h2 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h2><p>$Marichka$ 在去大厨国的途中看到了 $10^K$ 个路牌（编号为 $0 \sim 10^K-1$）</p>
<p>编号为 $i$ 的路牌一面写了数字 $i$，另一面写了数字 $10^K − i − 1$</p>
<p>$Marichka$ 想知道，有多少块路牌正反两面的数字中，一共只有两种不同的数位？</p>
<p>由于答案可能很大，请求出其对 $10^9 + 7$ 取模的结果</p>
<p>数据范围：$1 \le K \le 10^9$</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>显然答案就是 $10 \times 2^{K-1}$</p>
<h1 id="Chef-and-Ingredients-CHFING"><a href="#Chef-and-Ingredients-CHFING" class="headerlink" title="Chef and Ingredients - CHFING"></a>Chef and Ingredients - CHFING</h1><p>大厨想要做一顿满汉全席，为此，他需要各种各样的食材</p>
<p>每种食材都有自己的美味程度，可以是任意正整数</p>
<p>初始时，对于 $[K, K + N − 1]$ 内的每种美味程度，大厨都有无限量的食材</p>
<p>食材有个独特的性质：任意两种食材经过混合，都可以得到一种新食材</p>
<p>设原本两食材的美味程度分别为 $x$ 和 $y$，那么新食材的美味程度就是 $x + y$</p>
<p>混合得到的新食材也可以再次被混合，大厨可以以任意方式混合任意多次</p>
<p>如果无论如何都无法得到美味程度为 $v$ 的食材，那么我们称美味程度 $v (v &gt; 0)$ 是不可达成的</p>
<p>否则，就是可达成的</p>
<p>大厨要做出每种可达成的美味程度的食材，因此他想知道有多少种不可达成的美味程度</p>
<p>由于种数可能很多，请你求出其对 $10^9 + 7$ 取模的结果</p>
<p>注：可达成美味程度有无穷多种，但可以证明对于 $N \ge 2$，不可达成的美味程度一定只有有<br>限种</p>
<p>数据范围：$2 \le N \le 10^{18},1 \le K \le 10^{18}$</p>
<h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><p>设你能使用的数字为 $a,a+1,a+2,\cdots,b$，那么 $1 \sim a-1$ 一定无法达成</p>
<p>如果 $b \ge 2a$，则所有数字都可以构成</p>
<p>否则 $b+1 \sim 2a$ 是无法构成的，把 $[a,2a]$ 当作一块，所有块的 $b+1 \sim 2a$ 部分都无法构成</p>
<p>于是答案就是：<br>$$<br>\sum_{i=0}^{K+N-3}\left\lfloor \frac{i}{N-1} \right\rfloor<br>$$</p>
<h1 id="Sum-and-GCD-SUMAGCD"><a href="#Sum-and-GCD-SUMAGCD" class="headerlink" title="Sum and GCD - SUMAGCD"></a>Sum and GCD - SUMAGCD</h1><h2 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h2><p>大厨有一个正整数序列 $A_1, A_2, \cdots , A_N$</p>
<p>他想要将这个序列分成两个非空的（未必连续的）子序列 $B$ 和 $C$，使得 $\gcd(B) + \gcd(C)$ 尽可能大</p>
<p>请你求出这一最大值</p>
<p>数据范围：$2 \le N \le 10^5, 1 \le A_i \le 10^9$</p>
<h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><p>首先重复的数字是没用的，先去重一下</p>
<p>猜想最优解一定是某个数单独作为一个集合，剩下的数字另作一个集合</p>
<p>然后写一下，发现它过了</p>
<h1 id="Lent-Money-LENTMO"><a href="#Lent-Money-LENTMO" class="headerlink" title="Lent Money - LENTMO"></a>Lent Money - LENTMO</h1><h2 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h2><p>大厨借了些钱给 $Chefexim$</p>
<p>大厨讨债讨了好一阵子了，但 $Chefexim$ 总是能找到一些理由拖着</p>
<p>这次，大厨真的生气了，他自己想做点印度点心都没钱买食材了</p>
<p>看到大厨这么生气，$Chefexim$ 终于决定还钱了</p>
<p>他知道大厨喜欢做题，因此还钱的同时还送了大厨一道题，让他消消气</p>
<p>$Chefexim$ 把借来的钱分装进了 $N$ 个袋子（编号为 $1 \sim N$），第 $i$ 个袋子里有 $A_i$ 块钱</p>
<p>他把所有 $N$ 个袋子都给了大厨，然后告诉了他两个整数 $K$ 和 $X$</p>
<p>大厨可以任意次（包括零次）进行下面的操作：</p>
<ul>
<li>选择 $K$ 个不同的袋子，编号分别为 $i_1, i_2, \cdots , i_K (1 \le i_j \le N)$</li>
<li>改变选择的袋子里装的金额，对于 $1 \le j \le K$，编号为 $i_j$ 的袋子里的钱从 $A_{i_j}$ 变为 $A_{i_j} \text{ xor } X$</li>
</ul>
<p>每个袋子可以在任意多次操作中被选择</p>
<p>假设大厨按照最优策略操作，最后所有袋子里的金额之和最大可以是多少？</p>
<p>数据范围：$1 \le N \le 10^4, 1 \le K \le N, 0 \le A_i \le 10^9, 0 \le X \le 10^9$</p>
<h2 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h2><p>首先题意可以转化为，给定 $n$ 张牌，每张牌正面是 $0$，反面是 $b_i$</p>
<p>每次你可以选择 $k$ 张牌并把它们翻面，最大化最终所有牌朝上面的数字之和</p>
<p>首先如果 $k=n$ 可以特判掉</p>
<p>否则，如果 $k$ 是奇数，则可以把任意多张牌都翻面</p>
<p>如果 $k$ 是偶数，则只能把任意偶数张牌翻面</p>
<p>那么从大到小排序后贪心即可</p>
<h1 id="Intersecting-Paths-INTRPATH"><a href="#Intersecting-Paths-INTRPATH" class="headerlink" title="Intersecting Paths - INTRPATH"></a>Intersecting Paths - INTRPATH</h1><h2 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一棵 $N$ 个节点的树（无向无环连通图），节点编号为 $1 \sim N$</p>
<p>对于每对节点 $u$ 和 $v$，记它们之间的简单路径为 $(u, v)$</p>
<p>这些路径都是没有方向的，因此 $(u, v)$ 与 $(v, u)$ 等价</p>
<p>你需要回答 $Q$ 个询问，每个询问给定两个节点 $u$ 和 $v$</p>
<p>对于树中每一条简单路径 $(a, b)$，我们定义完美相交如下：</p>
<ul>
<li>记路径 $(u, v)$ 和 $(a, b)$ 途经的节点（包括端点）集合分别为 $S_1$ 和 $S_2$</li>
<li>如果 $|S_1 \cap S_2|=1$（即两条路径只有一个公共节点），那么 $(a, b)$ 与 $(u, v)$ 完美相交</li>
</ul>
<p>询问的回答即与 $(u, v)$ 完美相交的简单路径条数</p>
<p>数据范围：$1 \le Q \le 3 \cdot 10^5,1 \le u,v \le N \le 250000$</p>
<h2 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h2><p>只需要对于每个链上的点考虑一下经过它的路径条数即可</p>
<p>设 $s_u$ 表示 $u$ 的子树大小，$f_u$ 表示 $u$ 的子树中经过 $u$ 的路径条数，考虑链上的边 $u \to v$，那么交点为 $u$ 的路径条数为 $f_u-s_v(s_u-s_v)$，预处理后前缀和即可解决</p>
<p>之后特殊考虑一下 $\text{lca}$ 处的答案即可</p>
<h1 id="Chef-and-His-Dish-COOLCHEF"><a href="#Chef-and-His-Dish-COOLCHEF" class="headerlink" title="Chef and His Dish - COOLCHEF"></a>Chef and His Dish - COOLCHEF</h1><h2 id="题目描述-6"><a href="#题目描述-6" class="headerlink" title="题目描述"></a>题目描述</h2><p>大厨在厨房里做实验</p>
<p>他有 $N$ 种香料（编号为 $0 \sim N − 1$），类型分别为 $S_0, S_1 , \cdots, S_{N−1}$</p>
<p>你需要回答 $Q$ 个询问，每个询问给定两个整数 $L$ 和 $R$</p>
<p>大厨想使用编号在 $[L, R]$ 中的所有香料来做一道菜</p>
<p>不过，大厨不知道应该以什么顺序放这些香料</p>
<p>因此，他想知道一共有多少种不同的可能</p>
<p>即，序列 $S_L, S_{L+1}, \cdots , S_R$ 共有多少本质不同的排列方案</p>
<p>由于答案可能很大，请输出答案对 $10^9 + 7$ 取模的结果</p>
<p>我们认为两种排列本质不同，当且仅当存在下标 $i$，且两个排列的第 $i$ 位不同</p>
<p>你需要在线回答所有询问，输入已经过加密</p>
<p>数据范围：$1 \le N,Q \le 3 \cdot 10^5, 1 \le S_i \le 10^9, 0 \le L, R &lt; n$</p>
<h2 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h2><p>分块模板题，卡卡常就过了</p>
<h1 id="Count-Arrays-COUNTIT"><a href="#Count-Arrays-COUNTIT" class="headerlink" title="Count Arrays - COUNTIT"></a>Count Arrays - COUNTIT</h1><h2 id="题目描述-7"><a href="#题目描述-7" class="headerlink" title="题目描述"></a>题目描述</h2><p>考虑所有仅包含 $[1, K]$ 中的整数的 $N$ 行 $M$ 列矩阵（行列均从 $1$ 开始编号）</p>
<p>对于每个这样的矩阵 $A$，按下述规则构造序列 $L_1, L_2, \cdots , L_{N+M}$：</p>
<ul>
<li>对于 $1 \le  i \le N$，$L_i$ 为 $A$ 第 $i$ 行中元素的最大值</li>
<li>对于 $1 \le i \le M$，$L_{i+N}$ 为 $A$ 第 $i$ 列中元素的最大值</li>
</ul>
<p>请求出有多少种不同的序列，由于答案可能很大，请输出其对 $10^9 + 7$ 取模的结果</p>
<p>数据范围：$1 \le K\ le 10^9, 1 \le N,M \le 10^5$</p>
<h2 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h2><p>猜想这个序列只需要满足前 $n$ 个位置和后 $m$ 个位置的最大值相同即可</p>
<p>不难得到答案为：</p>
<p>$$<br>\begin{aligned}<br>\sum_{x=1}^{k} \left(x^n-(x-1)^n\right) \left( x^m-(x-1)^m \right)<br>\end{aligned}<br>$$</p>
<p>至多是个 $n+m+10$ 次多项式，暴力插值即可</p>
<p>另一个没法做的想法：</p>
<p>定义 $0^0=1$，答案为：</p>
<p>$$<br>\begin{aligned}<br> &amp;\sum_{x=1}^{k} \sum_{i=1}^{n} {n \choose i} (x-1)^{n-i} \sum_{j=1}^{m} {m \choose i} (x-1)^{m-j} \\<br>=&amp;\sum_{x=1}^{k} \sum_{i=0}^{n-1} {n \choose n-i} (x-1)^{i} \sum_{j=0}^{m-1} {m \choose m-i} (x-1)^{j} \\<br>=&amp;\sum_{x=1}^{k} \sum_{i=0}^{n-1} {n \choose i} (x-1)^{i} \sum_{j=0}^{m-1} {m \choose i} (x-1)^{j} \\<br>=&amp;\sum_{i=0}^{n-1}\sum_{j=0}^{m-1} {n \choose i} {m \choose j} \sum_{x=1}^{k} (x-1)^{i+j} \\<br>=&amp;\sum_{i=0}^{n-1}\sum_{j=0}^{m-1} {n \choose i} {m \choose j} \sum_{x=0}^{k-1} x^{i+j} \\<br>=&amp;\sum_{i=0}^{n-1}\sum_{j=0}^{m-1} {n \choose i} {m \choose j} f_{i+j}(k) \\<br>=&amp;\sum_{T=0}^{n+m-2}f_T(k) \sum_{i=0}^{T} {n \choose i} {m \choose T-i}[i&lt;n][T-i&lt;m] \\<br>=&amp;\sum_{T=0}^{n+m-2}f_T(k) \left({n+m \choose T}-{m \choose T-n}-{n \choose T-m} \right)<br>\end{aligned}<br>$$</p>
<p>其中 $f_T(k)=\sum_{i=0}^{k-1}i^T$</p>
<p>然而这个玩意不太能做，还是算了</p>
<h1 id="Forgotten-Tree-9-FGTREE"><a href="#Forgotten-Tree-9-FGTREE" class="headerlink" title="Forgotten Tree 9 - FGTREE"></a>Forgotten Tree 9 - FGTREE</h1><h1 id="SnackDown-99-SNCK99"><a href="#SnackDown-99-SNCK99" class="headerlink" title="SnackDown 99 - SNCK99"></a>SnackDown 99 - SNCK99</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/11/cc-JUNE19/cc-JUNE19/" data-id="ckqmfus89000y8ufyd3kcb3rz" data-title="Codechef JUNE Challenge 2019" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-abc129/abc129" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/09/abc129/abc129/" class="article-date">
  <time class="dt-published" datetime="2019-06-09T13:45:13.000Z" itemprop="datePublished">2019-06-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/09/abc129/abc129/">AtCoder Beginner Contest 129</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=555142&height=66"></iframe>

<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc129">比赛链接</a></p>
<h1 id="A-Airplane"><a href="#A-Airplane" class="headerlink" title="A - Airplane"></a>A - Airplane</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有三个地方，编号为 $1,2,3$，给定两两之间的距离，且 $\text{dis}(i,j)=\text{dis}(j,i),\text{dis}(i,i)=0$</p>
<p>求一个 $1 \sim 3$ 的排列 $a,b,c$，最小化 $\text{dis}(a,b)+\text{dis}(b,c)$</p>
<p>数据范围：$1 \le \text{dis} \le 100$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>把最短边和次短边加起来输出即可</p>
<h1 id="B-Balance"><a href="#B-Balance" class="headerlink" title="B - Balance"></a>B - Balance</h1><h2 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 $w_1,w_2,\cdots,w_n$，求一个 $1 \le T &lt; n$，最小化 $\left|\left(\sum_{i=1}^{T}w_i \right)-\left(\sum_{i=T+1}^{n}w_i\right)\right|$</p>
<p>数据范围：$2 \le n \le 100, 1 \le w_i \le 100$</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>枚举 $T$，然后暴力计算 $LHS,RHS$ 即可</p>
<h1 id="C-Typical-Stairs"><a href="#C-Typical-Stairs" class="headerlink" title="C - Typical Stairs"></a>C - Typical Stairs</h1><h2 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h2><p>有一个长度为 $n+1$ 的序列，一开始你在 $0$ 号位置，剩余位置编号依次为 $1,2,\cdots,n$</p>
<p>假设当前你在 $x$，下一步你可以走到 $x+1$ 或者 $x+2$</p>
<p>有一些位置是不能走的，它们为 $a_1,a_2,\cdots,a_m$</p>
<p>求从 $0$ 号位置走到 $n$ 号位置的方案数</p>
<p>数据范围：$1 \le n \le 10^5, 0 \le m \le n-1, 1 \le a_1 &lt; a_2 &lt; \cdots &lt; a_m &lt; n - 1$</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>设 $f_n$ 表示走到 $n$ 的方案数，大概就有：</p>
<p>$$<br>f_n=\begin{cases}<br>0 &amp; \quad (\exists1 \le i \le m:a_i=n) \\<br>f_{n-1}+f_{n-2} &amp; \quad (\text{otherwise})<br>\end{cases}<br>$$</p>
<h1 id="D-Lamp"><a href="#D-Lamp" class="headerlink" title="D - Lamp"></a>D - Lamp</h1><h2 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一个 $H \times W$ 的网格，有一些位置是有障碍的，你需要在其中放一个灯塔，它会直线照亮上下左右的所有格子，直到遇到障碍</p>
<p>最大化照亮的格子个数</p>
<p>数据范围：$1 \le H, W \le 2000$</p>
<h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><p>预处理一下 $up,down,left,right$ 数组后枚举放哪就行了</p>
<h1 id="E-Sum-Equals-Xor"><a href="#E-Sum-Equals-Xor" class="headerlink" title="E - Sum Equals Xor"></a>E - Sum Equals Xor</h1><h2 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 $L$，求有多少个有序非负整数对 $(a,b)$，满足 $a+b \le L$ 且 $a+b=a \text{ xor } b$</p>
<p>数据范围：$1 \le L &lt; 2^{100001}$</p>
<h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><p>显然 $a+b = a \text{ xor } b$ 等价于 $a \text{ and } b=0$，换句话说 $a,b$ 的二进制位上不存在两个同时为 $1$ 的位置</p>
<p>那么可以枚举 $a+b$，假设 $c=a+b$，且 $c$ 有 $x$ 个 $1$，则可行的 $(a,b)$ 有 $2^{x}$ 个</p>
<p>那么就类似于数位 $dp$ 那样，枚举 $c$ 和 $L$ 的 $lcp$，剩下的就是 $\sum_{i=0}^{y}2^i{y \choose i}=3^y$ 就行了</p>
<h1 id="F-Takahashi’s-Basics-in-Education-and-Learning"><a href="#F-Takahashi’s-Basics-in-Education-and-Learning" class="headerlink" title="F - Takahashi’s Basics in Education and Learning"></a>F - Takahashi’s Basics in Education and Learning</h1><h2 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 $L,A,B,M$，求 $A,A+B,A+2B,\cdots,A+(L-1)B$ 在十进制下依次拼接起来的数字模 $M$ 的值</p>
<p>数据范围：$1 \le L,A,B &lt; 10^{18},2 \le M \le 10^9$</p>
<h2 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h2><p>考虑到 $A+kB$ 的十进制位数不会超过 $40$，那么就可以枚举位数，转移是一个线性的形式，矩阵乘法即可</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/09/abc129/abc129/" data-id="ckqmfus85000q8ufy0rc5hjvv" data-title="AtCoder Beginner Contest 129" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/atcoder/" rel="tag">atcoder</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-uoj-156/uoj-156" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/05/uoj-156/uoj-156/" class="article-date">
  <time class="dt-published" datetime="2019-06-05T13:28:53.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/05/uoj-156/uoj-156/">【清华集训2015】恐怖的奴隶主</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://uoj.ac/problem/156">题目链接</a></p>
<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p>设 $u_i$ 为一数列，满足：</p>
<p>$$<br>u_i = a + \frac{b}{u_{i-1}} + \frac{c}{u_{i-1}u_{i-2}}  \quad (i \ge 2)<br>$$</p>
<p>给定 $u_0, u_1, a, b, c, n$，保证 $x^3 = a x^2 + b x + c$ 有 $3$ 个不同的正整数解，求 $u_n$</p>
<p>其中 $$c \le 100000, |u_0| \le 1000, |u_1| \le 1000, 0 \le n \le 10^9$$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>设 $v_i=\prod_{j=1}^{i}u_j$，由于 $u_i = a + \frac{b}{u_{i-1}} + \frac{c}{u_{i-1}u_{i-2}}$，则 $v_i=v_{i-1}(a+\frac{b}{u_i}+\frac{c}{u_{i-1}u_{i-2}})$</p>
<p>化简可得 $v_i=av_{i-1}+bv_{i-2}+cv_{i-3}$</p>
<p>由于 $x^3=ax^2+bx+c$ 有三个不同的根，设它们从大到小为 $\alpha, \beta,\gamma$</p>
<p>则存在实数 $x,y,z$，满足 $v_i=x \alpha^i+y \beta^i + z \gamma^i$</p>
<p>即 $u_i=\frac{v_i}{v_{i-1}}=\frac{x \alpha^i+y \beta^i + z \gamma^i}{x \alpha^{i-1}+y \beta^{i-1} + z \gamma^{i-1}}$</p>
<p>于是它是收敛的，要么高精度要么直接暴力模拟即可……</p>
<p>若 $x=y=0$，极限为 $\gamma$</p>
<p>若 $x=0,y \ne 0$，极限为 $\beta$</p>
<p>若 $x \ne 0$，极限为 $\alpha$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/05/uoj-156/uoj-156/" data-id="ckqmfusa3005o8ufyg2w0e96g" data-title="【清华集训2015】恐怖的奴隶主" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-partialsum-to-mobiusinversion/partialsum-to-mobiusinversion" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/03/partialsum-to-mobiusinversion/partialsum-to-mobiusinversion/" class="article-date">
  <time class="dt-published" datetime="2019-06-03T12:14:28.000Z" itemprop="datePublished">2019-06-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/03/partialsum-to-mobiusinversion/partialsum-to-mobiusinversion/">从前缀和到莫比乌斯反演</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=28854949&height=66"></iframe>
# 基础知识

<h2 id="前缀和"><a href="#前缀和" class="headerlink" title="前缀和"></a>前缀和</h2><h3 id="一维情况"><a href="#一维情况" class="headerlink" title="一维情况"></a>一维情况</h3><p>设有序列 ${a_n}$，定义其前缀和为序列 ${s_n}$，满足 $s_n=\sum_{i=1}^{n}a_i$</p>
<p>前缀和的定义有一个好处，就是可以快速提取 $a$ 的区间和（前提是存在加法逆元），即 $\sum_{i=l}^{r}a_i=s_r-s_{l-1}$</p>
<p><del>连续情况下为积分，此处为离散积分</del></p>
<h3 id="二维情况"><a href="#二维情况" class="headerlink" title="二维情况"></a>二维情况</h3><p>给定 ${a_{n.m}}$，求 ${s_{n,m}}$，满足 $s_{n,m}=\sum_{i \le n}\sum_{j \le m}a_{i,j}$</p>
<p>考虑容斥，有 $s_{n,m}=s_{n-1,m}+s_{n,m-1}-s_{n-1,m-1}+a_{n,m}$</p>
<p>还有另一种做法：先对第一维求前缀和 ${b_{n,m}}$，满足 $b_{n,m}=\sum_{i \le n}a_{i,m}$，然后对第二维在 ${b_{n,m}}$ 的基础上求前缀和，得到 ${s_{n,m}}$，即 $s_{n,m}=\sum_{j \le m}b_{n,j}$</p>
<p>实际上是先求出了一堆列的前缀和，然后再对行求前缀和就得到了矩形的前缀和</p>
<h3 id="高维情况"><a href="#高维情况" class="headerlink" title="高维情况"></a>高维情况</h3><p>给定 ${a_{x_1,x_2,\cdots,x_k}}$，求 ${s_{x_1,x_2,\cdots,x_k}}$，满足 $s_{x_1,x_2,\cdots,x_k}=\sum_{i_1 \le x_1}\sum_{i_2 \le x_2} \cdots \sum_{i_k \le x_k}a_{i_1,i_2,\cdots,i_k}$</p>
<p>先考虑容斥，有：</p>
<p>$$<br>s _ {x _ 1,x _ 2,\cdots,x _ k}=a _ {x _ 1,x _ 2,\cdots,x _ k}+\sum_{i _ 1=0}^{1}\sum_{i _ 2=0}^{1}\cdots \sum_{i _ k=0}^{1} \left[\sum  _ {j=1}^{k}i _ j &gt; 0 \right](-1)^{\left(1+\sum _ {j=1}^{k}i _ j\right)} s _ {x _ 1-i _ 1,x _ 2-i _ 2,\cdots,x _ k-i _ k}<br>$$</p>
<p>对于另一种做法，就相当于对于每一维都依次求一遍前缀和，最后的到的结果是和容斥得到的结果相同的</p>
<h2 id="差分"><a href="#差分" class="headerlink" title="差分"></a>差分</h2><h3 id="一维情况-1"><a href="#一维情况-1" class="headerlink" title="一维情况"></a>一维情况</h3><p>差分是前缀和的逆运算，即如果知道 ${s_n}$，现在要还原 ${a_n}$，则有 $a_n=s_{n}-s_{n-1}$</p>
<p><del>连续情况下为微分，此处为离散微分</del></p>
<h3 id="二维情况-1"><a href="#二维情况-1" class="headerlink" title="二维情况"></a>二维情况</h3><p>实际上把前缀和的式子中的 $a$ 挪到一旁就是差分的方式了，即：</p>
<p>$$<br>\begin{aligned}<br>&amp;s_{n,m}=s_{n-1,m}+s_{n,m-1}-s_{n-1,m-1}+a_{n,m} \\<br>\Rightarrow &amp;a_{n,m}=s_{n,m}-s_{n-1,m}-s_{n,m-1}+s_{n-1,m-1}<br>\end{aligned}<br>$$</p>
<p>另一种方法：先把仅有第一维的前缀和 ${b_{n,m}}$ 求出来，即 $b_{n,m}=s_{n,m}-s_{n,m-1}$</p>
<p>然后 ${a_{n,m}}$ 就可以求了，即 $a_{n,m}=b_{n,m}-b_{n-1,m}$</p>
<h3 id="高维情况-1"><a href="#高维情况-1" class="headerlink" title="高维情况"></a>高维情况</h3><p>容斥的做法就较为简单了</p>
<p>$$<br>a_{x_1,x_2,\cdots,x_k}=\sum_{i_1=0}^{1}\sum_{i_2=0}^{1}\cdots \sum_{i_k=0}^{1} (-1)^{\left(\sum_{j=1}^{k}i_j\right)} s_{x_1-i_1,x_2-i_2,\cdots,x_k-i_k}<br>$$</p>
<p>如果用另一种方法的话，实际上每一维都从大往小枚举后做差分即可</p>
<h1 id="正整数与唯一分解定理"><a href="#正整数与唯一分解定理" class="headerlink" title="正整数与唯一分解定理"></a>正整数与唯一分解定理</h1><h2 id="正整数"><a href="#正整数" class="headerlink" title="正整数"></a>正整数</h2><p>非 $0$ 的自然数，也就是 $1,2,3,4,5,\cdots,\infty$ 这样的，记做 $\mathbb{N^{*}}$</p>
<h2 id="唯一分解定理"><a href="#唯一分解定理" class="headerlink" title="唯一分解定理"></a>唯一分解定理</h2><p>设 $\mathbb{P}$ 为全体素数的集合，其中 $p_i$ 表示第 $i$ 个素数，比如说 $p_1=2,p_2=3,p_3=5$ 之类的</p>
<p>对于任意一个正整数 $n$，存在唯一一种划分：</p>
<p>$$<br>n=\prod_{i=1}^{\infty} p_i^{k_i}<br>$$</p>
<h1 id="整除与狄利克雷卷积"><a href="#整除与狄利克雷卷积" class="headerlink" title="整除与狄利克雷卷积"></a>整除与狄利克雷卷积</h1><h2 id="整除"><a href="#整除" class="headerlink" title="整除"></a>整除</h2><p>在 $\mathbb{N^{*}}$ 上定义二元关系整除，用符号 $|$ 来表示，其定义为：</p>
<p>$$<br>a|b \Leftrightarrow a,b \in \mathbb{N^{*}} \wedge \left( \exists k \in \mathbb{N^{*}}:ka=b \right)<br>$$</p>
<h2 id="狄利克雷卷积"><a href="#狄利克雷卷积" class="headerlink" title="狄利克雷卷积"></a>狄利克雷卷积</h2><p>对于序列 ${a_n}$ 和序列 ${b_n}$，定义其狄利克雷卷积 ${c_n}$ 为：</p>
<p>$$<br>c_n=\sum_{d|n}a_db_\frac{n}{d}<br>$$</p>
<p>记做 $c=a \times b$</p>
<h1 id="zeta-times-mu-delta"><a href="#zeta-times-mu-delta" class="headerlink" title="$\zeta \times \mu=\delta$"></a>$\zeta \times \mu=\delta$</h1><h2 id="g-f-times-zeta"><a href="#g-f-times-zeta" class="headerlink" title="$g=f \times \zeta$"></a>$g=f \times \zeta$</h2><p>定义 $\zeta(n)=1$，即：</p>
<p>$$<br>g_n=\sum_{d|n}f_d<br>$$</p>
<p>换句话说就是求了一个在整除意义下的前缀和</p>
<p>考虑把它写的更好看一些，不妨把 $n$ 唯一分解定理展开，即：</p>
<p>$$<br>n=\prod_{i=1}^{\infty} p_i^{k_i}<br>$$</p>
<p>于是可以把 $n$ 看作高维度空间下的一个点，即 $(k_1,k_2,\cdots,k_{\infty})$</p>
<p>设 $d|n$，且 $d=\prod_{i=1}^{\infty}p_i^{k’_i}$，则 $d$ 应当满足 $k’_i \le k_i$</p>
<p>于是可以这么来做 $g=f \times \mu$，即（为了好看起见就加上了个 $k_\infty$，实际上不能这么写）：</p>
<p>$$<br>g _ {(k _ 1,k _ 2,\cdots,k_{\infty})}=\sum_{k’ _ 1 \le k _ 1}\sum_{k_2’ \le k_2} \cdots \sum _ {k’ _ {\infty} \le k_{\infty}} \left[d=\prod _ {i=1}^{\infty}p_i^{k’_i}\right] f_d<br>$$</p>
<p>于是就可以使用高维前缀和的做法来计算 $g$ 了</p>
<h2 id="f-g-times-mu"><a href="#f-g-times-mu" class="headerlink" title="$f = g \times \mu$"></a>$f = g \times \mu$</h2><p>如果知道 $g$，现在要还原 $f$，实际上也不难操作</p>
<p>一个比较简单的方法就是，从小到大枚举 $n$，由于 $g_n=\sum_{d|n}f_d$，所以 $f_n=g_n-\sum_{d|n \wedge d &lt; n}f_d$</p>
<p>另一个比较巧妙的方法就是求出 $\zeta$ 的逆函数，定义它为 $\mu$</p>
<p>考虑到高维差分的容斥做法：</p>
<p>$$<br>a_{x_1,x_2,\cdots,x_k}=\sum_{i_1=0}^{1}\sum_{i_2=0}^{1}\cdots \sum_{i_k=0}^{1} (-1)^{\left(\sum_{j=1}^{k}i_j\right)} s_{x_1-i_1,x_2-i_2,\cdots,x_k-i_k}<br>$$</p>
<p>那么 $\mu$ 就是 $(-1)^{\left(\sum_{j=1}^{k}i_j\right)}$</p>
<p>设 $n=\prod_{i=1}^{\infty}p_i^{k_i}$，现在要求出 $\mu(n)$</p>
<p>考虑到 $0 \le k_i \le 1$，因此 $n$ 应无大于 $1$ 的完全平方因子，且如果 $n$ 能写做 $k$ 个不同的素数的乘积的话，则 $\mu(n)=(-1)^{k}$</p>
<h2 id="zeta-times-mu-delta-1"><a href="#zeta-times-mu-delta-1" class="headerlink" title="$\zeta \times \mu=\delta$"></a>$\zeta \times \mu=\delta$</h2><p>定义 $\delta(n)=[n=1]$，也就是单位函数，换而言之 $f \times \delta=f$</p>
<p>考虑到 $\zeta$ 表示前缀和，$\mu$ 表示差分，那么 $f$ 依次作用上这两个函数，就相当于没有进行作用</p>
<p>即 $f \times \zeta \times \mu=f \times (\zeta \times \mu)=f \times \delta=f$</p>
<h1 id="后话"><a href="#后话" class="headerlink" title="后话"></a>后话</h1><p>一个有趣的题：<a target="_blank" rel="noopener" href="https://loj.ac/problem/6627">loj #6627. 等比数列三角形</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/03/partialsum-to-mobiusinversion/partialsum-to-mobiusinversion/" data-id="ckqmfus9h00438ufyhy1kbq4y" data-title="从前缀和到莫比乌斯反演" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" rel="tag">前缀和与差分</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-eoj-840/eoj-840" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/05/06/eoj-840/eoj-840/" class="article-date">
  <time class="dt-published" datetime="2019-05-06T00:54:06.000Z" itemprop="datePublished">2019-05-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/math/">math</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/05/06/eoj-840/eoj-840/">【eoj 840】反向出题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=766287&height=66"></iframe>

<h1 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h1><p>$$<br>\sum_{\gcd(d,n)=1}\gcd(d-1,n)=\sigma_0(n) \cdot \phi(n)<br>$$</p>
<h1 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h1><p><a target="_blank" rel="noopener" href="http://oeis.org/A062355">A062355</a></p>
<p>设 $S=\{0,1,2,\cdots,n-1\}$</p>
<p>构造 $\phi(n)$ 个映射，即 $\forall \gcd(\gamma,n)=1$，有映射 $f_{\gamma}(y)=(\gamma \cdot y)\bmod n$，显然它是一个满射且是单射，于是它是一个双射，也就构成置换</p>
<p>考虑 $y_1,y_2$ 处于一个轨道中的情况：$\exists \gcd(\gamma,n)=1,f_{\gamma}(y_1) \equiv y_2 \pmod {n}$</p>
<p>即：$\gamma \cdot y_1 \equiv y_2 \pmod {n}$</p>
<p>于是 $y_1,y_2$ 在一个轨道的条件是 $\gcd(n,y_1)=\gcd(n,y_2)$</p>
<p>于是就一共有 $\sigma_0(n)$ 个轨道</p>
<p>由 <code>burnside 引理</code> 可以得知：</p>
<p>$$<br>\begin{split}<br>|X/G|&amp;=\frac 1{|G|}\sum_{g\in G}|x^g| \\<br>等价类个数&amp;=不动元个数的平均数<br>\end{split}<br>$$</p>
<p>在置换 $f_{\gamma}$ 下，不动点为 $\gamma \cdot x \equiv x \pmod{n}$，即 $(\gamma - 1)x \equiv 0 \pmod {n}$，一共有 $\frac{n}{\gcd(\gamma - 1, n)}$ 个</p>
<p>即：</p>
<p>$$<br>\phi(n)=\frac{1}{\sigma_0(n)}\sum_{\gcd(d,n)=1} \gcd(d - 1,n)<br>$$</p>
<p>即：</p>
<p>$$<br>\sum_{\gcd(d,n)=1}\gcd(d-1,n)=\phi(n) \cdot \sigma_0(n)<br>$$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/05/06/eoj-840/eoj-840/" data-id="ckqmfus8l001u8ufy2p0w8ixo" data-title="【eoj 840】反向出题" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BE%A4%E8%AE%BA/" rel="tag">群论</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-yi-ge-qi-miao-de-fwt-gou-zao/yi-ge-qi-miao-de-fwt-gou-zao" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/29/yi-ge-qi-miao-de-fwt-gou-zao/yi-ge-qi-miao-de-fwt-gou-zao/" class="article-date">
  <time class="dt-published" datetime="2019-04-29T00:32:50.000Z" itemprop="datePublished">2019-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/29/yi-ge-qi-miao-de-fwt-gou-zao/yi-ge-qi-miao-de-fwt-gou-zao/">一个奇妙的fwt构造方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=639059&height=66"></iframe>

<p>考虑一种奇妙的构造 $fwt$ 的方法</p>
<p><del>好像就是分治乘法</del></p>
<p>现在要求出 $c = a \times b$</p>
<p>不妨构造出右侧关于 $a,b$ 的直积的形式</p>
<p>比如说二进制下的不进位加法（异或）：</p>
<p>$$<br>\begin{cases}<br>c_0=a_0b_0+a_1b_1 \\<br>c_1=a_0b_1+a_1b_0<br>\end{cases}<br>$$</p>
<p>那么凑一凑后可以得到：</p>
<p>$$<br>\begin{cases}<br>d_0=c_0+c_1=(a_0+a_1)(b_0+b_1) \\<br>d_1=c_0-c_1=(a_0-a_1)(b_0-b_1)<br>\end{cases}<br>$$</p>
<p>那么就可以写一个函数，来得到 $d_0$ 和 $d_1$</p>
<p>大概长这样：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">C</span><span class="params">(ll &amp;a, ll &amp;b)</span> </span>&#123;</span><br><span class="line">    ll x[<span class="number">2</span>] = &#123; a, b &#125;;</span><br><span class="line">    a = (x[<span class="number">0</span>] + x[<span class="number">1</span>]) % mod;</span><br><span class="line">    b = (x[<span class="number">0</span>] - x[<span class="number">1</span>]) % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么逆变换也是如此编上去，也就是：</p>
<p>$$<br>\begin{cases}<br>c_0=\frac{d_0+d_1}{2} \\<br>c_1=\frac{d_0-d_1}{2}<br>\end{cases}<br>$$</p>
<p>大概长这样：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">D</span><span class="params">(ll &amp;a, ll &amp;b)</span> </span>&#123;</span><br><span class="line">    ll x[<span class="number">2</span>] = &#123; a, b &#125;;</span><br><span class="line">    a = (x[<span class="number">0</span>] + x[<span class="number">1</span>]) * inv2 % mod;</span><br><span class="line">    b = (x[<span class="number">0</span>] - x[<span class="number">1</span>]) * inv2 % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么只需要组装起来就行了：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">void</span> <span class="title">fwt</span><span class="params">(ll *a, <span class="keyword">int</span> n, T t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; i *= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>, len = i * <span class="number">2</span> ; j &lt; n ; j += len) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; i ; ++ k) &#123;</span><br><span class="line">                <span class="built_in">t</span>(a[j + k], a[j + i + k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/04/29/yi-ge-qi-miao-de-fwt-gou-zao/yi-ge-qi-miao-de-fwt-gou-zao/" data-id="ckqmfusa900668ufyc4sa22fi" data-title="一个奇妙的fwt构造方法" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fwt/" rel="tag">fwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-uoj-450/uoj-450" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/28/uoj-450/uoj-450/" class="article-date">
  <time class="dt-published" datetime="2019-04-28T13:32:57.000Z" itemprop="datePublished">2019-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/28/uoj-450/uoj-450/">【集训队作业2018】复读机</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=27902380&height=66"></iframe>

<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p>群里有 $k$ 个不同的复读机</p>
<p>为了庆祝平安夜的到来，在接下来的 $n$ 秒内，它们每秒钟都会选出一位优秀的复读机进行复读</p>
<p>非常滑稽的是，一个复读机只有总共复读了 $d$ 的倍数次才会感到快乐</p>
<p>问有多少种不同的安排方式使得所有的复读机都感到快乐</p>
<p>其中 $1 \le n \le 10^9, 1 \le k \le 500000, 1 \le d \le 3$，答案模 $19491001$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p><del>说到 19491001，我就想起了 19 学竞赛，49 入国军</del></p>
<p>若 $d=1$，则答案就是：</p>
<p>$$<br>k^n<br>$$</p>
<p>若 $d=2$，则答案就是：</p>
<p>$$<br>\begin{aligned}<br> &amp;\left( \sum_{i \ge 0} [2|i] \frac{x^i}{i!} \right)^k[x^n]n! \\<br>=&amp;\left( \frac{e^x+e^{-x}}{2} \right)^k[x^n]n! \\<br>=&amp;\sum_{i=0}^{k} {k \choose i} \frac{1}{2^k} e^{xi-x(k-i)}[x^n]n! \\<br>=&amp;\sum_{i=0}^{k} {k \choose i} \frac{1}{2^k} e^{x(2i-k)}[x^n]n! \\<br>=&amp;\sum_{i=0}^{k} {k \choose i} \frac{(2i-k)^{n}}{2^k}<br>\end{aligned}<br>$$</p>
<p>若 $d=3$，则答案就是：</p>
<p>$$<br>\begin{aligned}<br> &amp;\left( \sum_{i \ge 0} [3|i] \frac{x^i}{i!} \right)^k[x^n]n! \\<br>=&amp;\left( \frac{1}{3}\sum_{i \ge 0} \frac{x^i}{i!} \sum_{j=0}^{2}\omega_3^{ij} \right)^k[x^n]n! \\<br>=&amp;\left( \frac{1}{3}\sum_{i \ge 0} \frac{x^i+(x\omega_3)^i+(x\omega_3^2)^i}{i!} \right)^k[x^n]n! \\<br>=&amp;\left(\frac{e^x+e^{\omega_3x}+e^{\omega_3^2x}}{3}\right)^k [x^n]n! \\<br>=&amp;\frac{1}{3^k}\sum_{i+j \le k} {k \choose i} {k-i \choose j} e^{xi+x\omega_3j+x\omega_3^2(k-i-j)} [x^n]n! \\<br>=&amp;\frac{1}{3^k}\sum_{i+j \le k} {k \choose i} {k-i \choose j} (i+\omega_3j+\omega_3^2(k-i-j))^n \\<br>\end{aligned}<br>$$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/04/28/uoj-450/uoj-450/" data-id="ckqmfusa800628ufy3rxwguck" data-title="【集训队作业2018】复读机" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" rel="tag">单位根</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" rel="tag">单位根反演</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%8D%E6%95%B0/" rel="tag">复数</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-uoj-272/uoj-272" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/28/uoj-272/uoj-272/" class="article-date">
  <time class="dt-published" datetime="2019-04-28T12:14:06.000Z" itemprop="datePublished">2019-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/28/uoj-272/uoj-272/">【清华集训2016】石家庄的工人阶级队伍比较坚强</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=448388007&height=66"></iframe>

<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p><a target="_blank" rel="noopener" href="http://uoj.ac/problem/272">太长了，略</a></p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p><del>OI中最恶心的两件事：常系数齐次线性递推（手玩多项式除法）和低进制卷积（手玩转移矩阵和求其逆矩阵）</del></p>
<p>考虑构造三进制下不进位加法的卷积</p>
<p>也就是构造映射 $f$，满足对于每一列有 $x_ix_j=x_{i \oplus j}$</p>
<p>同时要求每一列的 $x_i$，应该是 $\omega_{\tau_i}^{\lambda_{i,j}}$</p>
<p>首先有：</p>
<p>$$<br>\begin{cases}<br>\tau_0=1 \\<br>\tau_1=3 \\<br>\tau_2=3 \\<br>\end{cases}<br>$$</p>
<p>即 $f$ 实际上是：</p>
<p>$$<br>\begin{pmatrix}<br>1 &amp; \omega_3^{y_0} &amp; \omega_3^{z_0} \\<br>1 &amp; \omega_3^{y_1} &amp; \omega_3^{z_1} \\<br>1 &amp; \omega_3^{y_2} &amp; \omega_3^{z_2} \\<br>\end{pmatrix}<br>$$</p>
<p>需要满足：</p>
<p>$$<br>\begin{cases}<br>y_0+y_0=y_0 \\<br>y_0+y_1=y_1 \\<br>y_0+y_2=y_2 \\<br>y_1+y_1=y_2 \\<br>y_1+y_2=y_0 \\<br>y_2+y_2=y_1<br>\end{cases}<br>$$</p>
<p>显然 $z$ 和 $y$ 的情况是一样的，同时要求列向量线性无关，那么一组合法解就是：</p>
<p>$$<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 1 \\<br>1 &amp; \omega_3 &amp; \omega_3^{2} \\<br>1 &amp; \omega_3^{2} &amp; \omega_3 \\<br>\end{pmatrix}<br>$$</p>
<p>同时有等式 $\omega_3^2+\omega+1=0$</p>
<p>那么可以扩域到 $\mathbb{Z}[\omega]$，也就是用 $a+b\omega$ 来表示所有的数</p>
<p>考虑求这个矩阵的逆矩阵，通过单位根横等式，有：</p>
<p>$$<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 1 \\<br>1 &amp; \omega_3 &amp; \omega_3^{2} \\<br>1 &amp; \omega_3^{2} &amp; \omega_3 \\<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 1 \\<br>1 &amp; \omega_3^2 &amp; \omega_3 \\<br>1 &amp; \omega_3 &amp; \omega_3^2 \\<br>\end{pmatrix}<br>=<br>3<br>\begin{pmatrix}<br>1 &amp; 0 &amp; 0 \\<br>0 &amp; 1 &amp; 0 \\<br>0 &amp; 0 &amp; 1 \\<br>\end{pmatrix}<br>$$</p>
<p>那么逆矩阵就是：</p>
<p>$$<br>\frac{1}{3}<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 1 \\<br>1 &amp; \omega_3^2 &amp; \omega_3 \\<br>1 &amp; \omega_3 &amp; \omega_3^2 \\<br>\end{pmatrix}<br>$$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/04/28/uoj-272/uoj-272/" data-id="ckqmfusa4005r8ufy639w579b" data-title="【清华集训2016】石家庄的工人阶级队伍比较坚强" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fwt/" rel="tag">fwt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/2021/">2021</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/demo/">demo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/develop/">develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mess/">mess</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/solution/">solution</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/travel/">travel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/">文化课</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2021/" rel="tag">2021</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/51nod/" rel="tag">51nod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HEOI2019/" rel="tag">HEOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NOI2019/" rel="tag">NOI2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ODT/" rel="tag">ODT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ST%E8%A1%A8/" rel="tag">ST表</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atcoder/" rel="tag">atcoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bzoj/" rel="tag">bzoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeforces/" rel="tag">codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dinic/" rel="tag">dinic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/excrt/" rel="tag">excrt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exgcd/" rel="tag">exgcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ezoj/" rel="tag">ezoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fwt/" rel="tag">fwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gcd/" rel="tag">gcd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdu/" rel="tag">hdu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kdtree/" rel="tag">kdtree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" rel="tag">kruskal重构树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loj/" rel="tag">loj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/" rel="tag">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/noip/" rel="tag">noip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powerful-number/" rel="tag">powerful number</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prufer%E5%BA%8F%E5%88%97/" rel="tag">prufer序列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spoj/" rel="tag">spoj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie/" rel="tag">trie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" rel="tag">三元环</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" rel="tag">三角换元</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" rel="tag">二进制分组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" rel="tag">信息学竞赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%B8%E5%8C%85/" rel="tag">凸包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BD%E6%95%B0/" rel="tag">函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%9D%97/" rel="tag">分块</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" rel="tag">前缀和</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" rel="tag">前缀和与差分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" rel="tag">单位根</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" rel="tag">单位根反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E6%BC%94/" rel="tag">反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E6%95%B0/" rel="tag">复数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" rel="tag">多边形</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" rel="tag">多项式乘法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%97%E8%B7%AF/" rel="tag">套路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" rel="tag">定期重构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" rel="tag">定积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%B9%E6%8B%8D/" rel="tag">对拍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">广义后缀自动机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" rel="tag">循环矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" rel="tag">微分方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" rel="tag">微机学考</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" rel="tag">微积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" rel="tag">快速幂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%9F%E9%98%B5/" rel="tag">拟阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%88%97/" rel="tag">排列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" rel="tag">整体二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" rel="tag">文化课</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" rel="tag">斜率优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" rel="tag">斯特林数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" rel="tag">最小乘积问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%9F%E6%9C%9B/" rel="tag">期望</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" rel="tag">杜教筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" rel="tag">杜教筛习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%81%E9%99%90/" rel="tag">极限</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E7%8E%87/" rel="tag">概率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1/" rel="tag">模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" rel="tag">模拟赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" rel="tag">模拟退火</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E8%AE%B0/" rel="tag">游记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" rel="tag">特征方程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag">生成函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" rel="tag">矩阵树定理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E5%88%86/" rel="tag">积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" rel="tag">积性函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" rel="tag">笛卡尔树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" rel="tag">类欧几里得</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" rel="tag">线性变换</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" rel="tag">线性变换与矩阵递推习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" rel="tag">线性筛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%A9%E6%94%BE/" rel="tag">缩放</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">网络流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%A4%E8%AE%BA/" rel="tag">群论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85/" rel="tag">背包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" rel="tag">莫比乌斯反演习题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" rel="tag">计算几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E6%8E%A8/" rel="tag">递推</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E6%8E%A5/" rel="tag">链接</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" rel="tag">随机化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" rel="tag">非旋转平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/2021/" style="font-size: 10px;">2021</a> <a href="/tags/51nod/" style="font-size: 10px;">51nod</a> <a href="/tags/HEOI2019/" style="font-size: 10px;">HEOI2019</a> <a href="/tags/NOI2019/" style="font-size: 10px;">NOI2019</a> <a href="/tags/ODT/" style="font-size: 10px;">ODT</a> <a href="/tags/ST%E8%A1%A8/" style="font-size: 10px;">ST表</a> <a href="/tags/atcoder/" style="font-size: 10px;">atcoder</a> <a href="/tags/bzoj/" style="font-size: 15.83px;">bzoj</a> <a href="/tags/codeforces/" style="font-size: 10px;">codeforces</a> <a href="/tags/demo/" style="font-size: 11.67px;">demo</a> <a href="/tags/dinic/" style="font-size: 10px;">dinic</a> <a href="/tags/excrt/" style="font-size: 10px;">excrt</a> <a href="/tags/exgcd/" style="font-size: 10px;">exgcd</a> <a href="/tags/ezoj/" style="font-size: 10.83px;">ezoj</a> <a href="/tags/fwt/" style="font-size: 11.67px;">fwt</a> <a href="/tags/gcd/" style="font-size: 10px;">gcd</a> <a href="/tags/hdu/" style="font-size: 11.67px;">hdu</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/kdtree/" style="font-size: 10px;">kdtree</a> <a href="/tags/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" style="font-size: 10px;">kruskal重构树</a> <a href="/tags/loj/" style="font-size: 10.83px;">loj</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/noip/" style="font-size: 11.67px;">noip</a> <a href="/tags/powerful-number/" style="font-size: 10px;">powerful number</a> <a href="/tags/prufer%E5%BA%8F%E5%88%97/" style="font-size: 10px;">prufer序列</a> <a href="/tags/spoj/" style="font-size: 10px;">spoj</a> <a href="/tags/trie/" style="font-size: 10px;">trie</a> <a href="/tags/%E4%B8%89%E5%85%83%E7%8E%AF/" style="font-size: 10px;">三元环</a> <a href="/tags/%E4%B8%89%E8%A7%92%E6%8D%A2%E5%85%83/" style="font-size: 10px;">三角换元</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/" style="font-size: 10px;">二进制分组</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%AB%9E%E8%B5%9B/" style="font-size: 10px;">信息学竞赛</a> <a href="/tags/%E5%87%B8%E5%8C%85/" style="font-size: 10px;">凸包</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 10px;">函数</a> <a href="/tags/%E5%88%86%E5%9D%97/" style="font-size: 10px;">分块</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" style="font-size: 10px;">前缀和</a> <a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C%E4%B8%8E%E5%B7%AE%E5%88%86/" style="font-size: 10px;">前缀和与差分</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9/" style="font-size: 11.67px;">单位根</a> <a href="/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/" style="font-size: 10.83px;">单位根反演</a> <a href="/tags/%E5%8F%8D%E6%BC%94/" style="font-size: 10px;">反演</a> <a href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">后缀自动机</a> <a href="/tags/%E5%A4%8D%E6%95%B0/" style="font-size: 10.83px;">复数</a> <a href="/tags/%E5%A4%9A%E8%BE%B9%E5%BD%A2/" style="font-size: 10px;">多边形</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size: 12.5px;">多项式</a> <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95/" style="font-size: 10px;">多项式乘法</a> <a href="/tags/%E5%A5%97%E8%B7%AF/" style="font-size: 10px;">套路</a> <a href="/tags/%E5%AE%9A%E6%9C%9F%E9%87%8D%E6%9E%84/" style="font-size: 10px;">定期重构</a> <a href="/tags/%E5%AE%9A%E7%A7%AF%E5%88%86/" style="font-size: 10px;">定积分</a> <a href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" style="font-size: 10.83px;">容斥原理</a> <a href="/tags/%E5%AF%B9%E6%8B%8D/" style="font-size: 10px;">对拍</a> <a href="/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 12.5px;">平衡树</a> <a href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">广义后缀自动机</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 10px;">开发</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">循环矩阵</a> <a href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">微分方程</a> <a href="/tags/%E5%BE%AE%E6%9C%BA%E5%AD%A6%E8%80%83/" style="font-size: 10px;">微机学考</a> <a href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" style="font-size: 11.67px;">微积分</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" style="font-size: 10px;">快速幂</a> <a href="/tags/%E6%8B%9F%E9%98%B5/" style="font-size: 10px;">拟阵</a> <a href="/tags/%E6%8E%92%E5%88%97/" style="font-size: 10px;">排列</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 20px;">数学</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 17.5px;">数论</a> <a href="/tags/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/" style="font-size: 10px;">整体二分</a> <a href="/tags/%E6%96%87%E5%8C%96%E8%AF%BE/" style="font-size: 10px;">文化课</a> <a href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" style="font-size: 10px;">斜率优化</a> <a href="/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/" style="font-size: 10.83px;">斯特林数</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E4%B9%98%E7%A7%AF%E9%97%AE%E9%A2%98/" style="font-size: 10px;">最小乘积问题</a> <a href="/tags/%E6%9C%9F%E6%9C%9B/" style="font-size: 10px;">期望</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/" style="font-size: 13.33px;">杜教筛</a> <a href="/tags/%E6%9D%9C%E6%95%99%E7%AD%9B%E4%B9%A0%E9%A2%98/" style="font-size: 12.5px;">杜教筛习题</a> <a href="/tags/%E6%9E%81%E9%99%90/" style="font-size: 10px;">极限</a> <a href="/tags/%E6%A6%82%E7%8E%87/" style="font-size: 11.67px;">概率</a> <a href="/tags/%E6%A8%A1/" style="font-size: 10px;">模</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" style="font-size: 10px;">模拟赛</a> <a href="/tags/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB/" style="font-size: 10px;">模拟退火</a> <a href="/tags/%E6%B8%B8%E8%AE%B0/" style="font-size: 10.83px;">游记</a> <a href="/tags/%E7%89%B9%E5%BE%81%E6%96%B9%E7%A8%8B/" style="font-size: 10px;">特征方程</a> <a href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" style="font-size: 10.83px;">生成函数</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 14.17px;">矩阵</a> <a href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" style="font-size: 10px;">矩阵树定理</a> <a href="/tags/%E7%A7%AF%E5%88%86/" style="font-size: 10px;">积分</a> <a href="/tags/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/" style="font-size: 10px;">积性函数</a> <a href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/" style="font-size: 10px;">笛卡尔树</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 19.17px;">算法</a> <a href="/tags/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/" style="font-size: 10.83px;">类欧几里得</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/" style="font-size: 14.17px;">线性变换</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E4%B8%8E%E7%9F%A9%E9%98%B5%E9%80%92%E6%8E%A8%E4%B9%A0%E9%A2%98/" style="font-size: 13.33px;">线性变换与矩阵递推习题</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/" style="font-size: 10px;">线性筛</a> <a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size: 10.83px;">组合数学</a> <a href="/tags/%E7%BC%A9%E6%94%BE/" style="font-size: 10px;">缩放</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size: 10px;">网络流</a> <a href="/tags/%E7%BE%A4%E8%AE%BA/" style="font-size: 10px;">群论</a> <a href="/tags/%E8%83%8C%E5%8C%85/" style="font-size: 10px;">背包</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" style="font-size: 16.67px;">莫比乌斯反演</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E4%B9%A0%E9%A2%98/" style="font-size: 15px;">莫比乌斯反演习题</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size: 10px;">计算几何</a> <a href="/tags/%E9%80%92%E6%8E%A8/" style="font-size: 14.17px;">递推</a> <a href="/tags/%E9%93%BE%E6%8E%A5/" style="font-size: 10px;">链接</a> <a href="/tags/%E9%9A%8F%E6%9C%BA%E5%8C%96/" style="font-size: 10px;">随机化</a> <a href="/tags/%E9%9D%9E%E6%97%8B%E8%BD%AC%E5%B9%B3%E8%A1%A1%E6%A0%91/" style="font-size: 10px;">非旋转平衡树</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 18.33px;">题解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/09/">September 2000</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/06/15/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/02/24/hexo-fea-bg/">hexo:不是bug是feature</a>
          </li>
        
          <li>
            <a href="/2021/01/01/hello-2021/">2021</a>
          </li>
        
          <li>
            <a href="/2020/08/06/net-flow/net-flow/">网络流</a>
          </li>
        
          <li>
            <a href="/2020/08/06/zheng-ti-er-fen/zheng-ti-er-fen/">整体二分</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>