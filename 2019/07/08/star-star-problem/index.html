<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>OI中的**题 | nekko</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="算法," />
  

  <meta name="description" content="简介准确的说，杂题整理…… 一些闪耀着光芒的题 「codechef JULY19B GUESSPRM」Guess the Prime!题目描述$Shef$ 选了 $2$ 到 $10^9$ 之间的一个素数 $P$，要你猜它 在你给出你的猜测之前，你可以问 $Shef$ 最多 $2$ 个问题 在每个问题中，你给 $Shef$ 一个整数 $x(1 \le x \le 10^9)$，然后 $Shef$">
<meta property="og:type" content="article">
<meta property="og:title" content="OI中的**题">
<meta property="og:url" content="https://kignsann.github.io/2019/07/08/star-star-problem/index.html">
<meta property="og:site_name" content="nekko">
<meta property="og:description" content="简介准确的说，杂题整理…… 一些闪耀着光芒的题 「codechef JULY19B GUESSPRM」Guess the Prime!题目描述$Shef$ 选了 $2$ 到 $10^9$ 之间的一个素数 $P$，要你猜它 在你给出你的猜测之前，你可以问 $Shef$ 最多 $2$ 个问题 在每个问题中，你给 $Shef$ 一个整数 $x(1 \le x \le 10^9)$，然后 $Shef$">
<meta property="og:locale">
<meta property="article:published_time" content="2019-07-08T02:26:04.000Z">
<meta property="article:modified_time" content="2019-07-12T13:42:34.000Z">
<meta property="article:author" content="nekko">
<meta property="article:tag" content="算法">
<meta name="twitter:card" content="summary">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    
<link rel="stylesheet" href="/css/personal-style.css">

  

  

  

  


  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8Ccodechef-JULY19B-GUESSPRM%E3%80%8DGuess-the-Prime"><span class="toc-text">「codechef JULY19B GUESSPRM」Guess the Prime!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8CBJOI2014%E3%80%8D%E6%83%B3%E6%B3%95"><span class="toc-text">「BJOI2014」想法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-1"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD-2017-Day11%E3%80%8DPATH"><span class="toc-text">「雅礼集训 2017 Day11」PATH</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-2"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD-2018-Day4%E3%80%8DCube"><span class="toc-text">「雅礼集训 2018 Day4」Cube</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-3"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#EntropyIncreaser-%E4%B8%8E-Minecraft"><span class="toc-text">EntropyIncreaser 与 Minecraft</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-4"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-4"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%83%A0%E5%92%8C%E6%83%A0%E6%83%A0%E5%92%8C%E6%83%A0%E6%83%A0%E6%83%A0"><span class="toc-text">惠和惠惠和惠惠惠</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-5"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-5"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD-2018-Day4%E3%80%8DDivide"><span class="toc-text">「雅礼集训 2018 Day4」Divide</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8CWannafly%E6%8C%91%E6%88%98%E8%B5%9B26%E3%80%8Dmsc%E7%9A%84%E6%A3%8B%E7%9B%98"><span class="toc-text">「Wannafly挑战赛26」msc的棋盘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-6"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-6"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD-2017-Day11%E3%80%8DDIV"><span class="toc-text">「雅礼集训 2017 Day11」DIV</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-7"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-7"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD-2018-Day10%E3%80%8D%E6%96%87%E6%98%8E"><span class="toc-text">「雅礼集训 2018 Day10」文明</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-8"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-8"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8C20190710%E3%80%8D%E6%8A%BD%E5%8D%A1"><span class="toc-text">「20190710」抽卡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-9"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-9"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8Ccodechef-JULY19B-MXMN%E3%80%8DMaximum-and-Minimum"><span class="toc-text">「codechef JULY19B MXMN」Maximum and Minimum</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-10"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-10"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#henry-y-%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">henry_y 的函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-11"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-11"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A2%A6%E4%B8%AD%E7%9A%84%E6%95%B0%E8%AE%BA"><span class="toc-text">梦中的数论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-12"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-12"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Check-Check-Check-one-two"><span class="toc-text">Check,Check,Check one two!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-13"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-13"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B1%E4%BB%B7%E5%A4%A7%E7%88%B7%E6%B8%B8%E9%95%BF%E6%B2%99"><span class="toc-text">共价大爷游长沙</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-14"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-14"><span class="toc-text">社论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%8CNOI2014%E3%80%8D%E9%AD%94%E6%B3%95%E6%A3%AE%E6%9E%97"><span class="toc-text">「NOI2014」魔法森林</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-15"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E8%AE%BA-15"><span class="toc-text">社论</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-star-star-problem" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">OI中的**题</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.07.08</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>nekko</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=825646&height=66"></iframe>

<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>准确的说，杂题整理……</p>
<p><del>一些闪耀着光芒的题</del></p>
<h1 id="「codechef-JULY19B-GUESSPRM」Guess-the-Prime"><a href="#「codechef-JULY19B-GUESSPRM」Guess-the-Prime" class="headerlink" title="「codechef JULY19B GUESSPRM」Guess the Prime!"></a><a target="_blank" rel="noopener" href="https://www.codechef.com/JULY19B/problems/GUESSPRM">「codechef JULY19B GUESSPRM」Guess the Prime!</a></h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>$Shef$ 选了 $2$ 到 $10^9$ 之间的一个素数 $P$，要你猜它</p>
<p>在你给出你的猜测之前，你可以问 $Shef$ 最多 $2$ 个问题</p>
<p>在每个问题中，你给 $Shef$ 一个整数 $x(1 \le x \le 10^9)$，然后 $Shef$ 会告诉你 $x^2 \bmod P$ 的值</p>
<p>然后，你开始猜 $Shef$ 的素数 $P$，他会告诉你你的猜测是否正确</p>
<p>然而，$Shef$ 有时会作弊：他可以在任意时候改变他选定的素数（即使在你告诉他你的猜测之后），但他会保证改变后他之前对你问的所有问题的回答都还是正确的</p>
<p>向 $Shef$ 展示你总能猜到正确的素数的能力，即使他试图作弊！</p>
<h2 id="社论"><a href="#社论" class="headerlink" title="社论"></a>社论</h2><p><del>eoj猜个p加强版</del></p>
<p><del>你可以假设他不会变自己的素数</del></p>
<p>找两个数字 $x,y$，然后分别求出来 $a=x^2 \bmod p,b=y^2 \bmod p$</p>
<p>考虑 $\gcd(x^2-a,y^2-b)=kp$，那么分解质因数，依次判断是否满足 $x^2 \bmod p’=a,y^2 \bmod p’=b$</p>
<p><del>随便生成一些 $x,y$，本机拍拍就出来了</del></p>
<h1 id="「BJOI2014」想法"><a href="#「BJOI2014」想法" class="headerlink" title="「BJOI2014」想法"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2229">「BJOI2014」想法</a></h1><h2 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h2><p>小强和阿米巴是好朋友。小强要出一套题目。</p>
<p>他的题目以涉及面广（偏）、考察深入（怪）、思维强度大（难）著称。他为了出题，一共攒了 $M$ 个本质不同的想法，每个想法形成了一个题目。不过，他觉得拿这些题目去考察选手会把比赛搞的太过变态，所以，想请阿米巴来帮忙调整一下他的题目。</p>
<p>阿米巴指出，为了让一场考试的题目的考察点尽量全面，有一个通用的做法叫做「组合」。如果把两个题目 $A$ 和 $B$ 组合在一起，那么组合而成的题目涉及到的想法的集合就是 $A$ 涉及到的想法的集合和 $B$ 涉及到的想法的集合的并。</p>
<p>并且，题目是可以反复组合的。  </p>
<p>例如，小强现在有三个想法 $1,2,3$，分别对应了题目 $P_1,P_2,P_3$。  </p>
<p>现在，小强把 $P_1$ 和 $P_2$ 组合得到 $P_4$。$P_4$ 涉及的想法的集合是 ${1,2}$。  </p>
<p>之后，小强把 $P_2$ 和 $P_3$ 组合得到 $P_5$。$P_5$ 涉及的想法的集合是 ${2,3}$。  </p>
<p>最后，小强把 $P_4$ 和 $P_5$ 组合得到 $P_6$。$P_6$ 涉及的想法的集合是 ${1,2,3}$。  </p>
<p>现在，小强告诉你每个题目都是如何组合而来的。你要回答的就是，每个题目涉及的想法的集合有多大。</p>
<p>不过，这个问题是很难的。于是，你只需要能够以比较高的概率回答的比较准确即可。</p>
<blockquote>
<p>第一行两个整数 $N$，$M$，依次表示小强的题目数量和想法的数量。  </p>
<p>接下来 $N-M$ 行，每行两个整数，依次表示小强组合出来的题目都是由哪两个题组合而成的。$M$ 个想法对应的题目依次编号为 $1 \sim M$。之后，小强组合出来的第一个题编号为 $M+1$，组合出来的第二个题编号为 $M+2$，依次类推。</p>
</blockquote>
<blockquote>
<p>输出 $N-M$ 行，每行一个整数表示小强组合出来的每个题都涉及了几个想法。</p>
</blockquote>
<blockquote>
<p> 对于所有数据，$M \leq 10^5,\ N \leq 10^6$。</p>
</blockquote>
<blockquote>
<p> 对于每个输出文件，如果其中你有 $95%$ 以上的行的答案和正确答案的误差不超过 $25%$，那么你就可以得到分数。所谓误差不超过 $25%$，即，如果正确答案是 $X$，那么你的答案在 $[0.8X,1.25X]$ 这个闭区间内。</p>
</blockquote>
<h2 id="社论-1"><a href="#社论-1" class="headerlink" title="社论"></a>社论</h2><p><del>为什么省选会有这种题啊</del></p>
<p>考虑到不需要求出正确答案，近似的就好</p>
<p>一个引理：</p>
<blockquote>
<p>在 $[0,1]$ 随机选 $n$ 个实数，第 $k$ 小的期望值是 $\frac{k}{n+1}$</p>
</blockquote>
<p>考虑把每个 $1 \sim m$ 的题都打上一个随机权，这样对每个题都有一个它所包含的集合的最小值</p>
<p>设值域为 $D$，最小值为 $e$，则 $\frac{D}{n+1}=e$，也就是 $n=\frac{D}{e}-1$</p>
<p>这个 $e$ 可以多跑几次取平均值</p>
<h1 id="「雅礼集训-2017-Day11」PATH"><a href="#「雅礼集训-2017-Day11」PATH" class="headerlink" title="「雅礼集训 2017 Day11」PATH"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6051">「雅礼集训 2017 Day11」PATH</a></h1><h2 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 $ n $ 和 $ {a_i} $，满足 $ a_0 \geq a_1 \geq \cdots \geq a_{n - 1} \geq 0 $</p>
<p>求出在 $ n $ 维空间中从 $ (0, 0, \ldots, 0) $ 走到 $ (a_0, a_1, \ldots, a_{n - 1}) $，每一步使某一维坐标增加 $ 1 $ 的方案中随机选出一种</p>
<p>满足经过的所有点 $ (x_0, x_1, \ldots, x_{n - 1}) $ 都满足 $ x_0 \geq x_1 \geq \cdots \geq x_{n - 1} $ 的概率</p>
<p>答案模 $ 1004535809 $ 输出，其中 $n,a_i \le 500000$</p>
<h2 id="社论-2"><a href="#社论-2" class="headerlink" title="社论"></a>社论</h2><p>先考虑一下分母吧，也就是有多少种随机游走的方案（注意，这里只是要求第 $i$ 维不超过 $a_i$）</p>
<p>不难发现它就是个多重集合排列（要求第 $i$ 维内部有序）</p>
<p>记 $m=\sum_{i=1}^{n}a_i$，则总方案就是：</p>
<p>$$<br>\frac{m!}{\prod_{i=1}^{n}a_i!}<br>$$</p>
<p>考虑分子，也就是合法的游走方案数</p>
<p>这玩意在二维情况下叫做卡特兰数（$x \ge y$ 的游走方案数）</p>
<p>高维情况下，可以把每一维横着画长度为 $a_i$ 的序列，然后就在这个上面走轮廓线的意思</p>
<p>如果把每个格子的访问时间写出来，就是一个标准杨表的形式，也就是相当于求 $(a_1,a_2,\cdots,a_n)$ 的本质不同标准杨表个数</p>
<p>然而上面那玩意太鬼畜了，用数学化的语言描述就是，设第 $i$ 维，值为 $j$ 的时间为 $f_{i,j}$，那么要求每一行递增（维度内有序），以及每一列递增（不同维度成单调）</p>
<p>不管怎么说还是回到了杨表计数……</p>
<p><del>感觉这玩意也只能做个求概率了……因为上面那个 $m!$ 是让你求个 $(n\cdot \max a_i)!$ 之类的鬼畜玩意……</del></p>
<p>根据钩子公式，可以得到分子的一个表达：</p>
<p>$$<br>\frac{m!}{\prod_{1 \le i,j \le n} h_{a}(i,j)}<br>$$</p>
<p>然而这个没啥用，因为它是 $n^2$ 的……</p>
<p>它的用 $a$ 表达的形式为：</p>
<p>$$<br>\frac{m!\prod_{1 \le i &lt; j \le n}((a_i-i)-(a_j-j))}{\prod_{i=1}^{n}(a_i+n-i)!}<br>$$</p>
<p>记 $b_i=a_i+n-i$，则可写作：</p>
<p>$$<br>\frac{m!\prod_{1 \le i &lt; j \le n}(b_i-b_j)}{\prod_{i=1}^{n}b_i!}<br>$$</p>
<p>把分母除下去，得：</p>
<p>$$<br>\begin{aligned}<br> &amp;\frac{\frac{m!\prod_{1 \le i &lt; j \le n}(b_i-b_j)}{\prod_{i=1}^{n}b_i!}}{\frac{m!}{\prod_{i=1}^{n}a_i!}} \\<br>=&amp;\left(\prod_{i=1}^{n}\frac{a_i!}{b_i!} \right) \left( \prod_{1 \le i &lt; j \le n}(b_i-b_j) \right)<br>\end{aligned}<br>$$</p>
<p>然后就只需要计算后面那个东西了</p>
<p>然后如果直接这么转化的话就凉了……似乎只能 $O(n\log^2n)$ 的自闭玩意做</p>
<p>还是展开比较好：</p>
<p>$$<br>\prod_{1 \le i &lt; j \le n} ((a_i-i)-(a_j-j))<br>$$</p>
<p><del>由于 $a_i \ge a_{i+1}$，因此 $(a_i-i)-(a_j-j) =(a_i-a_j)+(j-i) \ge 0$</del></p>
<p><del>也就是说这个 $i&lt;j$ 的限制是没用的……（木大木大木）</del></p>
<p><del>然后就可以忽略掉这个限制来做 $ntt$ 了</del></p>
<p><del>然而感觉这个似乎有点偏差啊……实际上最后算答案是需要枚举权值，然后得到它的出现次数，把 $x^y$ 贡献进去</del></p>
<p><del>换句话说，这个出现次数应该是模的 $\phi(p)$ 啊？</del></p>
<p><del>而且出现次数是 $n^2$ 级别的？这个模了 $p$ 后真的不会出事吗……</del></p>
<p><del>实际上系数大部分都是 $1$，因此卷积完后是 $O(n)$ 级别的……</del></p>
<p><del>也许可以证明吧</del></p>
<p>考虑到 $a_i-i$ 是不增的，也就是 $(a_i-i)-(a_j-j) \ge 0$</p>
<p>那么如果能凑出大于 $0$ 的数，当且仅当 $i&lt;j$</p>
<p>也就是直接忽略掉 $i&lt;j$ 后跑 $ntt$，然后只使用大于 $0$ 的部分即可</p>
<p><del>一个可能只有我踩到的坑点：若 $p=a \times 2^b+c$ 的话，则数组最多用到 $2^b$</del></p>
<p>这部分的实现可以先把需要用到的最小值搞出来，然后都减去这个最小值后 $ntt$，最后偏移回去即可</p>
<h1 id="「雅礼集训-2018-Day4」Cube"><a href="#「雅礼集训-2018-Day4」Cube" class="headerlink" title="「雅礼集训 2018 Day4」Cube"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6501">「雅礼集训 2018 Day4」Cube</a></h1><h2 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h2><p>众所周知，正方形有 $4$ 个点， $4$ 条边；正方体有 $8$ 个点， $12$ 条边，$6$ 个面</p>
<p>定义点为零维基础图形，线段为一维基础图形，正方形为二维基础图形，正方体为三维基础图形……</p>
<p>那么请问，一个 $n$ 维基础图形包含多少个 $m$ 维基础图形呢 $(m \leq n)$？</p>
<p>多次询问，输出对 $998244353$ 取模，其中 $T \leq 10^5, 0 \leq m \leq n \leq 10^5$</p>
<h2 id="社论-3"><a href="#社论-3" class="headerlink" title="社论"></a>社论</h2><p>考虑一下点到底是个啥东西</p>
<p>定义 $n$ 维基础图形的顶点为，$n$ 维向量中每一维是 $0/1$ 的向量集合</p>
<p>比如说正方体上的顶点就是 $(0/1,0/1,0/1)$</p>
<p>那么把点再往多扩展一下，不难发现，$m$ 维基础图形在 $n$ 维基础图形上的表现为，某些维取值相同，剩下维取值唯一（是个 $m$ 维基础图形）</p>
<p>因此答案就是 ${n \choose n-m}2^{n-m}$</p>
<h1 id="EntropyIncreaser-与-Minecraft"><a href="#EntropyIncreaser-与-Minecraft" class="headerlink" title="EntropyIncreaser 与 Minecraft"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6671">EntropyIncreaser 与 Minecraft</a></h1><h2 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h2><p>求 $\sum_{i=1}^{n}|x_i| \le p$ 的方案数，其中 $x_i \in \mathbb{Z}$，答案模 $10^9+7$，其中 $n,p \leqslant 10^6$</p>
<h2 id="社论-4"><a href="#社论-4" class="headerlink" title="社论"></a>社论</h2><p>首先枚举有多少个 $0$，那么剩下的（假设剩下了 $k$ 个数）要求它的绝对值大于 $0$，这样的话方案数就是 $2^k$</p>
<p>考虑设 $y_i=x_i+1$，其中 $x_i \ge 0$，则需要求如下方程的方案数：</p>
<p>$$<br>\sum_{i=1}^{k}y_i \le p \Rightarrow \sum_{i=1}^{k}x_i \le p-k<br>$$</p>
<p>众所周知，对于 $\sum_{i=1}^{k}x_i=p$ 的方案数为 ${k+p-1 \choose k-1}$</p>
<p>也就是说，总方案为：</p>
<p>$$<br>\sum_{k=0}^{n} {n \choose k} 2^k \sum_{i=0}^{p} {k+i-k-1 \choose k-1}<br>$$</p>
<p>注意到 $k=0$ 的时候答案是 $1$，要特殊处理一下（冒出来一个 $k-1$）</p>
<p>然后把它化简一下：</p>
<p>$$<br>\sum_{k=0}^{n} {n \choose k} 2^k \sum_{i=0}^{p-1} {i \choose k-1}<br>$$</p>
<p>注意到 $\sum_{i=0}^{n}{i \choose m}={n+1 \choose m+1}$，因此上面那个玩意就是：</p>
<p>$$<br>\sum_{k=0}^{n} {n \choose k} 2^k {p \choose k}<br>$$</p>
<p><del>好了这回就不需要特判了</del></p>
<h1 id="惠和惠惠和惠惠惠"><a href="#惠和惠惠和惠惠惠" class="headerlink" title="惠和惠惠和惠惠惠"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6672">惠和惠惠和惠惠惠</a></h1><h2 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h2><p>你在二维坐标系下，一开始你在 $(0,0)$，每次你可以使用三个方向向量之一（即 $(1,1),(1,0),(1,-1)$ 这三个），同时你只能在第一象限或坐标轴上，且在 $n$ 次操作后，你需要到达 $(n,0)$，同时要求恰好碰触 $x$ 轴 $k$ 次（包括一开始的时候和结束的时候）</p>
<p>求方案数，答案模 $998244353$，其中 $1 \le n,k \le 10^5$</p>
<h2 id="社论-5"><a href="#社论-5" class="headerlink" title="社论"></a>社论</h2><p>设 $f_{i,j}$ 表示走到了 $(i,0)$ 的方案数，不难得到 $f_{i,j}=\sum_{t=0}^{i-1}f_{t,j-1}g_{i-j}$，起始状态为 $f_{0,1}=1$，答案就是 $f_{n,k}$</p>
<p>其中 $g(n)$ 表示从 $(0,0)$ 走到 $(n,0)$，且 $k=2$ 时的方案数</p>
<blockquote>
<p>考虑另一个东西，即 $h(n)$，也就是从 $(0,0)$ 走到 $(n,0)$ 且不能走到第四象限的方案数</p>
<p>这玩意叫 <code>Motzkin numbers</code>（你并不需要知道这是什么）</p>
<p>显然有 $g(n)=h(n-2)$，因为开头和结尾必须一个往上一个往下（$n$ 比较小的时候有特例）</p>
<p>为了不重不漏的计数，那么只需要在除了 $(0,0)$ 外第一次处于 $x$ 轴的位置处计数即可</p>
<p>则有：<br>$$<br>h(n)=h(n-1)+\sum_{i=2}^{n}h(i-2)h(n-i)<br>$$<br>即：<br>$$<br>h(n)=h(n-1)+\sum_{i=0}^{n-2}h(i)h(n-2-i)<br>$$<br>生成函数为：<br>$$<br>\begin{aligned}<br> &amp;H(x)=xH(x)+x^2H^2(x)+1 \\<br>\Rightarrow  &amp;x^2H(x)^2 + (x-1)H(x)+1=0 \\<br>\Rightarrow  &amp;H(x)=\frac{(1-x) \pm \sqrt{(x-1)^2-4x^2}}{2x^2} \\<br>\Rightarrow  &amp;H(x)=\frac{(1-x) \pm \sqrt{1-2x-3x^2}}{2x^2} \\<br>\end{aligned}<br>$$<br>由于要求 $H(0)=1$，那么如果取加号，则上面为 $2$，下面为 $\infty$</p>
<p>因此取负号时，满足 $H(0)=1$</p>
</blockquote>
<p>考虑生成函数，设 $f_{*,j}=f_j(x)$，不难得到 $f_1(x)=1$</p>
<p>同时有 $f_j(x)=(x+x^2h(x)) \times f_{j-1}(x) \Rightarrow f_j(x)=(x+x^2h(x))^{j-1}$</p>
<p>由于 $h(x)=\frac{1-x-\sqrt{1-2x-3x^2}}{2x^2}$，所以：</p>
<p>$$<br>\begin{aligned}<br>f_j(x)<br>=&amp; ( x+x^2h(x) )^{j-1} \\<br>=&amp; \left(x+\frac{1-x-\sqrt{1-2x-3x^2}}{2}\right)^{j-1} \\<br>=&amp;\left( \frac{1+x-\sqrt{1-2x-3x^2}}{2} \right)^{j-1}<br>\end{aligned}<br>$$</p>
<p>多项式开根是不可能开根的，<del>这辈子都不可能多项式开根的</del></p>
<blockquote>
<p> 考虑 $H(x)=\frac{1-x-\sqrt{1-2x-3x^2}}{2x^2}$ 的形式幂级数的系数</p>
<p>存在三个一次多项式 $A(x),B(x),C(x)$，满足 $A(n)h_n=B(n-1)h_{n-1}+C(n-2)h_{n-2}$</p>
<p>而且它们的系数都不大，直接 $O(20^6)$ 暴搜即可</p>
</blockquote>
<p>显然那个系数不大的结论是在对着结论说过程，正经做法在这：<a target="_blank" rel="noopener" href="https://www.luogu.org/blog/KingSann/yi-lei-tong-guo-sheng-cheng-han-shuo-qiu-xian-xing-di-tui-shi-di-fang-post">一类通过生成函数求线性递推式的方法</a></p>
<p>这个做法目前为止的时间复杂度为 $O(m \log m+m^3+nm)$ 的</p>
<p>其中 $m=(D+1)(L+1)$，在这个数据范围下，有 $D=2, L=3$</p>
<p>所涉及的知识点：多项式初步，打表找规律（说好听点就是归纳总结），高斯消元，离线求逆元</p>
<p>算法难度：noip提高组（大雾）</p>
<p><del>并不需要 $NTT$ 等高深的多项式算法</del></p>
<p>考虑到实际上是让你求：</p>
<p>$$<br>\left( \frac{1+x-\sqrt{1-2x-3x^2}}{2} \right)^{k-1}<br>$$</p>
<p>不难发现它是一个整式递推数列</p>
<p>说人话就是，相比于线性递推数列，它前面的系数从常数扩展到了一个多项式</p>
<p>举个例子，某个整式递推数列也许长这样：</p>
<p>$$<br>A(n)f_n=B(n-1)f_{n-1}+C(n-2)f_{n-2}<br>$$</p>
<p>不妨将它一般化，假设递推长度为 $L$，系数多项式的最高次数为 $D$，则有：</p>
<p>$$<br>\sum_{i=0}^{L} \sum_{j=0}^{D} f_{n-i} (n-i)^j e_{i,j}=0<br>$$</p>
<p>$e_{i}$ 就对应着第 $i$ 个系数多项式</p>
<p>然后就可以高斯消元了，不过很可惜它是线性相关的，也就是你可能有很多解</p>
<p>不过一般来说，在这类问题中，它一定是一个基解乘以常数构成的解集</p>
<p>也就是说如果碰到了一个自由元，就随便给它赋个随机数，然后继续消元</p>
<p>注意你的目标是 $e_0$ 不是 $0$</p>
<p>然后你就可以在 $O((LD)^3)$ 的时间复杂度内搞出一组递推函数</p>
<p>之后还原这个序列的时候就这么递推过去就行了，注意到要求逆，这里可能比叫恶心</p>
<p>不过在模素数意义下，$f_n$ 前面的系数又不是 $0$，可以直接 $O(n)$ 离线求逆元</p>
<p>回到这个题，会发现这个形式幂级数会有 $k$ 个前缀 $0$，所以你得弄 $O(k)$ 项</p>
<p>同时发现这个内层多项式的常数项为 $0$，一次项系数为 $1$，也就是它是 $(xA(x))^{k-1}=x^{k-1}A(x)^{k-1}$</p>
<p>诶不过我们只需要知道非 $0$ 的递推就行了，也就是说只需要从第 $k$ 项开始跑快速幂就行了</p>
<p>换而言之这个时间复杂度是 $O(m \log m + m^3 + nm)$ 的</p>
<h1 id="「雅礼集训-2018-Day4」Divide"><a href="#「雅礼集训-2018-Day4」Divide" class="headerlink" title="「雅礼集训 2018 Day4」Divide"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6502">「雅礼集训 2018 Day4」Divide</a></h1><p>神仙题……orz <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ImagineC/p/9795041.html">ImagineC</a></p>
<p>显然跟 $w$ 的顺序无关</p>
<p>考虑把 $w$ 按照某种方式进行重新定序，然后对于 $i$，对于所有的 $1 \le j &lt; i$，要么都满足 $w_i+w_j \ge m$，要么都满足 $w_i + w_j &lt; m$</p>
<p>这样的话，就可以把 $i$ 放到 $A$ 或 $B$ 时都可以进行计算答案了</p>
<p>假设已经排好序了，设 $f_{i,j}$ 表示考虑完了前 $i$ 个人，其中 $|A|=j$ 时的最大答案（显然方案数可以在更新 $f$ 时顺便更新）</p>
<p>如果对于所有的 $1 \le j &lt; i$，都满足 $w_i+w_j \ge m$，则如果 $i$ 放到 $A$，则会对 $B$ 中所有的人产生贡献，反之亦然</p>
<p>即：</p>
<p>$$<br>f_{i,j}=\max(f_{i-1,j-1}+(i-j),f_{i-1,j}+j)<br>$$</p>
<p>否则，无论 $i$ 放到 $A$ 还是放到 $B$，则一定不会对答案产生影响，即：</p>
<p>$$<br>f_{i,j}=\max(f_{i-1,j-1},f_{i-1,j})<br>$$</p>
<p>那么剩下的问题就是如何对 $w$ 进行重新定序</p>
<p>考虑先对 $w$ 升序排序，看一下 $w_1$ 和 $w_n$ 的关系，如果 $w_1+w_n \ge m$，则对于任意的 $1 \le i &lt; n$，都有 $w_i+w_n \ge m$</p>
<p>此时把 $w_n$ 放到最终序列的末尾即可，剩下就是一个子问题 $[1,n-1]$</p>
<p>如果 $w_1+w_n &lt; m$，那么对于任意 $2 \le i \le n$，都有 $w_1+w_i &lt; m$，因此把 $w_1$ 放到序列末尾，然后递归处理 $[2,n]$ 即可</p>
<h1 id="「Wannafly挑战赛26」msc的棋盘"><a href="#「Wannafly挑战赛26」msc的棋盘" class="headerlink" title="「Wannafly挑战赛26」msc的棋盘"></a><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/212/F">「Wannafly挑战赛26」msc的棋盘</a></h1><h2 id="题目描述-6"><a href="#题目描述-6" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 ${b_{m}}$，求有多少个不同的 ${a_n}$，满足存在一个填上了一些棋子的 $n \times m$ 的网格图，满足第 $i$ 行的棋子个数为 $a_i$，第 $j$ 列的棋子个数为 $b_j$</p>
<p>答案模 $10^9+7$，其中 $n,m \le 50$</p>
<h2 id="社论-6"><a href="#社论-6" class="headerlink" title="社论"></a>社论</h2><p>好神仙的东西啊……orz <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ImagineC/p/9836056.html">ImagineC</a></p>
<p><del>网络流计数（大雾）</del></p>
<p>考虑如果给定了 ${a_n}$ 和 ${b_m}$，怎么判断这个 $n \times m$ 的棋盘是否合法</p>
<p>考虑网络流建图，源点向行连流量为 $a_i$ 的边，列向汇点连流量为 $b_i$ 的边</p>
<p>对于行 $i$ 和列 $j$，连 $i \to j$ 的流量为 $1$ 的边</p>
<p>如果最后流量为 $\sum b_{i}$，当然也应该是等于 $\sum a_i$ 的，则此棋盘合法</p>
<p>由于最大流等于最小割，只需要最小割为 $\sum b_i$ 即可</p>
<p>考虑这张网络流的图，它一共分成了四层</p>
<p>由于要求是一个割集，因此如果在 $S \to row$ 割了 $i$ 条边，且在 $column \to T$ 割了 $j$ 条边，则还需要在 $row \to column$ 中割 $(n-i)(m-j)$ 条边（因为需要 $S,T$ 不连通，且割的边的权值之和尽量小）</p>
<p>由于中间的边的权值都是 $1$，因此左右两端应该尽可能地选较小的，也就是从小到大按照权值排序后选一个前缀</p>
<p>假设 ${a_n}$ 和 ${b_m}$ 都从小往大排好序了，记前缀和分别为 $s_a,s_b$，那么最小割就是：</p>
<p>$$<br>\min_{0 \le i \le n,0 \le j \le m} s_{a_i}+s_{b_j}+(n-i)(m-j)<br>$$</p>
<p>首先它肯定能达到 $\sum b_i$ 的，因为只需要让 $i=0,j=m$ 即可</p>
<p>由于最小割是 $\sum b_i$，因此只需要对于任意的取值，让它都不低于其即可</p>
<p>也就是如果合法，当且仅当：</p>
<p>$$<br>\left( \min_{0 \le i \le n,0 \le j \le m} s_{a_i}+s_{b_j}+(n-i)(m-j) \right) \ge s_{b_m}<br>$$</p>
<p>注意到还有一个条件就是横纵的棋子个数应相等，即 $\sum a_i=\sum b_i$</p>
<p>可以先通过枚举 $i,j$，来算出 $s_{a_i}$ 的最小值</p>
<p>然后就可以 $dp$ 了，设 $f_{i,j,k}$ 表示最大值不超过 $i$ 时，已经填了 $j$ 行，已经填的 $a$ 的和是 $k$ 的方案数</p>
<p>转移则可以枚举填了多少个 $i+1$，有：</p>
<p>$$<br>f_{i,j,k} {n-j \choose t} \to f_{i+1,j+t,k+(i+1)t}<br>$$</p>
<h1 id="「雅礼集训-2017-Day11」DIV"><a href="#「雅礼集训-2017-Day11」DIV" class="headerlink" title="「雅礼集训 2017 Day11」DIV"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6052">「雅礼集训 2017 Day11」DIV</a></h1><h2 id="题目描述-7"><a href="#题目描述-7" class="headerlink" title="题目描述"></a>题目描述</h2><p>定义复数 $ a + b\text{i} $ 为整数 $ k $ 的约数，当且仅当 $ a $ 和 $ b $ 为整数且存在整数 $ c $ 和 $ d $ 满足 $ (a + b\text{i})(c + d\text{i}) = k $</p>
<p>给定 $ n $，求出 $ 1 $ 到 $ n $ 的所有满足 $ a &gt; 0 $ 的约数 $ a + b\text{i} $ 的 $ a $ 的和</p>
<p>答案模 $ 1004535809 $ 输出，其中 $n \le 10 ^ {10}$</p>
<h2 id="社论-7"><a href="#社论-7" class="headerlink" title="社论"></a>社论</h2><p>orz <a target="_blank" rel="noopener" href="https://11dimensions.moe/archives/182">11Dimensions</a></p>
<p><del>开局一个主函数，剩下函数全靠Lambda</del></p>
<p>若 $(a+bi)(c+di)=n$，则：</p>
<p>$$<br>\begin{cases}<br>ac-bd=n \\<br>ad+bc=0<br>\end{cases}<br>$$</p>
<p>对于第二个式子，即：</p>
<p>$$<br>\frac{a}{b}=-\frac{c}{d}<br>$$</p>
<p>设 $\gcd(p,q)=1$，且 $\frac{a}{b}=-\frac{c}{d}=\frac{p}{q}$，可得：</p>
<p>$$<br>(a+bi)(c+di)=b \left(\frac{p}{q}+i \right)d \left(-\frac{p}{q}+i \right)=n<br>$$</p>
<p>替换一下，可得：</p>
<p>$$<br>x(p+qi)y(p-qi)=n=xy(p^2+q^2)<br>$$</p>
<p>先考虑虚部大于 $0$ 的情况，然后枚举 $k=p^2+q^2$，记录 $xp$ 的贡献，有：</p>
<p>$$<br>\begin{aligned}<br> &amp;\sum_{k} \sum_{p^2+q^2=k\land \gcd(p,q)=1} p \sum_{k|T} \sum_{x|\frac{T}{k}} x \\<br>=&amp;\sum_{k} \sum_{p^2+q^2=k\land \gcd(p,q)=1} p \sum_{k|T} \sigma_1\left(\frac{T}{k} \right) \\<br>=&amp;\sum_{k} \sum_{p^2+q^2=k\land \gcd(p,q)=1} p \cdot \text{D}\left(\left\lfloor\frac{n}{k}\right\rfloor \right) \\<br>\end{aligned}<br>$$</p>
<p>其中 $D$ 是 $\sigma_1$ 的前缀和，即：</p>
<p>$$<br>D(n)=\sum_{i=1}^{n}\sigma_1(i)=\sum_{i=1}^{n}i \cdot \left\lfloor \frac{n}{i} \right\rfloor<br>$$</p>
<p>考虑对 $\left\lfloor \frac{n}{k} \right\rfloor$ 除法分块，然后就只需要求这个：</p>
<p>$$<br>f(k)=\sum_{p^2+q^2=k \land \gcd(p, q)=1} p<br>$$</p>
<p>设 $F(k)=\sum_{i \le k} f(i)$，再让 $G(k)$ 为不需要满足 $\gcd(p,q)=1$ 的 $F$，则：</p>
<p>$$<br>G(k)=\sum_{d \ge 1} d \cdot F\left( \left\lfloor \frac{k}{d^2} \right\rfloor \right)<br>$$</p>
<p>即：</p>
<p>$$<br>F(k)=G(k)-\sum_{d \ge 2} d \cdot F\left( \left\lfloor \frac{k}{d^2} \right\rfloor \right)<br>$$</p>
<p>同时有：</p>
<p>$$<br>G(k)=\sum_{p^2+q^2=k} p = \sum_{p=1}^{\left \lfloor \sqrt{k} \right \rfloor} p \cdot \left\lfloor \sqrt{k-p^2} \right\rfloor<br>$$</p>
<p>虚部小于 $0$ 的和上面的等价，直接乘 $2$ 即可</p>
<p>还剩下虚部为 $0$ 的情况，此时答案为：</p>
<p>$$<br>\begin{aligned}<br> &amp;\sum_{a}a \sum_{c} [ac \le i] \\<br>=&amp;\sum_{i=1}^{n}\sigma_1(i) \\<br>=&amp;\text{D}(n)<br>\end{aligned}<br>$$</p>
<h1 id="「雅礼集训-2018-Day10」文明"><a href="#「雅礼集训-2018-Day10」文明" class="headerlink" title="「雅礼集训 2018 Day10」文明"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6514">「雅礼集训 2018 Day10」文明</a></h1><h2 id="题目描述-8"><a href="#题目描述-8" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一棵树，若干次询问，每次给定 $k$ 个点 $a_1 \sim a_k$，一共会进行无限轮游戏，按照 $1 \sim k$ 的顺序进行</p>
<p>每次每个人会把当前他所在的连通块往外扩展距离 $1$，当然如果碰到其他人就不会往那里扩展</p>
<p>求 $a_1$ 最多能扩展多少，其中 $n,q \le 5 \times 10^5,1 \le k_i \le n, \sum k_i \le 10^6$</p>
<h2 id="社论-8"><a href="#社论-8" class="headerlink" title="社论"></a>社论</h2><p>显然不能达到的点构成了一些连通块（子树之类的）</p>
<p>那么对于所有的 $j \ge 2$，求一下 $a_1 \to a_j$ 的往右中点（靠 $a_j$ 的那个点）</p>
<p>然后把这些点加上 $a_1$ 建虚树，然后求一下从 $a_1$ 距离为 $1$ 的这些点，然后把它们的不靠近 $a_1$ 的子树大小之和即可</p>
<p>答案就是 $n$ 减去无法到达的连通块</p>
<p><code>auto lambda</code> 一时爽，一直这啥一直爽</p>
<p>一个很有效的常数优化：倍增数组的 <code>f[N][20]</code>，要写成 <code>f[20][N]</code>，然后就快了 $0.5s$ 了</p>
<h1 id="「20190710」抽卡"><a href="#「20190710」抽卡" class="headerlink" title="「20190710」抽卡"></a><a target="_blank" rel="noopener" href="http://192.168.14.17/problem/942">「20190710」抽卡</a></h1><h2 id="题目描述-9"><a href="#题目描述-9" class="headerlink" title="题目描述"></a>题目描述</h2><p>你在抽卡，你每次有 $p(0 &lt; p \le 1)$ 的概率抽到特殊角色，一共有 $n$ 种特殊角色</p>
<p>如果你连续 $L-1$ 次没抽到特殊角色，那么在下一次时必定抽到特殊角色</p>
<p>求抽到 $n$ 种特殊角色的期望次数（如果某次恰好凑齐了 $n$ 种，则立即停止）</p>
<p>答案模 $998244353$，其中 $1 \le n \le L &lt; 998244353$</p>
<h2 id="社论-9"><a href="#社论-9" class="headerlink" title="社论"></a>社论</h2><p><del>一场模拟赛，两个计数，一个照着结论出题，这是人干的事啊……</del></p>
<p>对于脸黑的限制，不妨枚举抽出 $i-1$ 张牌的期望次数，然后最多再抽 $L$ 次就能抽到</p>
<p>即：</p>
<p>$$<br>f_c=(1-p)^{L-1}(\frac{n-c}{n}(f_{c+1}+L)+\frac{c}{n}(f_{c}+L)) + \sum_{i=1}^{L-1} (1-p)^{i-1} p ( \frac{n-c}{n}(f_{c+1}+i) + \frac{c}{n}(f_{c}+i) )<br>$$</p>
<p>化简一下：</p>
<p>$$<br>\begin{aligned}<br>f_c =<br> &amp;(1-p)^{L-1}(\frac{n-c}{n}f_{c+1}+\frac{c}{n}f_{c}+L) \\<br>+&amp;\sum_{i=1}^{L-1}(1-p)^{i-1}p(\frac{n-c}{n}f_{c+1}+\frac{c}{n}f_c+i) \\<br>=<br> &amp;(1-p)^{L-1}(\frac{n-c}{n}f_{c+1}+L) \\<br>+&amp;(1-p)^{L-1}\frac{c}{n}f_{c} \\<br>+&amp;\left(\sum_{i=1}^{L-1}(1-p)^{i-1}p(\frac{n-c}{n}f_{c+1}+i)\right) \\<br>+&amp;\left( \sum_{i=1}^{L-1}(1-p)^{i-1}p \right)\frac{c}{n}f_c<br>\end{aligned}<br>$$</p>
<p>其中有：</p>
<p>$$<br>\sum_{i=1}^{L-1}(1-p)^{i-1}p=p\sum_{i=0}^{L-2}(1-p)^{i}=p\frac{1-(1-p)^{L-1}}{p}=1-(1-p)^{L-1}<br>$$</p>
<p>则有：</p>
<p>$$<br>(1-p)^{L-1}+1-(1-p)^{L-1}=1<br>$$</p>
<p>于是有：</p>
<p>$$<br>\begin{aligned}<br>f_c<br>=&amp;\frac{c}{n}f_c+ (1-p)^{L-1}(\frac{n-c}{n}f_{c+1}+L) + \sum_{i=1}^{L-1}(1-p)^{i-1}p(\frac{n-c}{n}f_{c+1}+i) \\<br>=&amp;\frac{(1-p)^{L-1}(\frac{n-c}{n}f_{c+1}+L) + \sum_{i=1}^{L-1}(1-p)^{i-1}p(\frac{n-c}{n}f_{c+1}+i)}{1-\frac{c}{n}} \\<br>=&amp;\frac{ (1-p)^{L-1}((n-c)f_{c+1}+nL)+\sum_{i=1}^{L-1}(1-p)^{i-1}p((n-c)f_{c+1}+ni) }{n-c}<br>\end{aligned}<br>$$</p>
<p>然后有：</p>
<p>$$<br>\begin{aligned}<br>(n-c)f_c=<br> &amp;f_{c+1}((1-p)^{L-1}(n-c)) \\<br>+&amp;(1-p)^{L-1}nL \\<br>+&amp;(n-c)pf_{c+1}\left( \sum_{i=1}^{L-1} (1-p)^{i-1}\right) \\<br>+&amp;np\left(\sum_{i=1}^{L-1}(1-p)^{i-1}i\right) \\<br>\end{aligned}<br>$$</p>
<p>然后有：</p>
<p>$$<br>\begin{aligned}<br>(n-c)f_c=<br> &amp;f_{c+1}((1-p)^{L-1}(n-c)) \\<br>+&amp;(1-p)^{L-1}nL \\<br>+&amp;(n-c)f_{c+1}\left( 1-(1-p)^{L-1} \right) \\<br>+&amp;np\left(\sum_{i=1}^{L-1}(1-p)^{i-1}i\right) \\<br>\end{aligned}<br>$$</p>
<p>然后有：</p>
<p>$$<br>\begin{aligned}<br>(n-c)f_c=<br> &amp;f_{c+1}(n-c) \\<br>+&amp;(1-p)^{L-1}nL \\<br>+&amp;np\left(\sum_{i=1}^{L-1}(1-p)^{i-1}i\right) \\<br>\end{aligned}<br>$$</p>
<p>然后有：</p>
<p>$$<br>\begin{aligned}<br>(n-c)f_c=<br> &amp;f_{c+1}(n-c) \\<br>+&amp;(1-p)^{L-1}nL \\<br>+&amp;np\left(\sum_{i=0}^{L-2}(1-p)^{i}(i+1)\right) \\<br>\end{aligned}<br>$$</p>
<p>其中：</p>
<p>$$<br>\begin{aligned}<br>&amp; S=\sum_{i=0}^{L-2}(1-p)^{i}(i+1) \\<br>\Rightarrow &amp; (1-p)S=\sum_{i=1}^{L-1}(1-p)^ii \\<br>\Rightarrow &amp; -pS= (1-p)^{L-1}(L-1)-1-\sum_{i=1}^{L-2}(1-p)^i \\<br>\Rightarrow &amp; -pS=(1-p)^{L-1}(L-1)-1-(\frac{1-(1-p)^{L-1}}{p}-1) \\<br>\Rightarrow &amp; pS=\frac{1-(1-p)^{L-1}}{p}-(1-p)^{L-1}(L-1)<br>\end{aligned}<br>$$</p>
<p>于是有：</p>
<p>$$<br>\begin{aligned}<br>&amp;T=(1-p)^{L-1}nL+n(\frac{1-(1-p)^{L-1}}{p}-(1-p)^{L-1}(L-1)) \\<br>\Rightarrow<br>&amp;(n-c)f_{c}=(n-c)f_{c+1}+T \\<br>\Rightarrow<br>&amp;f_c=f_{c+1}+\frac{T}{(n-c)} \\<br>\Rightarrow<br>&amp; f_0=\sum_{i=0}^{n-1}\frac{T}{n-i}=T\sum_{i=1}^{n}\frac{1}{i}<br>\end{aligned}<br>$$</p>
<p><del>这么大数据范围的求逆元之和，出题人可能脑子出问题了</del></p>
<p>求逆元和的话，可以先每隔 $2 \times 10^5$ 打个表，然后查询就暴力扫一遍就行了</p>
<h1 id="「codechef-JULY19B-MXMN」Maximum-and-Minimum"><a href="#「codechef-JULY19B-MXMN」Maximum-and-Minimum" class="headerlink" title="「codechef JULY19B MXMN」Maximum and Minimum"></a><a target="_blank" rel="noopener" href="https://www.codechef.com/JULY19B/problems/MXMN">「codechef JULY19B MXMN」Maximum and Minimum</a></h1><h2 id="题目描述-10"><a href="#题目描述-10" class="headerlink" title="题目描述"></a>题目描述</h2><p>大厨喜欢图论，为了表达他的热爱，他定义了函数 $f(G, x, y)$，其中 $G$ 为一个有边权的无向连通图，$x$ 和 $y$ 的图 $G$ 中的两个点</p>
<p>$f(G, x, y)$ 定义为 $G$ 中点 $x$ 和点 $y$ 之间的所有路径的权重的最小值，其中一条路径的权重定义为该路径上各边权的最大值</p>
<p>$Chef$ 有两个连通图 $G_1$ 和 $G_2$</p>
<p>他们各有 $N$ 个顶点（编号为 $1$ 到 $N$）和 $M$ 条边</p>
<p>请你计算 $S =\sum_{i=1}^{N−1}\sum_{j=i+1}^{N} f(g_1,i,j) \times f(G_2,i,j)$</p>
<p>答案对 $998244353$ 取模的结果</p>
<p>其中 $1 \le N \le 10^5, M=2N,1 \le u,v \le N, 1\ le w \le 10^8$，保证 $G_1,G_2$ 是连通图</p>
<h2 id="社论-10"><a href="#社论-10" class="headerlink" title="社论"></a>社论</h2><p><del>强行学了一波边分树合并</del></p>
<p>$kruskal$ 重构树后，贡献成了：$dis_1(i,j) \times dis_2(i,j)$，枚举第二棵树的 $lca$，考虑合并</p>
<p>考虑边分树合并，较浅的是左侧，较深的是右侧</p>
<p>因此对于左侧点，求一个到分治边的 $lca$ 的权即可</p>
<p>这样合并的贡献就是左子树求和了，记得要乘以右子树大小</p>
<p>真社论：</p>
<ol>
<li>模数是 $998244353$（就我一个用了一大堆头文件然后忘记改模数的……）</li>
<li>实际上 $kruskal$ 重构树本身就是三度化的……并不需要三度化（偷懒好啊）……</li>
<li><code>struct</code> 的函数内部 <code>static</code> 好像是只有一个的……</li>
<li><code>lambda</code> 表达式的坏处就是，如果 <code>-f</code> 了的话，根本不知道是哪里写挂了……</li>
<li>用 <code>vector</code> 有个好处就是，你知道你那里数组没开够……</li>
</ol>
<h1 id="henry-y-的函数"><a href="#henry-y-的函数" class="headerlink" title="henry_y 的函数"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6680">henry_y 的函数</a></h1><h2 id="题目描述-11"><a href="#题目描述-11" class="headerlink" title="题目描述"></a>题目描述</h2><p>某一天，你发现了一个神奇的函数 $g(x)$，它满足很多神奇的性质：</p>
<ol>
<li>$g(1)=1$</li>
<li>$g(p^c)=p \oplus c$（$p$ 为质数，$\oplus$ 表示异或）</li>
<li>$g(ab)=g(a)g(b)$（$a$ 与 $b$ 互质）</li>
</ol>
<p>设：</p>
<p>$$<br>f(n) = \left( \sum_{i = 1}^n \left\lfloor \frac ni \right\rfloor^2 g(i) \right) \bmod 998244353<br>$$</p>
<p>求出 $(f(1) \oplus f(2) \oplus \ldots \oplus f(n)) \bmod 998244353$ 的值，其中 $1 \le n \le 10^7$</p>
<h2 id="社论-11"><a href="#社论-11" class="headerlink" title="社论"></a>社论</h2><p>这题妙啊……<br>$$<br>f(n)=\sum_{i=1}^{n} \left\lfloor \frac{n}{i} \right\rfloor^2 g(i)<br>$$</p>
<p>考虑一下 $f(n-1)$  和 $f(n)$ 有什么不同</p>
<p><del>发现只有 $d|n$ 的贡献会发生改变，因为 $\gcd(n,n-1)=1$，于是非平凡因子不交</del></p>
<p>换句话说，考虑一下如果 $d|(n-1)$，则 $\left\lfloor\frac{n}{d}\right\rfloor=\frac{n-1}{d} + \left\lfloor \frac{1}{d} \right\rfloor=\frac{n-1}{d}+[d=1]$，那么它会变化，当且仅当 $d=1$</p>
<p>如果 $d \not \mid (n-1)$，则 $\left\lfloor \frac{n}{d} \right\rfloor=d’+\left\lfloor \frac{((n-1) \bmod d)+ 1}{d} \right\rfloor$，那么它会改变，当且仅当 $(n-1) \bmod d=d-1$，即 $n-1=kd+(d-1) \Rightarrow n=(k+1)d$</p>
<p>综上，发生变化当且仅当 $d|n$，因此只有 $d|n$ 才会对 $f(n)$ 产生不同于 $f(n-1)$ 的影响</p>
<p>那么变化量就很好计算了，它是一个狄利克雷卷积的形式（因为只需要枚举 $d|n$）</p>
<p>对于变化量，有：</p>
<p>$$<br>\Delta_f(n)=\sum_{d|n} \left(\left\lfloor \frac{n}{d} \right\rfloor^2g(d) -\left\lfloor \frac{n-1}{d} \right\rfloor^2g(d) \right)<br>$$</p>
<p>由于 $d|n$，所以第一个下取整可以去掉，同时可以得知第二个下取整后就是 $\frac{n}{d}-1$</p>
<p>既然没了下取整，就可以把 $d$ 和 $\frac{n}{d}$ 换一下了，即：</p>
<p>$$<br>\begin{aligned}<br>\Delta_f(n)<br>=&amp;\sum_{d|n} g\left(\frac{n}{d} \right) \left( d^2-(d-1)^2 \right) \<br>=&amp;\sum_{d|n} g\left(\frac{n}{d} \right) \left( 2d-1 \right) \<br>=&amp;\left(2\sum_{d|n} g\left(d \right)\frac{n}{d}\right) -\left(\sum_{d|n} g\left(d \right)\right) \<br>\end{aligned}<br>$$</p>
<p>线性筛一下就好了</p>
<p>$g_1(p)=g(1)p+g(p)1=p+(p \oplus 1)$</p>
<p>$g_1(p^c)=\sum_{i=0}^{c}g(p^i)p^{^{c-i}}=\sum_{i=0}^{c}(p \oplus i)p^{c-i}=p \cdot g_1(p^{c-1})+(p \oplus c)$</p>
<p>$g_2(p)=g(1)+g(p)=1+(p \oplus 1)$</p>
<p>$g_2(p^c)=\sum_{i=0}^{c}g(p^i)=\sum_{i=0}^{c}(p \oplus i)=g_2(p^{c-1})+(p \oplus c)$</p>
<h1 id="梦中的数论"><a href="#梦中的数论" class="headerlink" title="梦中的数论"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/6682">梦中的数论</a></h1><h2 id="题目描述-12"><a href="#题目描述-12" class="headerlink" title="题目描述"></a>题目描述</h2><p>求：</p>
<p>$$<br>\sum\limits_{i=1}^{n}\sum\limits_{j=1}^{n}\sum\limits_{k=1}^{n}[(j\mid i) \land ((j+k)\mid i)]<br>$$</p>
<p>其中，$(j\mid i) \land ((j+k)\mid i)$ 指 $j$ 整除 $i$ 并且 $j+k$ 也整除 $i$</p>
<p>答案模 $998244353$，保证 $1\le n\le 10^{10}$</p>
<h2 id="社论-12"><a href="#社论-12" class="headerlink" title="社论"></a>社论</h2><p>考虑后面那个是啥，相当于从 $i$ 的约数中选了两个不相同的，求方案数</p>
<p>于是答案就是：</p>
<p>$$<br>\sum_{i=1}^{n} {\sigma_0(i) \choose 2}=\sum_{i=1}^{n} \frac{\sigma_0(i)^2-\sigma_0(i)}{2}<br>$$</p>
<p>对于 $\sum \sigma_0(i)$，可以数论分块的 $O(\sqrt{n})$ 求，对于 $\sum \sigma_0^2(i)$，就直接 $\text{min_25}$ 筛就好了</p>
<h1 id="Check-Check-Check-one-two"><a href="#Check-Check-Check-one-two" class="headerlink" title="Check,Check,Check one two!"></a><a target="_blank" rel="noopener" href="https://www.luogu.org/problemnew/show/P5115">Check,Check,Check one two!</a></h1><h2 id="题目描述-13"><a href="#题目描述-13" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定字符串 $S$，以及 $k_1,k_2$，求：</p>
<p>$$<br>\sum_{1 \le i &lt; j \le n} \text{lcp}(i,j) \times \text{lcs}(i,j) \times [\text{lcp}(i,j) \le k_1] \times [\text{lcs}(i,j) \le k_2]<br>$$</p>
<p>其中：</p>
<ul>
<li>$\text{lcp}(i,j)$ 表示从字符串第 $i$ 个位置开始的后缀和从第 $j$ 个位置开始的后缀的最长公共前缀长度</li>
<li>$\text{lcs}(i,j)$ 表示在字符串第 $i$ 个位置结束的前缀和在第 $j$ 个位置结束的前缀的最长公共后缀长度</li>
</ul>
<h2 id="社论-13"><a href="#社论-13" class="headerlink" title="社论"></a>社论</h2><p>先不考虑神仙的 $SA$ 做法，考虑暴力</p>
<p>题意转化为了，给定两棵树，求两两点对的 $lca$ 处的权值的乘积的和</p>
<p>边分树合并一下就好了</p>
<h1 id="共价大爷游长沙"><a href="#共价大爷游长沙" class="headerlink" title="共价大爷游长沙"></a><a href="uoj.ac/problem/207">共价大爷游长沙</a></h1><h2 id="题目描述-14"><a href="#题目描述-14" class="headerlink" title="题目描述"></a>题目描述</h2><p>有一棵 $n$ 个节点的树，$m$ 次操作，有四种操作</p>
<ol>
<li>删除一条边并加入一条边，保证操作之后还是一棵树</li>
<li>在路径集合 $S$ 中加入一条路径 $(x, y)$</li>
<li>删除路径集合 $S$ 中的一条路径。</li>
<li>对于一条边 $(x, y)$（保证存在），询问是否 $S$ 中的所有路径都经过了这条边</li>
</ol>
<p>其中 $n, m \le 300000$</p>
<h2 id="社论-14"><a href="#社论-14" class="headerlink" title="社论"></a>社论</h2><p>考虑对每个 $(x,y)$ 打上一个随机权值，那么一条边合法，当且仅当它的一个子树中的边权异或和等于所有加入的随机权值的异或和</p>
<h1 id="「NOI2014」魔法森林"><a href="#「NOI2014」魔法森林" class="headerlink" title="「NOI2014」魔法森林"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2245">「NOI2014」魔法森林</a></h1><h2 id="题目描述-15"><a href="#题目描述-15" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定一张无向图，每条边有两个权值 $A_i, B_i$</p>
<p>要求找出一条从 $1$ 号点到 $n$ 号点的路径，使得所有经过了的边 $i$，最小化 $\max_i(A_i) + \max_i(B_i)$ 最小，求这个最小值</p>
<p>其中 $n \le 10^5$</p>
<h2 id="社论-15"><a href="#社论-15" class="headerlink" title="社论"></a>社论</h2><p>先把边按照 $B$ 从小到大排序，然后就可以依次枚举了，这样就只有一个维度 $A$ 的限制了</p>
<p>不难发现它就是最小生成树，直接 $LCT$ 维护就好了</p>
<p>一个不正经的做法：动态加边最短路，然而官方数据没卡……</p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持nekko</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/07/07/rand-R-per/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/07/21/NOI2019/NOI2019/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

<!--
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script>
-->

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
